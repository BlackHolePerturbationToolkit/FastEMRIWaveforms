<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fast and Accurate EMRI Waveforms Tutorial &mdash; few: Fast EMRI Waveforms 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FastEMRIWaveforms Publications" href="../general/docs_main.html" />
    <link rel="prev" title="Citations" href="../user/cite.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >

          
          
          <a href="../index.html" class="icon icon-home">
            few: Fast EMRI Waveforms
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/main.html">Overall Waveform Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/traj.html">Trajectory Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/amp.html">Amplitude Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/sum.html">Summation Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/util.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/cite.html">Citations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fast and Accurate EMRI Waveforms Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Full-EMRI-Waveforms-in-Schwarzschild-Eccentric">Full EMRI Waveforms in Schwarzschild Eccentric</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#FastSchwarzschildEccentricFlux">FastSchwarzschildEccentricFlux</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Waveform-scaled-by-distance-(generated-in-source-frame)">Waveform scaled by distance (generated in source frame)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Producing-waveforms-with-the-generic-interface">Producing waveforms with the generic interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SlowSchwarzschildEccentricFlux">SlowSchwarzschildEccentricFlux</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Trajectory-Module">Trajectory Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Run-a-basic-trajectory">Run a basic trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Defining-a-new-t-vector">Defining a new t vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Defining-dt-and-T">Defining dt and T</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Getting-dimensionless-time-(t/M)">Getting dimensionless time (<span class="math notranslate nohighlight">\(t/M\)</span>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Dense-Stepping">Dense Stepping</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Amplitude-Module">Amplitude Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ROMAN-amplitude-generation">ROMAN amplitude generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Interpolate-modes-with-bicubic-spline">Interpolate modes with bicubic spline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Spin-weighted-spherical-harmonics">Spin-weighted spherical harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Mode-Selection">Mode Selection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Mode-selection-by-power-contribution">Mode selection by power contribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Mode-selection-by-noise-weighted-power-contribution">Mode selection by noise-weighted power contribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Compare-the-two-waves-with-and-without-noise-weighting">Compare the two waves with and without noise-weighting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Specific-mode-selection">Specific mode selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Turn-off-(-m)">Turn off (<span class="math notranslate nohighlight">\(-m\)</span>)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Parallelized-Cubic-Spline-Interpolation">Parallelized Cubic Spline Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Mode-Summation">Mode Summation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Interpolated-summation">Interpolated summation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Direct-summation">Direct summation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Utility-functions">Utility functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Get-options-for-installed-ODE-functions">Get options for installed ODE functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Fundamental-Frequencies">Fundamental Frequencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Separatrix-in-Generic-Kerr">Separatrix in Generic Kerr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Get-Kerr-Constants-of-Motion-(E,-L,-Q)">Get Kerr Constants of Motion <span class="math notranslate nohighlight">\((E, L, Q)\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convert-from-x_I-to-Y">Convert from <span class="math notranslate nohighlight">\(x_I\)</span> to <span class="math notranslate nohighlight">\(Y\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Get-\mu-based-on-desired-duration-of-waveform">Get <span class="math notranslate nohighlight">\(\mu\)</span> based on desired duration of waveform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Get-p_0-based-on-desired-duration-of-waveform">Get <span class="math notranslate nohighlight">\(p_0\)</span> based on desired duration of waveform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Set/get-omp_num_threads">Set/get <code class="docutils literal notranslate"><span class="pre">omp_num_threads</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Change-CUDA-device">Change CUDA device</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Creating-modules">Creating modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Post-Newtonian-trajectory">Post-Newtonian trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Test-your-trajectory">Test your trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Implement-ODE-in-C/C++">Implement ODE in C/C++</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Analytic-functions-that-do-not-need-storage">Analytic functions that do not need storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Functions-that-require-storage">Functions that require storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Make-a-waveform-model">Make a waveform model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Test-your-waveform">Test your waveform</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Augmented-Analytic-Kludge-with-5PN-trajectory">Augmented Analytic Kludge with 5PN trajectory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#5PN-Trajectory">5PN Trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Building-an-AAK-waveform-from-a-given-trajectory-(in-this-case-the-5PN-trajectory)">Building an AAK waveform from a given trajectory (in this case the 5PN trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Generating-the-new-AAK-with-the-generic-waveform-generator">Generating the new AAK with the generic waveform generator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Citing-waveforms-and-modules">Citing waveforms and modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Fast-Schwarzschild-Eccentric-Waveforms">Fast Schwarzschild Eccentric Waveforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#New-and-Improved-AAK-with-5PN-Trajectory">New and Improved AAK with 5PN Trajectory</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html">FastEMRIWaveforms Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html#package-todos">Package TODOs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html#change-log">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: coral" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">few: Fast EMRI Waveforms</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Fast and Accurate EMRI Waveforms Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/FastEMRIWaveforms_tutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="../user/cite.html" class="btn btn-neutral float-left" title="Citations" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../general/docs_main.html" class="btn btn-neutral float-right" title="FastEMRIWaveforms Publications" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Fast-and-Accurate-EMRI-Waveforms-Tutorial">
<h1>Fast and Accurate EMRI Waveforms Tutorial<a class="headerlink" href="#Fast-and-Accurate-EMRI-Waveforms-Tutorial" title="Permalink to this heading"></a></h1>
<p>Here we provide a set of examples for creating EMRI waveforms as a whole; looking at separate creation pieces (trajectory, amplitude, summation, etc.); and creating your own module to build directly into this framework. For details on the specifics of our waveforms like constructions used and generally methodology, we refer you to our papers <a class="reference external" href="https://arxiv.org/abs/2104.04582">arxiv.org/2104.04582</a> and <a class="reference external" href="https://arxiv.org/abs/2008.06071">arxiv.org/2008.06071</a> and the <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/">package
documentation</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">few.trajectory.inspiral</span> <span class="kn">import</span> <span class="n">EMRIInspiral</span>
<span class="kn">from</span> <span class="nn">few.amplitude.romannet</span> <span class="kn">import</span> <span class="n">RomanAmplitude</span>
<span class="kn">from</span> <span class="nn">few.amplitude.interp2dcubicspline</span> <span class="kn">import</span> <span class="n">Interp2DAmplitude</span>
<span class="kn">from</span> <span class="nn">few.waveform</span> <span class="kn">import</span> <span class="n">FastSchwarzschildEccentricFlux</span><span class="p">,</span> <span class="n">SlowSchwarzschildEccentricFlux</span><span class="p">,</span> <span class="n">GenerateEMRIWaveform</span>
<span class="kn">from</span> <span class="nn">few.utils.utility</span> <span class="kn">import</span> <span class="p">(</span><span class="n">get_overlap</span><span class="p">,</span>
                               <span class="n">get_mismatch</span><span class="p">,</span>
                               <span class="n">get_fundamental_frequencies</span><span class="p">,</span>
                               <span class="n">get_separatrix</span><span class="p">,</span>
                               <span class="n">get_mu_at_t</span><span class="p">,</span>
                               <span class="n">get_p_at_t</span><span class="p">,</span>
                               <span class="n">get_kerr_geo_constants_of_motion</span><span class="p">,</span>
                               <span class="n">xI_to_Y</span><span class="p">,</span>
                               <span class="n">Y_to_xI</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">few.utils.ylm</span> <span class="kn">import</span> <span class="n">GetYlms</span>
<span class="kn">from</span> <span class="nn">few.utils.modeselector</span> <span class="kn">import</span> <span class="n">ModeSelector</span>
<span class="kn">from</span> <span class="nn">few.summation.interpolatedmodesum</span> <span class="kn">import</span> <span class="n">CubicSplineInterpolant</span>
<span class="kn">from</span> <span class="nn">few.waveform</span> <span class="kn">import</span> <span class="n">SchwarzschildEccentricWaveformBase</span>
<span class="kn">from</span> <span class="nn">few.summation.interpolatedmodesum</span> <span class="kn">import</span> <span class="n">InterpolatedModeSum</span>
<span class="kn">from</span> <span class="nn">few.summation.directmodesum</span> <span class="kn">import</span> <span class="n">DirectModeSum</span>
<span class="kn">from</span> <span class="nn">few.utils.constants</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">few.summation.aakwave</span> <span class="kn">import</span> <span class="n">AAKSummation</span>
<span class="kn">from</span> <span class="nn">few.waveform</span> <span class="kn">import</span> <span class="n">Pn5AAKWaveform</span><span class="p">,</span> <span class="n">AAKWaveformBase</span>
</pre></div>
</div>
</div>
</section>
<section id="Full-EMRI-Waveforms-in-Schwarzschild-Eccentric">
<h1>Full EMRI Waveforms in Schwarzschild Eccentric<a class="headerlink" href="#Full-EMRI-Waveforms-in-Schwarzschild-Eccentric" title="Permalink to this heading"></a></h1>
<p>In the section, we will describe how to create EMRI waveforms with both our fast and slow EMRI waveform model. The current full models include <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html#few.waveform.FastSchwarzschildEccentricFlux">FastSchwarzschildEccentricFlux</a> and <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html#few.waveform.SlowSchwarzschildEccentricFlux">SlowSchwarzschildEccentricFlux</a>. These are fast and slow versions of models that evolve eccentric
flux-based trajectories in a Schwarzschild background. The fast model can be run exactly as shown here on CPUs or GPUs by providing the correct initialization arguments.</p>
<p>The waveform model produces <span class="math notranslate nohighlight">\(h(t) = h_p - ih_c(t)\)</span>. It takes as arguments <span class="math notranslate nohighlight">\(\{M, \mu, p_0, e_0, \Phi_{\phi,0}, \Phi_{r, 0}\}\)</span>. <span class="math notranslate nohighlight">\(M\)</span> is the larger mass (<span class="math notranslate nohighlight">\(M_\odot\)</span>), <span class="math notranslate nohighlight">\(\mu\)</span> is the compact object mass (<span class="math notranslate nohighlight">\(M_\odot\)</span>), <span class="math notranslate nohighlight">\(p_0\)</span> is the initial semi-latus rectum (dimensionless), <span class="math notranslate nohighlight">\(e_0\)</span> is the initial eccentricity, and the final two are the initial phases in <span class="math notranslate nohighlight">\(\phi, r\)</span>.</p>
<section id="FastSchwarzschildEccentricFlux">
<h2><a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html#few.waveform.FastSchwarzschildEccentricFlux">FastSchwarzschildEccentricFlux</a><a class="headerlink" href="#FastSchwarzschildEccentricFlux" title="Permalink to this heading"></a></h2>
<p>The fast waveform generates sparse trajectories with ~100 points. Amplitudes for all modes are then determined with ROMAN network. From these amplitudes, we perform mode selection to remove modes that do not contribute significantly to the waveform. The remaining modes and phases are then interpolated with cubic splines. In one final step, the amplitude, phase, and angular harmonic information is then combined with an interpolated summation.</p>
<ul class="simple">
<li><p>Trajectory Module: <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/html/user/traj.html#few.trajectory.flux.RunSchwarzEccFluxInspiral">RunSchwarzEccFluxInspiral</a></p></li>
<li><p>Amplitude Module: <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/html/user/amp.html#few.amplitude.romannet.RomanAmplitude">RomanAmplitude</a></p></li>
<li><p>Summation Module: <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/html/user/sum.html#few.summation.interpolatedmodesum.CubicSplineInterpolant">InterpolateModeSum</a></p></li>
<li><p>Mode Selection: <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/html/user/util.html#few.utils.modeselector.ModeSelector">ModeSelector</a></p></li>
<li><p>Angular Harmonics: <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/html/user/util.html#few.utils.ylm.GetYlms">GetYlms</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">use_gpu</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># keyword arguments for inspiral generator (RunSchwarzEccFluxInspiral)</span>
<span class="n">inspiral_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;DENSE_STEPPING&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># we want a sparsely sampled trajectory</span>
        <span class="s2">&quot;max_init_len&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">),</span>  <span class="c1"># all of the trajectories will be well under len = 1000</span>
    <span class="p">}</span>

<span class="c1"># keyword arguments for inspiral generator (RomanAmplitude)</span>
<span class="n">amplitude_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;max_init_len&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">),</span>  <span class="c1"># all of the trajectories will be well under len = 1000</span>
    <span class="s2">&quot;use_gpu&quot;</span><span class="p">:</span> <span class="n">use_gpu</span>  <span class="c1"># GPU is available in this class</span>
<span class="p">}</span>

<span class="c1"># keyword arguments for Ylm generator (GetYlms)</span>
<span class="n">Ylm_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;assume_positive_m&quot;</span><span class="p">:</span> <span class="kc">False</span>  <span class="c1"># if we assume positive m, it will generate negative m for all m&gt;0</span>
<span class="p">}</span>

<span class="c1"># keyword arguments for summation generator (InterpolatedModeSum)</span>
<span class="n">sum_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;use_gpu&quot;</span><span class="p">:</span> <span class="n">use_gpu</span><span class="p">,</span>  <span class="c1"># GPU is availabel for this type of summation</span>
    <span class="s2">&quot;pad_output&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># THE FOLLOWING THREAD COMMANDS DO NOT WORK ON THE M1 CHIP, BUT CAN BE USED WITH OLDER MODELS</span>
<span class="c1"># EVENTUALLY WE WILL PROBABLY REMOVE OMP WHICH NOW PARALLELIZES WITHIN ONE WAVEFORM AND LEAVE IT TO</span>
<span class="c1"># THE USER TO PARALLELIZE FOR MANY WAVEFORMS ON THEIR OWN.</span>

<span class="c1"># set omp threads one of two ways</span>
<span class="c1"># num_threads = 4</span>

<span class="c1"># this is the general way to set it for all computations</span>
<span class="c1"># from few.utils.utility import omp_set_num_threads</span>
<span class="c1"># omp_set_num_threads(num_threads)</span>

<span class="n">few</span> <span class="o">=</span> <span class="n">FastSchwarzschildEccentricFlux</span><span class="p">(</span>
    <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span>
    <span class="n">amplitude_kwargs</span><span class="o">=</span><span class="n">amplitude_kwargs</span><span class="p">,</span>
    <span class="n">Ylm_kwargs</span><span class="o">=</span><span class="n">Ylm_kwargs</span><span class="p">,</span>
    <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span>
    <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">,</span>
    <span class="c1"># num_threads=num_threads,  # 2nd way for specific classes</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mkatz/miniconda3/envs/few_env/lib/python3.9/site-packages/few-1.4.11-py3.9-macosx-10.9-x86_64.egg/few/utils/utility.py:783: UserWarning: The file FluxNewMinusPNScaled_fixed_y_order.dat did not open sucessfully. It will now be downloaded to the proper location.
  warnings.warn(
--2023-03-31 21:20:56--  https://zenodo.org/record/3981654/files/FluxNewMinusPNScaled_fixed_y_order.dat
Resolving zenodo.org (zenodo.org)... 188.185.124.72
Connecting to zenodo.org (zenodo.org)|188.185.124.72|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 61494 (60K) [application/octet-stream]
Saving to: ‘FluxNewMinusPNScaled_fixed_y_order.dat’

     0K .......... .......... .......... .......... .......... 83%  879K 0s
    50K ..........                                            100%  100M=0.06s

2023-03-31 21:20:57 (1.03 MB/s) - ‘FluxNewMinusPNScaled_fixed_y_order.dat’ saved [61494/61494]

/Users/mkatz/miniconda3/envs/few_env/lib/python3.9/site-packages/few-1.4.11-py3.9-macosx-10.9-x86_64.egg/few/utils/utility.py:783: UserWarning: The file SchwarzschildEccentricInput.hdf5 did not open sucessfully. It will now be downloaded to the proper location.
  warnings.warn(
--2023-03-31 21:20:57--  https://zenodo.org/record/3981654/files/SchwarzschildEccentricInput.hdf5
Resolving zenodo.org (zenodo.org)... 188.185.124.72
Connecting to zenodo.org (zenodo.org)|188.185.124.72|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 12885136 (12M) [application/octet-stream]
Saving to: ‘SchwarzschildEccentricInput.hdf5’

     0K .......... .......... .......... .......... ..........  0%  768K 16s
    50K .......... .......... .......... .......... ..........  0%  910K 15s
   100K .......... .......... .......... .......... ..........  1% 4.98M 11s
   150K .......... .......... .......... .......... ..........  1% 1.34M 10s
   200K .......... .......... .......... .......... ..........  1% 3.26M 9s
   250K .......... .......... .......... .......... ..........  2% 13.3M 8s
   300K .......... .......... .......... .......... ..........  2% 6.10M 7s
   350K .......... .......... .......... .......... ..........  3% 1.78M 7s
   400K .......... .......... .......... .......... ..........  3% 2.58M 6s
   450K .......... .......... .......... .......... ..........  3% 4.00M 6s
   500K .......... .......... .......... .......... ..........  4% 3.45M 6s
   550K .......... .......... .......... .......... ..........  4% 3.86M 6s
   600K .......... .......... .......... .......... ..........  5% 9.10M 5s
   650K .......... .......... .......... .......... ..........  5% 6.93M 5s
   700K .......... .......... .......... .......... ..........  5% 4.55M 5s
   750K .......... .......... .......... .......... ..........  6% 4.53M 5s
   800K .......... .......... .......... .......... ..........  6% 7.60M 4s
   850K .......... .......... .......... .......... ..........  7% 2.73M 4s
   900K .......... .......... .......... .......... ..........  7% 6.09M 4s
   950K .......... .......... .......... .......... ..........  7% 7.94M 4s
  1000K .......... .......... .......... .......... ..........  8% 7.38M 4s
  1050K .......... .......... .......... .......... ..........  8% 2.67M 4s
  1100K .......... .......... .......... .......... ..........  9% 3.96M 4s
  1150K .......... .......... .......... .......... ..........  9% 2.83M 4s
  1200K .......... .......... .......... .......... ..........  9% 8.29M 4s
  1250K .......... .......... .......... .......... .......... 10% 6.23M 4s
  1300K .......... .......... .......... .......... .......... 10% 9.19M 4s
  1350K .......... .......... .......... .......... .......... 11% 6.24M 3s
  1400K .......... .......... .......... .......... .......... 11% 6.53M 3s
  1450K .......... .......... .......... .......... .......... 11% 5.91M 3s
  1500K .......... .......... .......... .......... .......... 12% 1.02M 4s
  1550K .......... .......... .......... .......... .......... 12% 10.5M 3s
  1600K .......... .......... .......... .......... .......... 13% 3.22M 3s
  1650K .......... .......... .......... .......... .......... 13% 1019K 4s
  1700K .......... .......... .......... .......... .......... 13%  444K 4s
  1750K .......... .......... .......... .......... .......... 14% 11.8M 4s
  1800K .......... .......... .......... .......... .......... 14% 11.6M 4s
  1850K .......... .......... .......... .......... .......... 15% 53.0M 4s
  1900K .......... .......... .......... .......... .......... 15% 76.9M 4s
  1950K .......... .......... .......... .......... .......... 15% 7.20M 4s
  2000K .......... .......... .......... .......... .......... 16% 74.4M 4s
  2050K .......... .......... .......... .......... .......... 16% 64.5M 3s
  2100K .......... .......... .......... .......... .......... 17% 89.3M 3s
  2150K .......... .......... .......... .......... .......... 17% 2.12M 3s
  2200K .......... .......... .......... .......... .......... 17% 6.14M 3s
  2250K .......... .......... .......... .......... .......... 18% 5.36M 3s
  2300K .......... .......... .......... .......... .......... 18% 27.2M 3s
  2350K .......... .......... .......... .......... .......... 19% 16.8M 3s
  2400K .......... .......... .......... .......... .......... 19% 5.77M 3s
  2450K .......... .......... .......... .......... .......... 19% 6.36M 3s
  2500K .......... .......... .......... .......... .......... 20% 19.1M 3s
  2550K .......... .......... .......... .......... .......... 20% 38.5M 3s
  2600K .......... .......... .......... .......... .......... 21% 25.8M 3s
  2650K .......... .......... .......... .......... .......... 21% 7.04M 3s
  2700K .......... .......... .......... .......... .......... 21% 44.1M 3s
  2750K .......... .......... .......... .......... .......... 22% 30.0M 3s
  2800K .......... .......... .......... .......... .......... 22% 8.33M 3s
  2850K .......... .......... .......... .......... .......... 23% 7.80M 3s
  2900K .......... .......... .......... .......... .......... 23% 9.85M 3s
  2950K .......... .......... .......... .......... .......... 23% 20.9M 3s
  3000K .......... .......... .......... .......... .......... 24%  341K 3s
  3050K .......... .......... .......... .......... .......... 24% 2.01M 3s
  3100K .......... .......... .......... .......... .......... 25% 78.9M 3s
  3150K .......... .......... .......... .......... .......... 25% 47.5M 3s
  3200K .......... .......... .......... .......... .......... 25% 75.8M 3s
  3250K .......... .......... .......... .......... .......... 26% 52.5M 3s
  3300K .......... .......... .......... .......... .......... 26% 57.6M 3s
  3350K .......... .......... .......... .......... .......... 27% 41.0M 3s
  3400K .......... .......... .......... .......... .......... 27% 53.2M 3s
  3450K .......... .......... .......... .......... .......... 27% 73.9M 3s
  3500K .......... .......... .......... .......... .......... 28% 71.7M 2s
  3550K .......... .......... .......... .......... .......... 28% 69.7M 2s
  3600K .......... .......... .......... .......... .......... 29%  368K 3s
  3650K .......... .......... .......... .......... .......... 29% 9.46M 3s
  3700K .......... .......... .......... .......... .......... 29%  626K 3s
  3750K .......... .......... .......... .......... .......... 30%  453K 3s
  3800K .......... .......... .......... .......... .......... 30%  107M 3s
  3850K .......... .......... .......... .......... .......... 30%  119M 3s
  3900K .......... .......... .......... .......... .......... 31%  107M 3s
  3950K .......... .......... .......... .......... .......... 31%  103M 3s
  4000K .......... .......... .......... .......... .......... 32% 76.5M 3s
  4050K .......... .......... .......... .......... .......... 32%  174M 3s
  4100K .......... .......... .......... .......... .......... 32%  187M 3s
  4150K .......... .......... .......... .......... .......... 33%  144M 3s
  4200K .......... .......... .......... .......... .......... 33% 57.6M 3s
  4250K .......... .......... .......... .......... .......... 34% 49.1M 3s
  4300K .......... .......... .......... .......... .......... 34% 26.7M 2s
  4350K .......... .......... .......... .......... .......... 34% 3.12M 2s
  4400K .......... .......... .......... .......... .......... 35% 9.29M 2s
  4450K .......... .......... .......... .......... .......... 35% 38.6M 2s
  4500K .......... .......... .......... .......... .......... 36% 9.13M 2s
  4550K .......... .......... .......... .......... .......... 36% 9.09M 2s
  4600K .......... .......... .......... .......... .......... 36% 8.00M 2s
  4650K .......... .......... .......... .......... .......... 37% 12.6M 2s
  4700K .......... .......... .......... .......... .......... 37% 40.2M 2s
  4750K .......... .......... .......... .......... .......... 38% 5.23M 2s
  4800K .......... .......... .......... .......... .......... 38% 5.67M 2s
  4850K .......... .......... .......... .......... .......... 38% 6.99M 2s
  4900K .......... .......... .......... .......... .......... 39% 25.6M 2s
  4950K .......... .......... .......... .......... .......... 39% 37.5M 2s
  5000K .......... .......... .......... .......... .......... 40% 16.0M 2s
  5050K .......... .......... .......... .......... .......... 40% 7.59M 2s
  5100K .......... .......... .......... .......... .......... 40% 12.8M 2s
  5150K .......... .......... .......... .......... .......... 41% 5.11M 2s
  5200K .......... .......... .......... .......... .......... 41% 39.3M 2s
  5250K .......... .......... .......... .......... .......... 42% 6.38M 2s
  5300K .......... .......... .......... .......... .......... 42% 10.4M 2s
  5350K .......... .......... .......... .......... .......... 42%  375K 2s
  5400K .......... .......... .......... .......... .......... 43% 72.6M 2s
  5450K .......... .......... .......... .......... .......... 43%  183M 2s
  5500K .......... .......... .......... .......... .......... 44%  149M 2s
  5550K .......... .......... .......... .......... .......... 44%  136M 2s
  5600K .......... .......... .......... .......... .......... 44%  173M 2s
  5650K .......... .......... .......... .......... .......... 45%  186M 2s
  5700K .......... .......... .......... .......... .......... 45%  113M 2s
  5750K .......... .......... .......... .......... .......... 46%  111M 2s
  5800K .......... .......... .......... .......... .......... 46%  153M 2s
  5850K .......... .......... .......... .......... .......... 46%  138M 2s
  5900K .......... .......... .......... .......... .......... 47%  182M 2s
  5950K .......... .......... .......... .......... .......... 47%  152M 2s
  6000K .......... .......... .......... .......... .......... 48%  136M 2s
  6050K .......... .......... .......... .......... .......... 48% 1.91M 2s
  6100K .......... .......... .......... .......... .......... 48% 8.14M 2s
  6150K .......... .......... .......... .......... .......... 49% 9.85M 2s
  6200K .......... .......... .......... .......... .......... 49% 26.7M 2s
  6250K .......... .......... .......... .......... .......... 50% 10.9M 2s
  6300K .......... .......... .......... .......... .......... 50%  913K 2s
  6350K .......... .......... .......... .......... .......... 50% 9.29M 2s
  6400K .......... .......... .......... .......... .......... 51% 25.0M 2s
  6450K .......... .......... .......... .......... .......... 51% 22.5M 2s
  6500K .......... .......... .......... .......... .......... 52% 62.1M 2s
  6550K .......... .......... .......... .......... .......... 52% 52.7M 2s
  6600K .......... .......... .......... .......... .......... 52% 34.7M 1s
  6650K .......... .......... .......... .......... .......... 53% 10.5M 1s
  6700K .......... .......... .......... .......... .......... 53% 28.3M 1s
  6750K .......... .......... .......... .......... .......... 54% 4.95M 1s
  6800K .......... .......... .......... .......... .......... 54% 16.1M 1s
  6850K .......... .......... .......... .......... .......... 54%  180M 1s
  6900K .......... .......... .......... .......... .......... 55% 13.8M 1s
  6950K .......... .......... .......... .......... .......... 55%  158M 1s
  7000K .......... .......... .......... .......... .......... 56% 1.74M 1s
  7050K .......... .......... .......... .......... .......... 56% 17.6M 1s
  7100K .......... .......... .......... .......... .......... 56% 14.3M 1s
  7150K .......... .......... .......... .......... .......... 57% 2.09M 1s
  7200K .......... .......... .......... .......... .......... 57% 13.9M 1s
  7250K .......... .......... .......... .......... .......... 58% 6.62M 1s
  7300K .......... .......... .......... .......... .......... 58% 27.6M 1s
  7350K .......... .......... .......... .......... .......... 58% 6.98M 1s
  7400K .......... .......... .......... .......... .......... 59% 2.14M 1s
  7450K .......... .......... .......... .......... .......... 59% 9.77M 1s
  7500K .......... .......... .......... .......... .......... 60% 5.41M 1s
  7550K .......... .......... .......... .......... .......... 60% 12.3M 1s
  7600K .......... .......... .......... .......... .......... 60% 1.17M 1s
  7650K .......... .......... .......... .......... .......... 61% 1.54M 1s
  7700K .......... .......... .......... .......... .......... 61% 49.0M 1s
  7750K .......... .......... .......... .......... .......... 61% 1.17M 1s
  7800K .......... .......... .......... .......... .......... 62% 18.3M 1s
  7850K .......... .......... .......... .......... .......... 62% 20.1M 1s
  7900K .......... .......... .......... .......... .......... 63% 13.2M 1s
  7950K .......... .......... .......... .......... .......... 63%  145M 1s
  8000K .......... .......... .......... .......... .......... 63% 38.0M 1s
  8050K .......... .......... .......... .......... .......... 64% 4.97M 1s
  8100K .......... .......... .......... .......... .......... 64% 7.84M 1s
  8150K .......... .......... .......... .......... .......... 65% 5.43M 1s
  8200K .......... .......... .......... .......... .......... 65% 14.4M 1s
  8250K .......... .......... .......... .......... .......... 65%  214K 1s
  8300K .......... .......... .......... .......... .......... 66% 22.6M 1s
  8350K .......... .......... .......... .......... .......... 66% 88.5M 1s
  8400K .......... .......... .......... .......... .......... 67% 56.6M 1s
  8450K .......... .......... .......... .......... .......... 67% 31.6M 1s
  8500K .......... .......... .......... .......... .......... 67% 31.2M 1s
  8550K .......... .......... .......... .......... .......... 68% 61.9M 1s
  8600K .......... .......... .......... .......... .......... 68%  103M 1s
  8650K .......... .......... .......... .......... .......... 69%  114M 1s
  8700K .......... .......... .......... .......... .......... 69% 70.1M 1s
  8750K .......... .......... .......... .......... .......... 69% 76.9M 1s
  8800K .......... .......... .......... .......... .......... 70% 39.6M 1s
  8850K .......... .......... .......... .......... .......... 70%  136M 1s
  8900K .......... .......... .......... .......... .......... 71%  121M 1s
  8950K .......... .......... .......... .......... .......... 71%  101M 1s
  9000K .......... .......... .......... .......... .......... 71%  121M 1s
  9050K .......... .......... .......... .......... .......... 72%  124M 1s
  9100K .......... .......... .......... .......... .......... 72%  303K 1s
  9150K .......... .......... .......... .......... .......... 73% 2.98M 1s
  9200K .......... .......... .......... .......... .......... 73% 4.68M 1s
  9250K .......... .......... .......... .......... .......... 73% 7.79M 1s
  9300K .......... .......... .......... .......... .......... 74% 2.89M 1s
  9350K .......... .......... .......... .......... .......... 74% 3.43M 1s
  9400K .......... .......... .......... .......... .......... 75% 22.0M 1s
  9450K .......... .......... .......... .......... .......... 75% 10.7M 1s
  9500K .......... .......... .......... .......... .......... 75% 13.9M 1s
  9550K .......... .......... .......... .......... .......... 76% 7.43M 1s
  9600K .......... .......... .......... .......... .......... 76% 16.6M 1s
  9650K .......... .......... .......... .......... .......... 77% 12.5M 1s
  9700K .......... .......... .......... .......... .......... 77% 11.3M 1s
  9750K .......... .......... .......... .......... .......... 77% 5.46M 1s
  9800K .......... .......... .......... .......... .......... 78% 3.43M 1s
  9850K .......... .......... .......... .......... .......... 78% 10.2M 1s
  9900K .......... .......... .......... .......... .......... 79% 5.66M 1s
  9950K .......... .......... .......... .......... .......... 79% 10.0M 1s
 10000K .......... .......... .......... .......... .......... 79% 2.15M 1s
 10050K .......... .......... .......... .......... .......... 80% 7.44M 1s
 10100K .......... .......... .......... .......... .......... 80% 10.3M 1s
 10150K .......... .......... .......... .......... .......... 81%  678K 1s
 10200K .......... .......... .......... .......... .......... 81% 14.9M 1s
 10250K .......... .......... .......... .......... .......... 81% 69.1M 1s
 10300K .......... .......... .......... .......... .......... 82% 71.1M 1s
 10350K .......... .......... .......... .......... .......... 82% 79.3M 1s
 10400K .......... .......... .......... .......... .......... 83%  139M 1s
 10450K .......... .......... .......... .......... .......... 83% 41.2M 1s
 10500K .......... .......... .......... .......... .......... 83% 78.1M 1s
 10550K .......... .......... .......... .......... .......... 84% 35.6M 0s
 10600K .......... .......... .......... .......... .......... 84% 37.3M 0s
 10650K .......... .......... .......... .......... .......... 85% 20.3M 0s
 10700K .......... .......... .......... .......... .......... 85%  689K 0s
 10750K .......... .......... .......... .......... .......... 85% 73.9M 0s
 10800K .......... .......... .......... .......... .......... 86% 41.0M 0s
 10850K .......... .......... .......... .......... .......... 86% 24.2M 0s
 10900K .......... .......... .......... .......... .......... 87% 44.9M 0s
 10950K .......... .......... .......... .......... .......... 87% 30.2M 0s
 11000K .......... .......... .......... .......... .......... 87% 15.6M 0s
 11050K .......... .......... .......... .......... .......... 88% 9.32M 0s
 11100K .......... .......... .......... .......... .......... 88% 36.2M 0s
 11150K .......... .......... .......... .......... .......... 89% 9.15M 0s
 11200K .......... .......... .......... .......... .......... 89% 1.20M 0s
 11250K .......... .......... .......... .......... .......... 89% 10.2M 0s
 11300K .......... .......... .......... .......... .......... 90% 4.77M 0s
 11350K .......... .......... .......... .......... .......... 90%  161M 0s
 11400K .......... .......... .......... .......... .......... 90% 12.3M 0s
 11450K .......... .......... .......... .......... .......... 91% 12.1M 0s
 11500K .......... .......... .......... .......... .......... 91%  391K 0s
 11550K .......... .......... .......... .......... .......... 92% 3.26M 0s
 11600K .......... .......... .......... .......... .......... 92% 1.29M 0s
 11650K .......... .......... .......... .......... .......... 92% 1.68M 0s
 11700K .......... .......... .......... .......... .......... 93% 36.6M 0s
 11750K .......... .......... .......... .......... .......... 93% 22.8M 0s
 11800K .......... .......... .......... .......... .......... 94% 49.4M 0s
 11850K .......... .......... .......... .......... .......... 94% 61.9M 0s
 11900K .......... .......... .......... .......... .......... 94% 27.9M 0s
 11950K .......... .......... .......... .......... .......... 95% 31.5M 0s
 12000K .......... .......... .......... .......... .......... 95% 34.1M 0s
 12050K .......... .......... .......... .......... .......... 96% 47.7M 0s
 12100K .......... .......... .......... .......... .......... 96% 17.8M 0s
 12150K .......... .......... .......... .......... .......... 96% 2.99M 0s
 12200K .......... .......... .......... .......... .......... 97% 1.47M 0s
 12250K .......... .......... .......... .......... .......... 97% 29.8M 0s
 12300K .......... .......... .......... .......... .......... 98% 4.33M 0s
 12350K .......... .......... .......... .......... .......... 98% 12.5M 0s
 12400K .......... .......... .......... .......... .......... 98% 7.31M 0s
 12450K .......... .......... .......... .......... .......... 99% 14.2M 0s
 12500K .......... .......... .......... .......... .......... 99% 6.81M 0s
 12550K .......... .......... .......... ...                  100% 53.4M=3.1s

2023-03-31 21:21:01 (3.97 MB/s) - ‘SchwarzschildEccentricInput.hdf5’ saved [12885136/12885136]

/Users/mkatz/miniconda3/envs/few_env/lib/python3.9/site-packages/few-1.4.11-py3.9-macosx-10.9-x86_64.egg/few/utils/utility.py:783: UserWarning: The file AmplitudeVectorNorm.dat did not open sucessfully. It will now be downloaded to the proper location.
  warnings.warn(
--2023-03-31 21:21:01--  https://zenodo.org/record/3981654/files/AmplitudeVectorNorm.dat
Resolving zenodo.org (zenodo.org)... 188.185.124.72
Connecting to zenodo.org (zenodo.org)|188.185.124.72|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 49517 (48K) [application/octet-stream]
Saving to: ‘AmplitudeVectorNorm.dat’

     0K .......... .......... .......... .......... ........  100%  548K=0.09s

2023-03-31 21:21:03 (548 KB/s) - ‘AmplitudeVectorNorm.dat’ saved [49517/49517]

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">few</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>  <span class="c1">#  assumes dt = 10.0 for max T = 1.0 year</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x13fe61820&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_9_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_9_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:],</span> <span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:],</span> <span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x13ff397f0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_10_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_10_1.png" />
</div>
</div>
<p>To get shorter waveforms, you can provide the <code class="docutils literal notranslate"><span class="pre">T</span></code> kwarg for the function call. This is the observation time in years. You can also adjust <code class="docutils literal notranslate"><span class="pre">dt</span></code>. This is the time change in samples in seconds.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">8.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># seconds</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># years</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">few</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>

<span class="c1"># we can check how many harmonic modes are kept</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>

<span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
85300.0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_12_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_12_1.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">eps</span></code> kwarg will change the mode content of the waveform. Lowering it add modes. Increasing it will remove modes. The default is <span class="math notranslate nohighlight">\(10^{-5}\)</span>. This is generally recommended as good setting for good overlaps across the available parameter space.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span> <span class="c1"># seconds</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.005</span>  <span class="c1"># years</span>
<span class="n">wave1</span> <span class="o">=</span> <span class="n">few</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>  <span class="c1"># default</span>

<span class="c1"># we can check how many harmonic modes are kept</span>
<span class="n">modes1</span> <span class="o">=</span> <span class="n">few</span><span class="o">.</span><span class="n">num_modes_kept</span>

<span class="n">wave2</span> <span class="o">=</span> <span class="n">few</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>

<span class="n">modes2</span> <span class="o">=</span> <span class="n">few</span><span class="o">.</span><span class="n">num_modes_kept</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave1</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$10^{-5}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave2</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$10^{-2}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># we can also compute the mismatch when removing modes</span>
<span class="n">mm</span> <span class="o">=</span> <span class="n">get_mismatch</span><span class="p">(</span><span class="n">wave1</span><span class="p">,</span> <span class="n">wave2</span><span class="p">)</span>

<span class="c1"># we can check how many modes were kept</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;wave1 used </span><span class="si">{}</span><span class="s1"> modes. wave2 used </span><span class="si">{}</span><span class="s1"> modes. The mismatch was </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">modes1</span><span class="p">,</span> <span class="n">modes2</span><span class="p">,</span> <span class="n">mm</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
wave1 used 451 modes. wave2 used 25 modes. The mismatch was 0.0012120661717398562
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_14_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_14_1.png" />
</div>
</div>
</section>
<section id="Waveform-scaled-by-distance-(generated-in-source-frame)">
<h2>Waveform scaled by distance (generated in source frame)<a class="headerlink" href="#Waveform-scaled-by-distance-(generated-in-source-frame)" title="Permalink to this heading"></a></h2>
<p>The FastSchwarzschildEccentricFlux waveform is generated with source frame viewing angles. For all previous examples, the <code class="docutils literal notranslate"><span class="pre">dist</span></code> kwarg was left blank. To scale the waveform by the distance, you can add the distance in Gpc as a kwarg in the waveform generation class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">8.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># distance in Gpc</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># seconds</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># years</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">few</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>

<span class="c1"># we can check how many harmonic modes are kept</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x14012d070&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_17_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_17_1.png" />
</div>
</div>
</section>
<section id="Producing-waveforms-with-the-generic-interface">
<h2>Producing waveforms with the generic interface<a class="headerlink" href="#Producing-waveforms-with-the-generic-interface" title="Permalink to this heading"></a></h2>
<p>Waveforms can also be generated through a generic interface (<a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html#few.waveform.GenerateEMRIWaveform">GenerateEMRIWaveform</a>) where the specific waveform model is chosen with an argument. This can also be used to produce waveforms in the detector frame used for data analysis. This interface includes all EMRI parameters, including spin and inclination, as well as sky and orientation parameters. When a specific waveform model does not
require certain parameters, the parameters will not affect the waveform generation. A detector-frame waveform in this case means <span class="math notranslate nohighlight">\(h_+,h_x\)</span> in the SSB-frame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_wave</span> <span class="o">=</span> <span class="n">GenerateEMRIWaveform</span><span class="p">(</span><span class="s2">&quot;FastSchwarzschildEccentricFlux&quot;</span><span class="p">)</span>

<span class="c1"># parameters</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># years</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>  <span class="c1"># seconds</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># will be ignored in Schwarzschild waveform</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># will be ignored in Schwarzschild waveform</span>
<span class="n">qK</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># polar spin angle</span>
<span class="n">phiK</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">qS</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># polar sky angle</span>
<span class="n">phiS</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># distance</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">gen_wave</span><span class="p">(</span>
    <span class="n">M</span><span class="p">,</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">a</span><span class="p">,</span>
    <span class="n">p0</span><span class="p">,</span>
    <span class="n">e0</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">dist</span><span class="p">,</span>
    <span class="n">qS</span><span class="p">,</span>
    <span class="n">phiS</span><span class="p">,</span>
    <span class="n">qK</span><span class="p">,</span>
    <span class="n">phiK</span><span class="p">,</span>
    <span class="n">Phi_phi0</span><span class="p">,</span>
    <span class="n">Phi_theta0</span><span class="p">,</span>
    <span class="n">Phi_r0</span><span class="p">,</span>
    <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">2000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x1407ab190&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_20_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_20_1.png" />
</div>
</div>
</section>
<section id="SlowSchwarzschildEccentricFlux">
<h2><a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html#few.waveform.SlowSchwarzschildEccentricFlux">SlowSchwarzschildEccentricFlux</a><a class="headerlink" href="#SlowSchwarzschildEccentricFlux" title="Permalink to this heading"></a></h2>
<p>The slow waveform generates dense trajectories with at every <code class="docutils literal notranslate"><span class="pre">dt</span></code> seconds within <code class="docutils literal notranslate"><span class="pre">T</span></code> years. Amplitudes for all modes are then determined with a 2d bicubic spline over semi-latus rectum and eccentricity for each mode. This is done at each dense time step. We do not perform mode selection because this is the slow and most accurate model against which we compare the fast model. The final summation is a direct combination of phase, amplitude, and Ylm information at each dense timestep.</p>
<p><strong>Note</strong>: One thing to pay attention to with the slow waveform is batch size. This is determined by memory limits. Usually anything under ~10000 is fine.</p>
<ul class="simple">
<li><p>Trajectory Module: <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/html/user/traj.html#few.trajectory.flux.RunSchwarzEccFluxInspiral">RunSchwarzEccFluxInspiral</a></p></li>
<li><p>Amplitude Module: <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/html/user/amp.html#few.amplitude.interp2dcubicspline.Interp2DAmplitude">Interp2DAmplitude</a></p></li>
<li><p>Summation Module: <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/html/user/sum.html#few.summation.directmodesum.DirectModeSum">DirectModeSum</a></p></li>
<li><p>Mode Selection: None</p></li>
<li><p>Angular Harmonics: <a class="reference external" href="https://bhptoolkit.org/FastEMRIWaveforms/html/user/util.html#few.utils.ylm.GetYlms">GetYlms</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">use_gpu</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># keyword arguments for inspiral generator (RunSchwarzEccFluxInspiral)</span>
<span class="n">inspiral_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;DENSE_STEPPING&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># we want a sparsely sampled trajectory</span>
        <span class="s2">&quot;max_init_len&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e7</span><span class="p">),</span>  <span class="c1"># dense stepping trajectories</span>
    <span class="p">}</span>

<span class="c1"># keyword arguments for inspiral generator (RomanAmplitude)</span>
<span class="n">amplitude_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;max_init_len&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),</span>  <span class="c1"># this must be &gt;= batch_size</span>
<span class="p">}</span>

<span class="c1"># keyword arguments for Ylm generator (GetYlms)</span>
<span class="n">Ylm_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;assume_positive_m&quot;</span><span class="p">:</span> <span class="kc">False</span>  <span class="c1"># if we assume positive m, it will generate negative m for all m&gt;0</span>
<span class="p">}</span>

<span class="c1"># keyword arguments for summation generator (InterpolatedModeSum)</span>
<span class="n">sum_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;use_gpu&quot;</span><span class="p">:</span> <span class="n">use_gpu</span>  <span class="c1"># GPU is available for this type of summation</span>
<span class="p">}</span>

<span class="n">slow</span> <span class="o">=</span> <span class="n">SlowSchwarzschildEccentricFlux</span><span class="p">(</span>
    <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span>
    <span class="n">amplitude_kwargs</span><span class="o">=</span><span class="n">amplitude_kwargs</span><span class="p">,</span>
    <span class="n">Ylm_kwargs</span><span class="o">=</span><span class="n">Ylm_kwargs</span><span class="p">,</span>
    <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span>
    <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># parameters</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.005</span>  <span class="c1"># years</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span> <span class="c1"># seconds</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">8.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># polar viewing angle</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># distance in Gpc</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>

<span class="n">slow_wave</span> <span class="o">=</span> <span class="n">slow</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">mode_selection</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mkatz/miniconda3/envs/few_env/lib/python3.9/site-packages/few-1.4.11-py3.9-macosx-10.9-x86_64.egg/few/utils/utility.py:783: UserWarning: The file Teuk_amps_a0.0_lmax_10_nmax_30_new.h5 did not open sucessfully. It will now be downloaded to the proper location.
  warnings.warn(
--2023-03-31 21:21:58--  https://zenodo.org/record/3981654/files/Teuk_amps_a0.0_lmax_10_nmax_30_new.h5
Resolving zenodo.org (zenodo.org)... 188.185.124.72
Connecting to zenodo.org (zenodo.org)|188.185.124.72|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 102881792 (98M) [application/octet-stream]
Saving to: ‘Teuk_amps_a0.0_lmax_10_nmax_30_new.h5’

     0K .......... .......... .......... .......... ..........  0%  850K 1m58s
    50K .......... .......... .......... .......... ..........  0%  853K 1m58s
   100K .......... .......... .......... .......... ..........  0%  451K 2m33s
   150K .......... .......... .......... .......... ..........  0%  721K 2m29s
   200K .......... .......... .......... .......... ..........  0%  496K 2m40s
   250K .......... .......... .......... .......... ..........  0%  758K 2m35s
   300K .......... .......... .......... .......... ..........  0%  492K 2m42s
   350K .......... .......... .......... .......... ..........  0%  453K 2m49s
   400K .......... .......... .......... .......... ..........  0%  696K 2m46s
   450K .......... .......... .......... .......... ..........  0%  528K 2m49s
   500K .......... .......... .......... .......... ..........  0%  643K 2m47s
   550K .......... .......... .......... .......... ..........  0%  548K 2m48s
   600K .......... .......... .......... .......... ..........  0%  667K 2m47s
   650K .......... .......... .......... .......... ..........  0%  454K 2m51s
   700K .......... .......... .......... .......... ..........  0%  804K 2m47s
   750K .......... .......... .......... .......... ..........  0%  447K 2m51s
   800K .......... .......... .......... .......... ..........  0%  448K 2m54s
   850K .......... .......... .......... .......... ..........  0%  678K 2m52s
   900K .......... .......... .......... .......... ..........  0%  461K 2m54s
   950K .......... .......... .......... .......... ..........  0%  835K 2m52s
  1000K .......... .......... .......... .......... ..........  1%  466K 2m53s
  1050K .......... .......... .......... .......... ..........  1%  822K 2m51s
  1100K .......... .......... .......... .......... ..........  1%  465K 2m53s
  1150K .......... .......... .......... .......... ..........  1%  412K 2m56s
  1200K .......... .......... .......... .......... ..........  1%  812K 2m53s
  1250K .......... .......... .......... .......... ..........  1%  276K 3m0s
  1300K .......... .......... .......... .......... ..........  1%  777K 2m58s
  1350K .......... .......... .......... .......... ..........  1%  339K 3m2s
  1400K .......... .......... .......... .......... ..........  1%  473K 3m3s
  1450K .......... .......... .......... .......... ..........  1%  604K 3m2s
  1500K .......... .......... .......... .......... ..........  1% 1.83M 2m58s
  1550K .......... .......... .......... .......... ..........  1% 8.47M 2m53s
  1600K .......... .......... .......... .......... ..........  1% 4.00M 2m48s
  1650K .......... .......... .......... .......... ..........  1% 11.5M 2m43s
  1700K .......... .......... .......... .......... ..........  1%  997K 2m42s
  1750K .......... .......... .......... .......... ..........  1% 5.25M 2m38s
  1800K .......... .......... .......... .......... ..........  1% 10.9M 2m33s
  1850K .......... .......... .......... .......... ..........  1%  272K 2m39s
  1900K .......... .......... .......... .......... ..........  1% 1.40M 2m36s
  1950K .......... .......... .......... .......... ..........  1% 10.7M 2m33s
  2000K .......... .......... .......... .......... ..........  2% 5.43M 2m29s
  2050K .......... .......... .......... .......... ..........  2% 10.6M 2m26s
  2100K .......... .......... .......... .......... ..........  2% 3.01M 2m23s
  2150K .......... .......... .......... .......... ..........  2% 1.71M 2m21s
  2200K .......... .......... .......... .......... ..........  2% 9.23M 2m18s
  2250K .......... .......... .......... .......... ..........  2% 9.68M 2m15s
  2300K .......... .......... .......... .......... ..........  2%  971K 2m14s
  2350K .......... .......... .......... .......... ..........  2% 1.54M 2m13s
  2400K .......... .......... .......... .......... ..........  2% 6.30M 2m10s
  2450K .......... .......... .......... .......... ..........  2% 29.4M 2m8s
  2500K .......... .......... .......... .......... ..........  2% 3.84M 2m6s
  2550K .......... .......... .......... .......... ..........  2%  853K 2m5s
  2600K .......... .......... .......... .......... ..........  2%  146M 2m3s
  2650K .......... .......... .......... .......... ..........  2% 21.4M 2m1s
  2700K .......... .......... .......... .......... ..........  2% 22.2M 1m59s
  2750K .......... .......... .......... .......... ..........  2% 1018K 1m58s
  2800K .......... .......... .......... .......... ..........  2% 7.54M 1m56s
  2850K .......... .......... .......... .......... ..........  2% 5.36M 1m54s
  2900K .......... .......... .......... .......... ..........  2%  225K 2m0s
  2950K .......... .......... .......... .......... ..........  2% 5.40M 1m58s
  3000K .......... .......... .......... .......... ..........  3% 8.71M 1m56s
  3050K .......... .......... .......... .......... ..........  3% 2.33M 1m55s
  3100K .......... .......... .......... .......... ..........  3% 25.5M 1m53s
  3150K .......... .......... .......... .......... ..........  3% 99.2M 1m51s
  3200K .......... .......... .......... .......... ..........  3%  187M 1m50s
  3250K .......... .......... .......... .......... ..........  3% 45.1M 1m48s
  3300K .......... .......... .......... .......... ..........  3%  419K 1m50s
  3350K .......... .......... .......... .......... ..........  3% 26.8M 1m48s
  3400K .......... .......... .......... .......... ..........  3% 18.9M 1m47s
  3450K .......... .......... .......... .......... ..........  3%  907K 1m46s
  3500K .......... .......... .......... .......... ..........  3% 14.1M 1m45s
  3550K .......... .......... .......... .......... ..........  3% 8.15M 1m44s
  3600K .......... .......... .......... .......... ..........  3% 1.00M 1m44s
  3650K .......... .......... .......... .......... ..........  3% 10.7M 1m42s
  3700K .......... .......... .......... .......... ..........  3% 11.0M 1m41s
  3750K .......... .......... .......... .......... ..........  3% 6.06M 1m40s
  3800K .......... .......... .......... .......... ..........  3%  104M 98s
  3850K .......... .......... .......... .......... ..........  3%  895K 98s
  3900K .......... .......... .......... .......... ..........  3% 1.50M 98s
  3950K .......... .......... .......... .......... ..........  3% 88.1M 97s
  4000K .......... .......... .......... .......... ..........  4%  152M 95s
  4050K .......... .......... .......... .......... ..........  4% 2.69M 95s
  4100K .......... .......... .......... .......... ..........  4% 4.28M 94s
  4150K .......... .......... .......... .......... ..........  4% 3.90M 93s
  4200K .......... .......... .......... .......... ..........  4% 2.80M 92s
  4250K .......... .......... .......... .......... ..........  4% 10.6M 91s
  4300K .......... .......... .......... .......... ..........  4% 2.67M 90s
  4350K .......... .......... .......... .......... ..........  4% 1.59M 90s
  4400K .......... .......... .......... .......... ..........  4% 9.93M 89s
  4450K .......... .......... .......... .......... ..........  4% 8.87M 88s
  4500K .......... .......... .......... .......... ..........  4% 1.33M 88s
  4550K .......... .......... .......... .......... ..........  4%  159M 87s
  4600K .......... .......... .......... .......... ..........  4% 2.03M 86s
  4650K .......... .......... .......... .......... ..........  4% 15.3M 86s
  4700K .......... .......... .......... .......... ..........  4% 3.59M 85s
  4750K .......... .......... .......... .......... ..........  4% 2.96M 84s
  4800K .......... .......... .......... .......... ..........  4% 6.28M 83s
  4850K .......... .......... .......... .......... ..........  4% 2.21M 83s
  4900K .......... .......... .......... .......... ..........  4% 4.82M 82s
  4950K .......... .......... .......... .......... ..........  4% 10.1M 82s
  5000K .......... .......... .......... .......... ..........  5% 1.76M 81s
  5050K .......... .......... .......... .......... ..........  5% 2.01M 81s
  5100K .......... .......... .......... .......... ..........  5% 7.12M 80s
  5150K .......... .......... .......... .......... ..........  5% 7.71M 79s
  5200K .......... .......... .......... .......... ..........  5% 19.3M 79s
  5250K .......... .......... .......... .......... ..........  5%  915K 79s
  5300K .......... .......... .......... .......... ..........  5% 11.3M 78s
  5350K .......... .......... .......... .......... ..........  5% 12.9M 77s
  5400K .......... .......... .......... .......... ..........  5% 10.8M 77s
  5450K .......... .......... .......... .......... ..........  5%  940K 77s
  5500K .......... .......... .......... .......... ..........  5% 16.6M 76s
  5550K .......... .......... .......... .......... ..........  5% 3.91M 76s
  5600K .......... .......... .......... .......... ..........  5% 35.2M 75s
  5650K .......... .......... .......... .......... ..........  5% 1.80M 75s
  5700K .......... .......... .......... .......... ..........  5% 2.28M 75s
  5750K .......... .......... .......... .......... ..........  5% 11.4M 74s
  5800K .......... .......... .......... .......... ..........  5% 10.7M 73s
  5850K .......... .......... .......... .......... ..........  5% 1.86M 73s
  5900K .......... .......... .......... .......... ..........  5% 1016K 73s
  5950K .......... .......... .......... .......... ..........  5% 87.3M 73s
  6000K .......... .......... .......... .......... ..........  6% 14.0M 72s
  6050K .......... .......... .......... .......... ..........  6%  182M 71s
  6100K .......... .......... .......... .......... ..........  6% 1.27M 71s
  6150K .......... .......... .......... .......... ..........  6% 11.8M 71s
  6200K .......... .......... .......... .......... ..........  6% 6.76M 70s
  6250K .......... .......... .......... .......... ..........  6% 12.5M 70s
  6300K .......... .......... .......... .......... ..........  6% 5.33M 69s
  6350K .......... .......... .......... .......... ..........  6% 1.28M 69s
  6400K .......... .......... .......... .......... ..........  6% 2.89M 69s
  6450K .......... .......... .......... .......... ..........  6% 5.53M 69s
  6500K .......... .......... .......... .......... ..........  6% 36.6M 68s
  6550K .......... .......... .......... .......... ..........  6% 1.60M 68s
  6600K .......... .......... .......... .......... ..........  6% 2.72M 68s
  6650K .......... .......... .......... .......... ..........  6% 2.54M 67s
  6700K .......... .......... .......... .......... ..........  6% 9.58M 67s
  6750K .......... .......... .......... .......... ..........  6% 5.47M 66s
  6800K .......... .......... .......... .......... ..........  6% 7.53M 66s
  6850K .......... .......... .......... .......... ..........  6% 1.08M 66s
  6900K .......... .......... .......... .......... ..........  6% 9.28M 66s
  6950K .......... .......... .......... .......... ..........  6% 12.0M 65s
  7000K .......... .......... .......... .......... ..........  7% 6.39M 65s
  7050K .......... .......... .......... .......... ..........  7% 34.6M 64s
  7100K .......... .......... .......... .......... ..........  7% 1.10M 64s
  7150K .......... .......... .......... .......... ..........  7% 7.69M 64s
  7200K .......... .......... .......... .......... ..........  7% 5.98M 64s
  7250K .......... .......... .......... .......... ..........  7% 14.2M 63s
  7300K .......... .......... .......... .......... ..........  7% 1.38M 63s
  7350K .......... .......... .......... .......... ..........  7% 3.57M 63s
  7400K .......... .......... .......... .......... ..........  7% 8.75M 63s
  7450K .......... .......... .......... .......... ..........  7% 11.3M 62s
  7500K .......... .......... .......... .......... ..........  7% 1.36M 62s
  7550K .......... .......... .......... .......... ..........  7% 6.81M 62s
  7600K .......... .......... .......... .......... ..........  7% 7.19M 61s
  7650K .......... .......... .......... .......... ..........  7% 4.98M 61s
  7700K .......... .......... .......... .......... ..........  7% 4.50M 61s
  7750K .......... .......... .......... .......... ..........  7% 1.70M 61s
  7800K .......... .......... .......... .......... ..........  7% 4.97M 60s
  7850K .......... .......... .......... .......... ..........  7% 13.2M 60s
  7900K .......... .......... .......... .......... ..........  7% 2.79M 60s
  7950K .......... .......... .......... .......... ..........  7% 2.95M 60s
  8000K .......... .......... .......... .......... ..........  8% 3.11M 59s
  8050K .......... .......... .......... .......... ..........  8% 6.07M 59s
  8100K .......... .......... .......... .......... ..........  8% 8.39M 59s
  8150K .......... .......... .......... .......... ..........  8% 3.47M 59s
  8200K .......... .......... .......... .......... ..........  8% 2.62M 58s
  8250K .......... .......... .......... .......... ..........  8% 4.00M 58s
  8300K .......... .......... .......... .......... ..........  8% 3.86M 58s
  8350K .......... .......... .......... .......... ..........  8% 5.81M 58s
  8400K .......... .......... .......... .......... ..........  8% 2.12M 58s
  8450K .......... .......... .......... .......... ..........  8% 8.38M 57s
  8500K .......... .......... .......... .......... ..........  8% 4.09M 57s
  8550K .......... .......... .......... .......... ..........  8% 4.91M 57s
  8600K .......... .......... .......... .......... ..........  8% 9.51M 56s
  8650K .......... .......... .......... .......... ..........  8% 1.67M 56s
  8700K .......... .......... .......... .......... ..........  8% 11.3M 56s
  8750K .......... .......... .......... .......... ..........  8% 3.60M 56s
  8800K .......... .......... .......... .......... ..........  8% 5.64M 56s
  8850K .......... .......... .......... .......... ..........  8% 4.04M 55s
  8900K .......... .......... .......... .......... ..........  8% 1.14M 55s
  8950K .......... .......... .......... .......... ..........  8% 63.4M 55s
  9000K .......... .......... .......... .......... ..........  9%  178M 55s
  9050K .......... .......... .......... .......... ..........  9% 8.98M 55s
  9100K .......... .......... .......... .......... ..........  9% 8.83M 54s
  9150K .......... .......... .......... .......... ..........  9% 1.43M 54s
  9200K .......... .......... .......... .......... ..........  9% 7.93M 54s
  9250K .......... .......... .......... .......... ..........  9% 3.39M 54s
  9300K .......... .......... .......... .......... ..........  9% 8.88M 54s
  9350K .......... .......... .......... .......... ..........  9% 11.4M 53s
  9400K .......... .......... .......... .......... ..........  9% 1.72M 53s
  9450K .......... .......... .......... .......... ..........  9% 4.12M 53s
  9500K .......... .......... .......... .......... ..........  9% 9.17M 53s
  9550K .......... .......... .......... .......... ..........  9% 2.67M 53s
  9600K .......... .......... .......... .......... ..........  9% 2.59M 53s
  9650K .......... .......... .......... .......... ..........  9% 4.22M 52s
  9700K .......... .......... .......... .......... ..........  9% 5.52M 52s
  9750K .......... .......... .......... .......... ..........  9% 5.71M 52s
  9800K .......... .......... .......... .......... ..........  9% 1.97M 52s
  9850K .......... .......... .......... .......... ..........  9% 8.29M 52s
  9900K .......... .......... .......... .......... ..........  9% 5.04M 51s
  9950K .......... .......... .......... .......... ..........  9% 3.14M 51s
 10000K .......... .......... .......... .......... .......... 10% 9.81M 51s
 10050K .......... .......... .......... .......... .......... 10% 1.89M 51s
 10100K .......... .......... .......... .......... .......... 10% 8.68M 51s
 10150K .......... .......... .......... .......... .......... 10% 5.22M 51s
 10200K .......... .......... .......... .......... .......... 10% 2.67M 50s
 10250K .......... .......... .......... .......... .......... 10% 11.5M 50s
 10300K .......... .......... .......... .......... .......... 10% 2.59M 50s
 10350K .......... .......... .......... .......... .......... 10% 3.15M 50s
 10400K .......... .......... .......... .......... .......... 10% 2.96M 50s
 10450K .......... .......... .......... .......... .......... 10% 4.15M 50s
 10500K .......... .......... .......... .......... .......... 10% 46.3M 49s
 10550K .......... .......... .......... .......... .......... 10% 3.34M 49s
 10600K .......... .......... .......... .......... .......... 10% 2.69M 49s
 10650K .......... .......... .......... .......... .......... 10% 2.64M 49s
 10700K .......... .......... .......... .......... .......... 10% 7.17M 49s
 10750K .......... .......... .......... .......... .......... 10% 6.44M 49s
 10800K .......... .......... .......... .......... .......... 10% 2.77M 49s
 10850K .......... .......... .......... .......... .......... 10% 3.08M 48s
 10900K .......... .......... .......... .......... .......... 10% 3.43M 48s
 10950K .......... .......... .......... .......... .......... 10% 3.20M 48s
 11000K .......... .......... .......... .......... .......... 10% 8.51M 48s
 11050K .......... .......... .......... .......... .......... 11% 4.30M 48s
 11100K .......... .......... .......... .......... .......... 11% 2.09M 48s
 11150K .......... .......... .......... .......... .......... 11% 6.21M 48s
 11200K .......... .......... .......... .......... .......... 11% 4.11M 47s
 11250K .......... .......... .......... .......... .......... 11% 1.20M 48s
 11300K .......... .......... .......... .......... .......... 11% 1.78M 48s
 11350K .......... .......... .......... .......... .......... 11% 30.6M 47s
 11400K .......... .......... .......... .......... .......... 11% 14.1M 47s
 11450K .......... .......... .......... .......... .......... 11% 28.9M 47s
 11500K .......... .......... .......... .......... .......... 11%  717K 47s
 11550K .......... .......... .......... .......... .......... 11% 27.8M 47s
 11600K .......... .......... .......... .......... .......... 11% 72.4M 47s
 11650K .......... .......... .......... .......... .......... 11% 73.0M 47s
 11700K .......... .......... .......... .......... .......... 11%  897K 47s
 11750K .......... .......... .......... .......... .......... 11% 3.39M 47s
 11800K .......... .......... .......... .......... .......... 11% 11.6M 46s
 11850K .......... .......... .......... .......... .......... 11% 1.46M 46s
 11900K .......... .......... .......... .......... .......... 11% 10.0M 46s
 11950K .......... .......... .......... .......... .......... 11% 6.55M 46s
 12000K .......... .......... .......... .......... .......... 11% 4.03M 46s
 12050K .......... .......... .......... .......... .......... 12% 7.90M 46s
 12100K .......... .......... .......... .......... .......... 12% 1.46M 46s
 12150K .......... .......... .......... .......... .......... 12% 8.41M 46s
 12200K .......... .......... .......... .......... .......... 12% 13.2M 45s
 12250K .......... .......... .......... .......... .......... 12% 5.96M 45s
 12300K .......... .......... .......... .......... .......... 12% 5.32M 45s
 12350K .......... .......... .......... .......... .......... 12% 1.58M 45s
 12400K .......... .......... .......... .......... .......... 12% 5.49M 45s
 12450K .......... .......... .......... .......... .......... 12% 9.77M 45s
 12500K .......... .......... .......... .......... .......... 12% 8.25M 45s
 12550K .......... .......... .......... .......... .......... 12% 1.23M 45s
 12600K .......... .......... .......... .......... .......... 12% 8.25M 45s
 12650K .......... .......... .......... .......... .......... 12% 17.6M 44s
 12700K .......... .......... .......... .......... .......... 12% 9.68M 44s
 12750K .......... .......... .......... .......... .......... 12% 1.26M 44s
 12800K .......... .......... .......... .......... .......... 12% 4.01M 44s
 12850K .......... .......... .......... .......... .......... 12% 3.73M 44s
 12900K .......... .......... .......... .......... .......... 12% 20.4M 44s
 12950K .......... .......... .......... .......... .......... 12% 31.4M 44s
 13000K .......... .......... .......... .......... .......... 12% 11.9M 44s
 13050K .......... .......... .......... .......... .......... 13% 1.25M 44s
 13100K .......... .......... .......... .......... .......... 13% 2.88M 44s
 13150K .......... .......... .......... .......... .......... 13% 7.15M 43s
 13200K .......... .......... .......... .......... .......... 13% 11.2M 43s
 13250K .......... .......... .......... .......... .......... 13% 3.03M 43s
 13300K .......... .......... .......... .......... .......... 13% 1.60M 43s
 13350K .......... .......... .......... .......... .......... 13% 8.61M 43s
 13400K .......... .......... .......... .......... .......... 13% 10.8M 43s
 13450K .......... .......... .......... .......... .......... 13% 8.76M 43s
 13500K .......... .......... .......... .......... .......... 13% 8.00M 43s
 13550K .......... .......... .......... .......... .......... 13% 1.10M 43s
 13600K .......... .......... .......... .......... .......... 13% 10.8M 43s
 13650K .......... .......... .......... .......... .......... 13% 11.2M 42s
 13700K .......... .......... .......... .......... .......... 13% 1.08M 43s
 13750K .......... .......... .......... .......... .......... 13% 8.99M 42s
 13800K .......... .......... .......... .......... .......... 13% 2.51M 42s
 13850K .......... .......... .......... .......... .......... 13% 24.4M 42s
 13900K .......... .......... .......... .......... .......... 13% 10.6M 42s
 13950K .......... .......... .......... .......... .......... 13% 1.94M 42s
 14000K .......... .......... .......... .......... .......... 13% 1.97M 42s
 14050K .......... .......... .......... .......... .......... 14% 11.6M 42s
 14100K .......... .......... .......... .......... .......... 14% 9.23M 42s
 14150K .......... .......... .......... .......... .......... 14% 2.33M 42s
 14200K .......... .......... .......... .......... .......... 14% 9.34M 42s
 14250K .......... .......... .......... .......... .......... 14% 2.85M 41s
 14300K .......... .......... .......... .......... .......... 14% 3.10M 41s
 14350K .......... .......... .......... .......... .......... 14% 7.34M 41s
 14400K .......... .......... .......... .......... .......... 14% 3.20M 41s
 14450K .......... .......... .......... .......... .......... 14% 6.34M 41s
 14500K .......... .......... .......... .......... .......... 14% 4.45M 41s
 14550K .......... .......... .......... .......... .......... 14% 3.03M 41s
 14600K .......... .......... .......... .......... .......... 14% 4.92M 41s
 14650K .......... .......... .......... .......... .......... 14% 5.18M 41s
 14700K .......... .......... .......... .......... .......... 14% 3.73M 41s
 14750K .......... .......... .......... .......... .......... 14% 2.49M 41s
 14800K .......... .......... .......... .......... .......... 14% 9.46M 40s
 14850K .......... .......... .......... .......... .......... 14% 1.75M 40s
 14900K .......... .......... .......... .......... .......... 14% 8.65M 40s
 14950K .......... .......... .......... .......... .......... 14% 11.8M 40s
 15000K .......... .......... .......... .......... .......... 14% 2.91M 40s
 15050K .......... .......... .......... .......... .......... 15% 1.58M 40s
 15100K .......... .......... .......... .......... .......... 15% 48.1M 40s
 15150K .......... .......... .......... .......... .......... 15% 6.16M 40s
 15200K .......... .......... .......... .......... .......... 15% 5.85M 40s
 15250K .......... .......... .......... .......... .......... 15% 4.54M 40s
 15300K .......... .......... .......... .......... .......... 15% 1.74M 40s
 15350K .......... .......... .......... .......... .......... 15% 7.10M 40s
 15400K .......... .......... .......... .......... .......... 15% 8.72M 39s
 15450K .......... .......... .......... .......... .......... 15% 3.14M 39s
 15500K .......... .......... .......... .......... .......... 15% 8.77M 39s
 15550K .......... .......... .......... .......... .......... 15% 1.15M 39s
 15600K .......... .......... .......... .......... .......... 15% 7.72M 39s
 15650K .......... .......... .......... .......... .......... 15% 6.82M 39s
 15700K .......... .......... .......... .......... .......... 15%  446K 40s
 15750K .......... .......... .......... .......... .......... 15% 1.23M 40s
 15800K .......... .......... .......... .......... .......... 15% 42.3M 39s
 15850K .......... .......... .......... .......... .......... 15% 35.3M 39s
 15900K .......... .......... .......... .......... .......... 15% 44.0M 39s
 15950K .......... .......... .......... .......... .......... 15% 32.1M 39s
 16000K .......... .......... .......... .......... .......... 15% 9.46M 39s
 16050K .......... .......... .......... .......... .......... 16% 5.08M 39s
 16100K .......... .......... .......... .......... .......... 16% 49.0M 39s
 16150K .......... .......... .......... .......... .......... 16% 7.79M 39s
 16200K .......... .......... .......... .......... .......... 16% 14.5M 38s
 16250K .......... .......... .......... .......... .......... 16% 1.00M 39s
 16300K .......... .......... .......... .......... .......... 16% 13.8M 38s
 16350K .......... .......... .......... .......... .......... 16% 8.22M 38s
 16400K .......... .......... .......... .......... .......... 16% 10.2M 38s
 16450K .......... .......... .......... .......... .......... 16% 1.08M 38s
 16500K .......... .......... .......... .......... .......... 16% 12.6M 38s
 16550K .......... .......... .......... .......... .......... 16% 11.2M 38s
 16600K .......... .......... .......... .......... .......... 16% 1.24M 38s
 16650K .......... .......... .......... .......... .......... 16% 33.3M 38s
 16700K .......... .......... .......... .......... .......... 16% 48.2M 38s
 16750K .......... .......... .......... .......... .......... 16%  986K 38s
 16800K .......... .......... .......... .......... .......... 16% 2.64M 38s
 16850K .......... .......... .......... .......... .......... 16% 87.3M 38s
 16900K .......... .......... .......... .......... .......... 16% 86.0M 38s
 16950K .......... .......... .......... .......... .......... 16% 1.44M 38s
 17000K .......... .......... .......... .......... .......... 16% 5.27M 38s
 17050K .......... .......... .......... .......... .......... 17%  935K 38s
 17100K .......... .......... .......... .......... .......... 17% 13.5M 38s
 17150K .......... .......... .......... .......... .......... 17% 25.2M 38s
 17200K .......... .......... .......... .......... .......... 17% 54.4M 37s
 17250K .......... .......... .......... .......... .......... 17% 48.9M 37s
 17300K .......... .......... .......... .......... .......... 17%  928K 37s
 17350K .......... .......... .......... .......... .......... 17% 6.44M 37s
 17400K .......... .......... .......... .......... .......... 17% 11.1M 37s
 17450K .......... .......... .......... .......... .......... 17% 9.49M 37s
 17500K .......... .......... .......... .......... .......... 17% 1.22M 37s
 17550K .......... .......... .......... .......... .......... 17% 7.05M 37s
 17600K .......... .......... .......... .......... .......... 17% 6.17M 37s
 17650K .......... .......... .......... .......... .......... 17% 5.79M 37s
 17700K .......... .......... .......... .......... .......... 17% 37.6M 37s
 17750K .......... .......... .......... .......... .......... 17% 1.23M 37s
 17800K .......... .......... .......... .......... .......... 17% 6.17M 37s
 17850K .......... .......... .......... .......... .......... 17% 10.1M 37s
 17900K .......... .......... .......... .......... .......... 17% 14.0M 37s
 17950K .......... .......... .......... .......... .......... 17% 1.15M 37s
 18000K .......... .......... .......... .......... .......... 17% 8.59M 37s
 18050K .......... .......... .......... .......... .......... 18% 7.76M 36s
 18100K .......... .......... .......... .......... .......... 18% 3.74M 36s
 18150K .......... .......... .......... .......... .......... 18% 27.3M 36s
 18200K .......... .......... .......... .......... .......... 18% 1.60M 36s
 18250K .......... .......... .......... .......... .......... 18% 3.53M 36s
 18300K .......... .......... .......... .......... .......... 18% 10.1M 36s
 18350K .......... .......... .......... .......... .......... 18% 8.21M 36s
 18400K .......... .......... .......... .......... .......... 18% 1.39M 36s
 18450K .......... .......... .......... .......... .......... 18% 18.4M 36s
 18500K .......... .......... .......... .......... .......... 18% 7.20M 36s
 18550K .......... .......... .......... .......... .......... 18% 4.38M 36s
 18600K .......... .......... .......... .......... .......... 18% 8.48M 36s
 18650K .......... .......... .......... .......... .......... 18% 1.75M 36s
 18700K .......... .......... .......... .......... .......... 18% 4.28M 36s
 18750K .......... .......... .......... .......... .......... 18% 4.62M 36s
 18800K .......... .......... .......... .......... .......... 18% 4.59M 35s
 18850K .......... .......... .......... .......... .......... 18% 12.3M 35s
 18900K .......... .......... .......... .......... .......... 18% 1.56M 35s
 18950K .......... .......... .......... .......... .......... 18% 12.9M 35s
 19000K .......... .......... .......... .......... .......... 18% 3.31M 35s
 19050K .......... .......... .......... .......... .......... 19% 6.64M 35s
 19100K .......... .......... .......... .......... .......... 19% 11.7M 35s
 19150K .......... .......... .......... .......... .......... 19% 1017K 35s
 19200K .......... .......... .......... .......... .......... 19% 3.88M 35s
 19250K .......... .......... .......... .......... .......... 19% 3.79M 35s
 19300K .......... .......... .......... .......... .......... 19% 1.82M 35s
 19350K .......... .......... .......... .......... .......... 19% 2.12M 35s
 19400K .......... .......... .......... .......... .......... 19% 20.7M 35s
 19450K .......... .......... .......... .......... .......... 19% 5.67M 35s
 19500K .......... .......... .......... .......... .......... 19% 1.25M 35s
 19550K .......... .......... .......... .......... .......... 19% 7.06M 35s
 19600K .......... .......... .......... .......... .......... 19% 4.26M 35s
 19650K .......... .......... .......... .......... .......... 19% 14.1M 35s
 19700K .......... .......... .......... .......... .......... 19% 6.65M 35s
 19750K .......... .......... .......... .......... .......... 19% 6.03M 35s
 19800K .......... .......... .......... .......... .......... 19% 1.38M 35s
 19850K .......... .......... .......... .......... .......... 19% 3.64M 34s
 19900K .......... .......... .......... .......... .......... 19% 40.6M 34s
 19950K .......... .......... .......... .......... .......... 19% 8.24M 34s
 20000K .......... .......... .......... .......... .......... 19% 1.35M 34s
 20050K .......... .......... .......... .......... .......... 20% 5.43M 34s
 20100K .......... .......... .......... .......... .......... 20% 11.9M 34s
 20150K .......... .......... .......... .......... .......... 20% 6.34M 34s
 20200K .......... .......... .......... .......... .......... 20% 10.0M 34s
 20250K .......... .......... .......... .......... .......... 20% 8.23M 34s
 20300K .......... .......... .......... .......... .......... 20% 1.49M 34s
 20350K .......... .......... .......... .......... .......... 20% 3.51M 34s
 20400K .......... .......... .......... .......... .......... 20% 12.7M 34s
 20450K .......... .......... .......... .......... .......... 20% 11.9M 34s
 20500K .......... .......... .......... .......... .......... 20% 1.72M 34s
 20550K .......... .......... .......... .......... .......... 20% 13.2M 34s
 20600K .......... .......... .......... .......... .......... 20% 3.18M 34s
 20650K .......... .......... .......... .......... .......... 20% 5.90M 34s
 20700K .......... .......... .......... .......... .......... 20% 6.38M 33s
 20750K .......... .......... .......... .......... .......... 20% 2.37M 33s
 20800K .......... .......... .......... .......... .......... 20% 2.02M 33s
 20850K .......... .......... .......... .......... .......... 20% 8.29M 33s
 20900K .......... .......... .......... .......... .......... 20% 15.2M 33s
 20950K .......... .......... .......... .......... .......... 20% 2.32M 33s
 21000K .......... .......... .......... .......... .......... 20% 9.49M 33s
 21050K .......... .......... .......... .......... .......... 21% 2.99M 33s
 21100K .......... .......... .......... .......... .......... 21% 1.60M 33s
 21150K .......... .......... .......... .......... .......... 21% 13.2M 33s
 21200K .......... .......... .......... .......... .......... 21% 20.2M 33s
 21250K .......... .......... .......... .......... .......... 21% 1.07M 33s
 21300K .......... .......... .......... .......... .......... 21% 47.8M 33s
 21350K .......... .......... .......... .......... .......... 21% 11.2M 33s
 21400K .......... .......... .......... .......... .......... 21% 13.0M 33s
 21450K .......... .......... .......... .......... .......... 21% 9.70M 33s
 21500K .......... .......... .......... .......... .......... 21% 6.57M 33s
 21550K .......... .......... .......... .......... .......... 21% 1.30M 33s
 21600K .......... .......... .......... .......... .......... 21% 4.27M 33s
 21650K .......... .......... .......... .......... .......... 21% 12.3M 33s
 21700K .......... .......... .......... .......... .......... 21% 7.90M 32s
 21750K .......... .......... .......... .......... .......... 21% 1.51M 32s
 21800K .......... .......... .......... .......... .......... 21% 9.18M 32s
 21850K .......... .......... .......... .......... .......... 21% 11.1M 32s
 21900K .......... .......... .......... .......... .......... 21% 5.59M 32s
 21950K .......... .......... .......... .......... .......... 21% 3.18M 32s
 22000K .......... .......... .......... .......... .......... 21% 9.17M 32s
 22050K .......... .......... .......... .......... .......... 21% 2.17M 32s
 22100K .......... .......... .......... .......... .......... 22% 3.36M 32s
 22150K .......... .......... .......... .......... .......... 22% 9.04M 32s
 22200K .......... .......... .......... .......... .......... 22% 3.06M 32s
 22250K .......... .......... .......... .......... .......... 22% 10.0M 32s
 22300K .......... .......... .......... .......... .......... 22% 10.9M 32s
 22350K .......... .......... .......... .......... .......... 22% 1.47M 32s
 22400K .......... .......... .......... .......... .......... 22% 21.5M 32s
 22450K .......... .......... .......... .......... .......... 22% 2.39M 32s
 22500K .......... .......... .......... .......... .......... 22% 13.2M 32s
 22550K .......... .......... .......... .......... .......... 22% 1.27M 32s
 22600K .......... .......... .......... .......... .......... 22% 30.9M 32s
 22650K .......... .......... .......... .......... .......... 22% 3.85M 32s
 22700K .......... .......... .......... .......... .......... 22% 8.48M 32s
 22750K .......... .......... .......... .......... .......... 22% 1.38M 32s
 22800K .......... .......... .......... .......... .......... 22% 3.07M 32s
 22850K .......... .......... .......... .......... .......... 22% 33.8M 31s
 22900K .......... .......... .......... .......... .......... 22% 6.61M 31s
 22950K .......... .......... .......... .......... .......... 22% 13.8M 31s
 23000K .......... .......... .......... .......... .......... 22% 8.37M 31s
 23050K .......... .......... .......... .......... .......... 22% 1.14M 31s
 23100K .......... .......... .......... .......... .......... 23% 12.0M 31s
 23150K .......... .......... .......... .......... .......... 23% 8.08M 31s
 23200K .......... .......... .......... .......... .......... 23% 8.07M 31s
 23250K .......... .......... .......... .......... .......... 23% 9.43M 31s
 23300K .......... .......... .......... .......... .......... 23% 1.23M 31s
 23350K .......... .......... .......... .......... .......... 23% 7.51M 31s
 23400K .......... .......... .......... .......... .......... 23% 10.9M 31s
 23450K .......... .......... .......... .......... .......... 23% 10.4M 31s
 23500K .......... .......... .......... .......... .......... 23% 1.13M 31s
 23550K .......... .......... .......... .......... .......... 23% 11.5M 31s
 23600K .......... .......... .......... .......... .......... 23% 12.5M 31s
 23650K .......... .......... .......... .......... .......... 23% 5.48M 31s
 23700K .......... .......... .......... .......... .......... 23% 8.45M 31s
 23750K .......... .......... .......... .......... .......... 23% 1.13M 31s
 23800K .......... .......... .......... .......... .......... 23% 15.4M 31s
 23850K .......... .......... .......... .......... .......... 23% 21.2M 31s
 23900K .......... .......... .......... .......... .......... 23% 5.12M 30s
 23950K .......... .......... .......... .......... .......... 23% 7.89M 30s
 24000K .......... .......... .......... .......... .......... 23% 9.98M 30s
 24050K .......... .......... .......... .......... .......... 23%  802K 30s
 24100K .......... .......... .......... .......... .......... 24% 13.0M 30s
 24150K .......... .......... .......... .......... .......... 24% 28.0M 30s
 24200K .......... .......... .......... .......... .......... 24% 43.7M 30s
 24250K .......... .......... .......... .......... .......... 24% 11.0M 30s
 24300K .......... .......... .......... .......... .......... 24%  952K 30s
 24350K .......... .......... .......... .......... .......... 24% 8.07M 30s
 24400K .......... .......... .......... .......... .......... 24% 7.78M 30s
 24450K .......... .......... .......... .......... .......... 24% 17.8M 30s
 24500K .......... .......... .......... .......... .......... 24% 1.08M 30s
 24550K .......... .......... .......... .......... .......... 24% 8.81M 30s
 24600K .......... .......... .......... .......... .......... 24% 10.2M 30s
 24650K .......... .......... .......... .......... .......... 24% 11.5M 30s
 24700K .......... .......... .......... .......... .......... 24% 6.25M 30s
 24750K .......... .......... .......... .......... .......... 24% 1.25M 30s
 24800K .......... .......... .......... .......... .......... 24% 8.31M 30s
 24850K .......... .......... .......... .......... .......... 24% 7.69M 30s
 24900K .......... .......... .......... .......... .......... 24% 5.66M 30s
 24950K .......... .......... .......... .......... .......... 24% 9.95M 30s
 25000K .......... .......... .......... .......... .......... 24% 1.25M 30s
 25050K .......... .......... .......... .......... .......... 24% 6.81M 30s
 25100K .......... .......... .......... .......... .......... 25% 2.98M 30s
 25150K .......... .......... .......... .......... .......... 25% 4.14M 30s
 25200K .......... .......... .......... .......... .......... 25% 2.07M 30s
 25250K .......... .......... .......... .......... .......... 25% 13.9M 29s
 25300K .......... .......... .......... .......... .......... 25% 9.24M 29s
 25350K .......... .......... .......... .......... .......... 25% 2.04M 29s
 25400K .......... .......... .......... .......... .......... 25% 14.3M 29s
 25450K .......... .......... .......... .......... .......... 25% 1.43M 29s
 25500K .......... .......... .......... .......... .......... 25% 5.46M 29s
 25550K .......... .......... .......... .......... .......... 25% 4.76M 29s
 25600K .......... .......... .......... .......... .......... 25% 5.95M 29s
 25650K .......... .......... .......... .......... .......... 25% 1.61M 29s
 25700K .......... .......... .......... .......... .......... 25% 6.44M 29s
 25750K .......... .......... .......... .......... .......... 25% 19.7M 29s
 25800K .......... .......... .......... .......... .......... 25% 3.41M 29s
 25850K .......... .......... .......... .......... .......... 25% 8.25M 29s
 25900K .......... .......... .......... .......... .......... 25% 1.59M 29s
 25950K .......... .......... .......... .......... .......... 25% 6.02M 29s
 26000K .......... .......... .......... .......... .......... 25% 4.00M 29s
 26050K .......... .......... .......... .......... .......... 25% 7.41M 29s
 26100K .......... .......... .......... .......... .......... 26% 1.54M 29s
 26150K .......... .......... .......... .......... .......... 26% 12.5M 29s
 26200K .......... .......... .......... .......... .......... 26% 10.6M 29s
 26250K .......... .......... .......... .......... .......... 26% 3.16M 29s
 26300K .......... .......... .......... .......... .......... 26% 10.2M 29s
 26350K .......... .......... .......... .......... .......... 26% 1.50M 29s
 26400K .......... .......... .......... .......... .......... 26% 10.1M 29s
 26450K .......... .......... .......... .......... .......... 26% 2.92M 29s
 26500K .......... .......... .......... .......... .......... 26% 10.7M 29s
 26550K .......... .......... .......... .......... .......... 26% 1.37M 29s
 26600K .......... .......... .......... .......... .......... 26% 14.6M 29s
 26650K .......... .......... .......... .......... .......... 26% 10.3M 28s
 26700K .......... .......... .......... .......... .......... 26% 4.59M 28s
 26750K .......... .......... .......... .......... .......... 26% 4.28M 28s
 26800K .......... .......... .......... .......... .......... 26% 1.54M 28s
 26850K .......... .......... .......... .......... .......... 26% 5.15M 28s
 26900K .......... .......... .......... .......... .......... 26% 6.34M 28s
 26950K .......... .......... .......... .......... .......... 26% 5.50M 28s
 27000K .......... .......... .......... .......... .......... 26% 12.1M 28s
 27050K .......... .......... .......... .......... .......... 26% 1.51M 28s
 27100K .......... .......... .......... .......... .......... 27% 11.3M 28s
 27150K .......... .......... .......... .......... .......... 27% 2.43M 28s
 27200K .......... .......... .......... .......... .......... 27% 5.61M 28s
 27250K .......... .......... .......... .......... .......... 27% 8.22M 28s
 27300K .......... .......... .......... .......... .......... 27% 2.05M 28s
 27350K .......... .......... .......... .......... .......... 27% 4.93M 28s
 27400K .......... .......... .......... .......... .......... 27% 3.68M 28s
 27450K .......... .......... .......... .......... .......... 27% 9.36M 28s
 27500K .......... .......... .......... .......... .......... 27% 1.71M 28s
 27550K .......... .......... .......... .......... .......... 27% 5.95M 28s
 27600K .......... .......... .......... .......... .......... 27% 3.31M 28s
 27650K .......... .......... .......... .......... .......... 27% 8.55M 28s
 27700K .......... .......... .......... .......... .......... 27% 10.3M 28s
 27750K .......... .......... .......... .......... .......... 27% 1.59M 28s
 27800K .......... .......... .......... .......... .......... 27% 10.7M 28s
 27850K .......... .......... .......... .......... .......... 27% 3.38M 28s
 27900K .......... .......... .......... .......... .......... 27% 9.22M 28s
 27950K .......... .......... .......... .......... .......... 27% 1.43M 28s
 28000K .......... .......... .......... .......... .......... 27% 6.83M 28s
 28050K .......... .......... .......... .......... .......... 27% 30.6M 27s
 28100K .......... .......... .......... .......... .......... 28% 3.05M 27s
 28150K .......... .......... .......... .......... .......... 28% 10.3M 27s
 28200K .......... .......... .......... .......... .......... 28% 1.33M 27s
 28250K .......... .......... .......... .......... .......... 28% 9.76M 27s
 28300K .......... .......... .......... .......... .......... 28% 15.2M 27s
 28350K .......... .......... .......... .......... .......... 28% 4.20M 27s
 28400K .......... .......... .......... .......... .......... 28% 10.6M 27s
 28450K .......... .......... .......... .......... .......... 28% 10.5M 27s
 28500K .......... .......... .......... .......... .......... 28% 1.30M 27s
 28550K .......... .......... .......... .......... .......... 28% 4.74M 27s
 28600K .......... .......... .......... .......... .......... 28% 5.21M 27s
 28650K .......... .......... .......... .......... .......... 28% 10.2M 27s
 28700K .......... .......... .......... .......... .......... 28% 41.7M 27s
 28750K .......... .......... .......... .......... .......... 28% 1.33M 27s
 28800K .......... .......... .......... .......... .......... 28% 11.5M 27s
 28850K .......... .......... .......... .......... .......... 28% 3.26M 27s
 28900K .......... .......... .......... .......... .......... 28% 10.5M 27s
 28950K .......... .......... .......... .......... .......... 28% 1.52M 27s
 29000K .......... .......... .......... .......... .......... 28% 9.72M 27s
 29050K .......... .......... .......... .......... .......... 28% 3.65M 27s
 29100K .......... .......... .......... .......... .......... 29% 2.37M 27s
 29150K .......... .......... .......... .......... .......... 29% 8.78M 27s
 29200K .......... .......... .......... .......... .......... 29% 2.55M 27s
 29250K .......... .......... .......... .......... .......... 29% 9.08M 27s
 29300K .......... .......... .......... .......... .......... 29% 6.23M 27s
 29350K .......... .......... .......... .......... .......... 29% 1.16M 27s
 29400K .......... .......... .......... .......... .......... 29% 12.4M 27s
 29450K .......... .......... .......... .......... .......... 29% 7.81M 27s
 29500K .......... .......... .......... .......... .......... 29% 4.68M 27s
 29550K .......... .......... .......... .......... .......... 29% 1011K 27s
 29600K .......... .......... .......... .......... .......... 29% 12.1M 27s
 29650K .......... .......... .......... .......... .......... 29% 6.99M 26s
 29700K .......... .......... .......... .......... .......... 29% 5.34M 26s
 29750K .......... .......... .......... .......... .......... 29% 11.6M 26s
 29800K .......... .......... .......... .......... .......... 29%  743K 26s
 29850K .......... .......... .......... .......... .......... 29% 14.1M 26s
 29900K .......... .......... .......... .......... .......... 29% 37.8M 26s
 29950K .......... .......... .......... .......... .......... 29% 36.5M 26s
 30000K .......... .......... .......... .......... .......... 29% 44.3M 26s
 30050K .......... .......... .......... .......... .......... 29% 22.7M 26s
 30100K .......... .......... .......... .......... .......... 30%  905K 26s
 30150K .......... .......... .......... .......... .......... 30% 10.5M 26s
 30200K .......... .......... .......... .......... .......... 30% 10.8M 26s
 30250K .......... .......... .......... .......... .......... 30% 11.5M 26s
 30300K .......... .......... .......... .......... .......... 30% 11.3M 26s
 30350K .......... .......... .......... .......... .......... 30% 6.75M 26s
 30400K .......... .......... .......... .......... .......... 30% 1.18M 26s
 30450K .......... .......... .......... .......... .......... 30% 5.79M 26s
 30500K .......... .......... .......... .......... .......... 30% 10.6M 26s
 30550K .......... .......... .......... .......... .......... 30% 8.91M 26s
 30600K .......... .......... .......... .......... .......... 30% 13.2M 26s
 30650K .......... .......... .......... .......... .......... 30% 10.1M 26s
 30700K .......... .......... .......... .......... .......... 30% 1.18M 26s
 30750K .......... .......... .......... .......... .......... 30% 1.30M 26s
 30800K .......... .......... .......... .......... .......... 30% 38.0M 26s
 30850K .......... .......... .......... .......... .......... 30% 36.4M 26s
 30900K .......... .......... .......... .......... .......... 30% 3.06M 26s
 30950K .......... .......... .......... .......... .......... 30% 10.9M 26s
 31000K .......... .......... .......... .......... .......... 30% 9.90M 26s
 31050K .......... .......... .......... .......... .......... 30% 1.45M 26s
 31100K .......... .......... .......... .......... .......... 31% 12.9M 26s
 31150K .......... .......... .......... .......... .......... 31% 3.22M 26s
 31200K .......... .......... .......... .......... .......... 31% 11.0M 26s
 31250K .......... .......... .......... .......... .......... 31% 1.38M 26s
 31300K .......... .......... .......... .......... .......... 31% 14.0M 25s
 31350K .......... .......... .......... .......... .......... 31% 7.79M 25s
 31400K .......... .......... .......... .......... .......... 31% 4.55M 25s
 31450K .......... .......... .......... .......... .......... 31% 12.5M 25s
 31500K .......... .......... .......... .......... .......... 31% 1.14M 25s
 31550K .......... .......... .......... .......... .......... 31% 6.48M 25s
 31600K .......... .......... .......... .......... .......... 31% 8.04M 25s
 31650K .......... .......... .......... .......... .......... 31% 13.4M 25s
 31700K .......... .......... .......... .......... .......... 31% 1.39M 25s
 31750K .......... .......... .......... .......... .......... 31% 3.77M 25s
 31800K .......... .......... .......... .......... .......... 31% 4.78M 25s
 31850K .......... .......... .......... .......... .......... 31% 13.1M 25s
 31900K .......... .......... .......... .......... .......... 31% 13.3M 25s
 31950K .......... .......... .......... .......... .......... 31% 7.14M 25s
 32000K .......... .......... .......... .......... .......... 31% 1.04M 25s
 32050K .......... .......... .......... .......... .......... 31% 12.8M 25s
 32100K .......... .......... .......... .......... .......... 31% 8.70M 25s
 32150K .......... .......... .......... .......... .......... 32% 3.69M 25s
 32200K .......... .......... .......... .......... .......... 32% 21.6M 25s
 32250K .......... .......... .......... .......... .......... 32% 7.28M 25s
 32300K .......... .......... .......... .......... .......... 32% 1.29M 25s
 32350K .......... .......... .......... .......... .......... 32% 4.44M 25s
 32400K .......... .......... .......... .......... .......... 32% 6.28M 25s
 32450K .......... .......... .......... .......... .......... 32% 11.8M 25s
 32500K .......... .......... .......... .......... .......... 32% 5.18M 25s
 32550K .......... .......... .......... .......... .......... 32% 1.26M 25s
 32600K .......... .......... .......... .......... .......... 32% 12.7M 25s
 32650K .......... .......... .......... .......... .......... 32% 9.23M 25s
 32700K .......... .......... .......... .......... .......... 32% 7.84M 25s
 32750K .......... .......... .......... .......... .......... 32% 4.56M 25s
 32800K .......... .......... .......... .......... .......... 32% 1.33M 25s
 32850K .......... .......... .......... .......... .......... 32% 16.6M 25s
 32900K .......... .......... .......... .......... .......... 32% 10.7M 25s
 32950K .......... .......... .......... .......... .......... 32% 3.69M 24s
 33000K .......... .......... .......... .......... .......... 32% 6.00M 24s
 33050K .......... .......... .......... .......... .......... 32% 8.19M 24s
 33100K .......... .......... .......... .......... .......... 32%  770K 24s
 33150K .......... .......... .......... .......... .......... 33% 25.0M 24s
 33200K .......... .......... .......... .......... .......... 33% 21.4M 24s
 33250K .......... .......... .......... .......... .......... 33% 28.8M 24s
 33300K .......... .......... .......... .......... .......... 33%  845K 24s
 33350K .......... .......... .......... .......... .......... 33% 15.0M 24s
 33400K .......... .......... .......... .......... .......... 33% 43.1M 24s
 33450K .......... .......... .......... .......... .......... 33% 8.64M 24s
 33500K .......... .......... .......... .......... .......... 33% 4.34M 24s
 33550K .......... .......... .......... .......... .......... 33% 1.08M 24s
 33600K .......... .......... .......... .......... .......... 33% 2.17M 24s
 33650K .......... .......... .......... .......... .......... 33% 13.3M 24s
 33700K .......... .......... .......... .......... .......... 33% 2.47M 24s
 33750K .......... .......... .......... .......... .......... 33% 5.86M 24s
 33800K .......... .......... .......... .......... .......... 33% 1.63M 24s
 33850K .......... .......... .......... .......... .......... 33% 3.47M 24s
 33900K .......... .......... .......... .......... .......... 33% 36.5M 24s
 33950K .......... .......... .......... .......... .......... 33% 1.11M 24s
 34000K .......... .......... .......... .......... .......... 33% 13.8M 24s
 34050K .......... .......... .......... .......... .......... 33% 3.48M 24s
 34100K .......... .......... .......... .......... .......... 33% 8.18M 24s
 34150K .......... .......... .......... .......... .......... 34% 8.34M 24s
 34200K .......... .......... .......... .......... .......... 34% 5.19M 24s
 34250K .......... .......... .......... .......... .......... 34% 1.27M 24s
 34300K .......... .......... .......... .......... .......... 34% 9.87M 24s
 34350K .......... .......... .......... .......... .......... 34% 7.49M 24s
 34400K .......... .......... .......... .......... .......... 34% 6.15M 24s
 34450K .......... .......... .......... .......... .......... 34% 14.5M 24s
 34500K .......... .......... .......... .......... .......... 34% 9.32M 24s
 34550K .......... .......... .......... .......... .......... 34% 1.94M 24s
 34600K .......... .......... .......... .......... .......... 34% 4.79M 24s
 34650K .......... .......... .......... .......... .......... 34% 11.4M 24s
 34700K .......... .......... .......... .......... .......... 34% 5.16M 24s
 34750K .......... .......... .......... .......... .......... 34% 6.53M 24s
 34800K .......... .......... .......... .......... .......... 34% 9.85M 24s
 34850K .......... .......... .......... .......... .......... 34% 19.6M 23s
 34900K .......... .......... .......... .......... .......... 34% 3.14M 23s
 34950K .......... .......... .......... .......... .......... 34% 3.33M 23s
 35000K .......... .......... .......... .......... .......... 34% 7.30M 23s
 35050K .......... .......... .......... .......... .......... 34% 5.18M 23s
 35100K .......... .......... .......... .......... .......... 34% 6.66M 23s
 35150K .......... .......... .......... .......... .......... 35% 6.33M 23s
 35200K .......... .......... .......... .......... .......... 35% 12.5M 23s
 35250K .......... .......... .......... .......... .......... 35% 11.2M 23s
 35300K .......... .......... .......... .......... .......... 35% 6.22M 23s
 35350K .......... .......... .......... .......... .......... 35% 5.83M 23s
 35400K .......... .......... .......... .......... .......... 35% 4.21M 23s
 35450K .......... .......... .......... .......... .......... 35% 3.61M 23s
 35500K .......... .......... .......... .......... .......... 35% 18.2M 23s
 35550K .......... .......... .......... .......... .......... 35% 10.7M 23s
 35600K .......... .......... .......... .......... .......... 35% 16.6M 23s
 35650K .......... .......... .......... .......... .......... 35% 10.4M 23s
 35700K .......... .......... .......... .......... .......... 35% 8.90M 23s
 35750K .......... .......... .......... .......... .......... 35% 10.6M 23s
 35800K .......... .......... .......... .......... .......... 35% 3.68M 23s
 35850K .......... .......... .......... .......... .......... 35% 6.32M 23s
 35900K .......... .......... .......... .......... .......... 35% 4.18M 23s
 35950K .......... .......... .......... .......... .......... 35% 1.07M 23s
 36000K .......... .......... .......... .......... .......... 35% 5.75M 23s
 36050K .......... .......... .......... .......... .......... 35% 27.5M 23s
 36100K .......... .......... .......... .......... .......... 35% 57.2M 23s
 36150K .......... .......... .......... .......... .......... 36% 69.8M 23s
 36200K .......... .......... .......... .......... .......... 36% 26.9M 23s
 36250K .......... .......... .......... .......... .......... 36% 3.70M 23s
 36300K .......... .......... .......... .......... .......... 36% 3.87M 23s
 36350K .......... .......... .......... .......... .......... 36% 5.05M 22s
 36400K .......... .......... .......... .......... .......... 36% 6.97M 22s
 36450K .......... .......... .......... .......... .......... 36% 9.78M 22s
 36500K .......... .......... .......... .......... .......... 36% 2.45M 22s
 36550K .......... .......... .......... .......... .......... 36% 10.1M 22s
 36600K .......... .......... .......... .......... .......... 36% 1.19M 22s
 36650K .......... .......... .......... .......... .......... 36%  122M 22s
 36700K .......... .......... .......... .......... .......... 36% 96.5M 22s
 36750K .......... .......... .......... .......... .......... 36%  109M 22s
 36800K .......... .......... .......... .......... .......... 36% 18.9M 22s
 36850K .......... .......... .......... .......... .......... 36% 4.95M 22s
 36900K .......... .......... .......... .......... .......... 36% 4.52M 22s
 36950K .......... .......... .......... .......... .......... 36% 8.58M 22s
 37000K .......... .......... .......... .......... .......... 36% 9.62M 22s
 37050K .......... .......... .......... .......... .......... 36% 6.91M 22s
 37100K .......... .......... .......... .......... .......... 36% 13.8M 22s
 37150K .......... .......... .......... .......... .......... 37% 2.84M 22s
 37200K .......... .......... .......... .......... .......... 37% 3.68M 22s
 37250K .......... .......... .......... .......... .......... 37% 8.41M 22s
 37300K .......... .......... .......... .......... .......... 37% 5.31M 22s
 37350K .......... .......... .......... .......... .......... 37% 10.0M 22s
 37400K .......... .......... .......... .......... .......... 37% 1.51M 22s
 37450K .......... .......... .......... .......... .......... 37% 1.24M 22s
 37500K .......... .......... .......... .......... .......... 37% 1.13M 22s
 37550K .......... .......... .......... .......... .......... 37% 57.5M 22s
 37600K .......... .......... .......... .......... .......... 37% 55.2M 22s
 37650K .......... .......... .......... .......... .......... 37% 52.2M 22s
 37700K .......... .......... .......... .......... .......... 37% 25.5M 22s
 37750K .......... .......... .......... .......... .......... 37% 45.7M 22s
 37800K .......... .......... .......... .......... .......... 37% 32.4M 22s
 37850K .......... .......... .......... .......... .......... 37% 39.9M 22s
 37900K .......... .......... .......... .......... .......... 37% 51.8M 22s
 37950K .......... .......... .......... .......... .......... 37% 13.0M 21s
 38000K .......... .......... .......... .......... .......... 37% 2.78M 21s
 38050K .......... .......... .......... .......... .......... 37% 17.1M 21s
 38100K .......... .......... .......... .......... .......... 37% 2.35M 21s
 38150K .......... .......... .......... .......... .......... 38% 5.52M 21s
 38200K .......... .......... .......... .......... .......... 38% 4.05M 21s
 38250K .......... .......... .......... .......... .......... 38% 4.83M 21s
 38300K .......... .......... .......... .......... .......... 38% 9.95M 21s
 38350K .......... .......... .......... .......... .......... 38% 8.61M 21s
 38400K .......... .......... .......... .......... .......... 38% 1.42M 21s
 38450K .......... .......... .......... .......... .......... 38% 34.6M 21s
 38500K .......... .......... .......... .......... .......... 38% 46.6M 21s
 38550K .......... .......... .......... .......... .......... 38% 64.8M 21s
 38600K .......... .......... .......... .......... .......... 38% 69.7M 21s
 38650K .......... .......... .......... .......... .......... 38% 47.3M 21s
 38700K .......... .......... .......... .......... .......... 38% 11.9M 21s
 38750K .......... .......... .......... .......... .......... 38% 4.68M 21s
 38800K .......... .......... .......... .......... .......... 38% 10.2M 21s
 38850K .......... .......... .......... .......... .......... 38% 27.1M 21s
 38900K .......... .......... .......... .......... .......... 38% 2.36M 21s
 38950K .......... .......... .......... .......... .......... 38% 22.4M 21s
 39000K .......... .......... .......... .......... .......... 38% 5.32M 21s
 39050K .......... .......... .......... .......... .......... 38% 7.48M 21s
 39100K .......... .......... .......... .......... .......... 38% 8.11M 21s
 39150K .......... .......... .......... .......... .......... 39% 3.65M 21s
 39200K .......... .......... .......... .......... .......... 39% 8.09M 21s
 39250K .......... .......... .......... .......... .......... 39% 4.68M 21s
 39300K .......... .......... .......... .......... .......... 39% 16.0M 21s
 39350K .......... .......... .......... .......... .......... 39% 9.94M 21s
 39400K .......... .......... .......... .......... .......... 39% 5.78M 21s
 39450K .......... .......... .......... .......... .......... 39% 9.39M 21s
 39500K .......... .......... .......... .......... .......... 39% 11.6M 21s
 39550K .......... .......... .......... .......... .......... 39% 10.4M 20s
 39600K .......... .......... .......... .......... .......... 39% 5.68M 20s
 39650K .......... .......... .......... .......... .......... 39% 24.0M 20s
 39700K .......... .......... .......... .......... .......... 39% 9.18M 20s
 39750K .......... .......... .......... .......... .......... 39% 5.81M 20s
 39800K .......... .......... .......... .......... .......... 39% 41.9M 20s
 39850K .......... .......... .......... .......... .......... 39% 17.2M 20s
 39900K .......... .......... .......... .......... .......... 39% 6.05M 20s
 39950K .......... .......... .......... .......... .......... 39% 16.8M 20s
 40000K .......... .......... .......... .......... .......... 39% 3.84M 20s
 40050K .......... .......... .......... .......... .......... 39% 13.1M 20s
 40100K .......... .......... .......... .......... .......... 39% 12.8M 20s
 40150K .......... .......... .......... .......... .......... 40% 3.71M 20s
 40200K .......... .......... .......... .......... .......... 40% 32.4M 20s
 40250K .......... .......... .......... .......... .......... 40% 11.4M 20s
 40300K .......... .......... .......... .......... .......... 40% 5.55M 20s
 40350K .......... .......... .......... .......... .......... 40% 15.5M 20s
 40400K .......... .......... .......... .......... .......... 40% 9.88M 20s
 40450K .......... .......... .......... .......... .......... 40% 10.8M 20s
 40500K .......... .......... .......... .......... .......... 40% 13.5M 20s
 40550K .......... .......... .......... .......... .......... 40% 11.2M 20s
 40600K .......... .......... .......... .......... .......... 40% 6.68M 20s
 40650K .......... .......... .......... .......... .......... 40% 20.6M 20s
 40700K .......... .......... .......... .......... .......... 40% 14.2M 20s
 40750K .......... .......... .......... .......... .......... 40% 7.56M 20s
 40800K .......... .......... .......... .......... .......... 40% 8.76M 20s
 40850K .......... .......... .......... .......... .......... 40% 12.1M 20s
 40900K .......... .......... .......... .......... .......... 40% 12.8M 20s
 40950K .......... .......... .......... .......... .......... 40% 12.1M 20s
 41000K .......... .......... .......... .......... .......... 40% 3.79M 20s
 41050K .......... .......... .......... .......... .......... 40% 13.1M 19s
 41100K .......... .......... .......... .......... .......... 40% 7.25M 19s
 41150K .......... .......... .......... .......... .......... 41% 7.03M 19s
 41200K .......... .......... .......... .......... .......... 41% 12.1M 19s
 41250K .......... .......... .......... .......... .......... 41% 20.3M 19s
 41300K .......... .......... .......... .......... .......... 41% 11.4M 19s
 41350K .......... .......... .......... .......... .......... 41% 15.5M 19s
 41400K .......... .......... .......... .......... .......... 41% 15.8M 19s
 41450K .......... .......... .......... .......... .......... 41% 11.5M 19s
 41500K .......... .......... .......... .......... .......... 41% 7.35M 19s
 41550K .......... .......... .......... .......... .......... 41% 5.06M 19s
 41600K .......... .......... .......... .......... .......... 41% 21.2M 19s
 41650K .......... .......... .......... .......... .......... 41% 16.6M 19s
 41700K .......... .......... .......... .......... .......... 41% 12.3M 19s
 41750K .......... .......... .......... .......... .......... 41% 12.1M 19s
 41800K .......... .......... .......... .......... .......... 41% 5.86M 19s
 41850K .......... .......... .......... .......... .......... 41% 38.0M 19s
 41900K .......... .......... .......... .......... .......... 41%  966K 19s
 41950K .......... .......... .......... .......... .......... 41% 16.3M 19s
 42000K .......... .......... .......... .......... .......... 41% 47.3M 19s
 42050K .......... .......... .......... .......... .......... 41% 33.9M 19s
 42100K .......... .......... .......... .......... .......... 41% 25.1M 19s
 42150K .......... .......... .......... .......... .......... 42% 46.8M 19s
 42200K .......... .......... .......... .......... .......... 42% 62.8M 19s
 42250K .......... .......... .......... .......... .......... 42% 51.8M 19s
 42300K .......... .......... .......... .......... .......... 42% 54.0M 19s
 42350K .......... .......... .......... .......... .......... 42% 32.7M 19s
 42400K .......... .......... .......... .......... .......... 42% 44.9M 19s
 42450K .......... .......... .......... .......... .......... 42%  105M 19s
 42500K .......... .......... .......... .......... .......... 42% 85.5M 19s
 42550K .......... .......... .......... .......... .......... 42% 40.5M 19s
 42600K .......... .......... .......... .......... .......... 42% 8.81M 18s
 42650K .......... .......... .......... .......... .......... 42% 5.45M 18s
 42700K .......... .......... .......... .......... .......... 42% 29.1M 18s
 42750K .......... .......... .......... .......... .......... 42% 1.50M 18s
 42800K .......... .......... .......... .......... .......... 42% 12.0M 18s
 42850K .......... .......... .......... .......... .......... 42% 13.1M 18s
 42900K .......... .......... .......... .......... .......... 42% 7.58M 18s
 42950K .......... .......... .......... .......... .......... 42% 23.4M 18s
 43000K .......... .......... .......... .......... .......... 42% 11.2M 18s
 43050K .......... .......... .......... .......... .......... 42% 11.1M 18s
 43100K .......... .......... .......... .......... .......... 42% 15.3M 18s
 43150K .......... .......... .......... .......... .......... 42% 7.42M 18s
 43200K .......... .......... .......... .......... .......... 43% 10.4M 18s
 43250K .......... .......... .......... .......... .......... 43% 9.94M 18s
 43300K .......... .......... .......... .......... .......... 43% 17.5M 18s
 43350K .......... .......... .......... .......... .......... 43% 9.98M 18s
 43400K .......... .......... .......... .......... .......... 43% 17.8M 18s
 43450K .......... .......... .......... .......... .......... 43% 7.50M 18s
 43500K .......... .......... .......... .......... .......... 43% 25.3M 18s
 43550K .......... .......... .......... .......... .......... 43% 8.55M 18s
 43600K .......... .......... .......... .......... .......... 43% 12.1M 18s
 43650K .......... .......... .......... .......... .......... 43% 12.5M 18s
 43700K .......... .......... .......... .......... .......... 43% 12.5M 18s
 43750K .......... .......... .......... .......... .......... 43% 12.7M 18s
 43800K .......... .......... .......... .......... .......... 43% 9.60M 18s
 43850K .......... .......... .......... .......... .......... 43% 12.9M 18s
 43900K .......... .......... .......... .......... .......... 43% 12.8M 18s
 43950K .......... .......... .......... .......... .......... 43% 4.84M 18s
 44000K .......... .......... .......... .......... .......... 43% 20.3M 18s
 44050K .......... .......... .......... .......... .......... 43% 10.9M 18s
 44100K .......... .......... .......... .......... .......... 43% 1.40M 18s
 44150K .......... .......... .......... .......... .......... 43% 56.9M 18s
 44200K .......... .......... .......... .......... .......... 44%  857K 18s
 44250K .......... .......... .......... .......... .......... 44% 41.3M 18s
 44300K .......... .......... .......... .......... .......... 44% 18.3M 18s
 44350K .......... .......... .......... .......... .......... 44% 20.9M 18s
 44400K .......... .......... .......... .......... .......... 44% 32.1M 17s
 44450K .......... .......... .......... .......... .......... 44% 40.2M 17s
 44500K .......... .......... .......... .......... .......... 44% 44.4M 17s
 44550K .......... .......... .......... .......... .......... 44% 75.0M 17s
 44600K .......... .......... .......... .......... .......... 44% 64.7M 17s
 44650K .......... .......... .......... .......... .......... 44% 66.3M 17s
 44700K .......... .......... .......... .......... .......... 44% 65.7M 17s
 44750K .......... .......... .......... .......... .......... 44% 48.8M 17s
 44800K .......... .......... .......... .......... .......... 44% 74.3M 17s
 44850K .......... .......... .......... .......... .......... 44% 72.8M 17s
 44900K .......... .......... .......... .......... .......... 44%  391K 17s
 44950K .......... .......... .......... .......... .......... 44% 61.7M 17s
 45000K .......... .......... .......... .......... .......... 44% 60.7M 17s
 45050K .......... .......... .......... .......... .......... 44%  128M 17s
 45100K .......... .......... .......... .......... .......... 44%  121M 17s
 45150K .......... .......... .......... .......... .......... 44%  135M 17s
 45200K .......... .......... .......... .......... .......... 45%  148M 17s
 45250K .......... .......... .......... .......... .......... 45%  111M 17s
 45300K .......... .......... .......... .......... .......... 45%  102M 17s
 45350K .......... .......... .......... .......... .......... 45%  114M 17s
 45400K .......... .......... .......... .......... .......... 45%  122M 17s
 45450K .......... .......... .......... .......... .......... 45%  185M 17s
 45500K .......... .......... .......... .......... .......... 45%  187M 17s
 45550K .......... .......... .......... .......... .......... 45%  156M 17s
 45600K .......... .......... .......... .......... .......... 45%  189M 17s
 45650K .......... .......... .......... .......... .......... 45%  181M 17s
 45700K .......... .......... .......... .......... .......... 45%  145M 17s
 45750K .......... .......... .......... .......... .......... 45%  172M 17s
 45800K .......... .......... .......... .......... .......... 45%  197M 17s
 45850K .......... .......... .......... .......... .......... 45%  197M 17s
 45900K .......... .......... .......... .......... .......... 45% 2.24M 17s
 45950K .......... .......... .......... .......... .......... 45% 2.06M 17s
 46000K .......... .......... .......... .......... .......... 45% 8.19M 17s
 46050K .......... .......... .......... .......... .......... 45% 4.19M 17s
 46100K .......... .......... .......... .......... .......... 45% 21.3M 17s
 46150K .......... .......... .......... .......... .......... 45% 9.63M 17s
 46200K .......... .......... .......... .......... .......... 46% 4.28M 17s
 46250K .......... .......... .......... .......... .......... 46% 6.29M 17s
 46300K .......... .......... .......... .......... .......... 46% 7.40M 16s
 46350K .......... .......... .......... .......... .......... 46% 13.1M 16s
 46400K .......... .......... .......... .......... .......... 46% 6.79M 16s
 46450K .......... .......... .......... .......... .......... 46% 8.14M 16s
 46500K .......... .......... .......... .......... .......... 46% 8.60M 16s
 46550K .......... .......... .......... .......... .......... 46% 7.58M 16s
 46600K .......... .......... .......... .......... .......... 46% 7.86M 16s
 46650K .......... .......... .......... .......... .......... 46% 7.79M 16s
 46700K .......... .......... .......... .......... .......... 46% 3.59M 16s
 46750K .......... .......... .......... .......... .......... 46% 17.7M 16s
 46800K .......... .......... .......... .......... .......... 46% 5.56M 16s
 46850K .......... .......... .......... .......... .......... 46% 13.0M 16s
 46900K .......... .......... .......... .......... .......... 46% 16.4M 16s
 46950K .......... .......... .......... .......... .......... 46% 12.7M 16s
 47000K .......... .......... .......... .......... .......... 46% 11.9M 16s
 47050K .......... .......... .......... .......... .......... 46% 6.38M 16s
 47100K .......... .......... .......... .......... .......... 46% 10.9M 16s
 47150K .......... .......... .......... .......... .......... 46% 4.20M 16s
 47200K .......... .......... .......... .......... .......... 47% 7.33M 16s
 47250K .......... .......... .......... .......... .......... 47% 13.9M 16s
 47300K .......... .......... .......... .......... .......... 47% 13.8M 16s
 47350K .......... .......... .......... .......... .......... 47% 4.91M 16s
 47400K .......... .......... .......... .......... .......... 47% 10.8M 16s
 47450K .......... .......... .......... .......... .......... 47% 6.45M 16s
 47500K .......... .......... .......... .......... .......... 47% 13.0M 16s
 47550K .......... .......... .......... .......... .......... 47% 1.11M 16s
 47600K .......... .......... .......... .......... .......... 47% 29.9M 16s
 47650K .......... .......... .......... .......... .......... 47% 29.0M 16s
 47700K .......... .......... .......... .......... .......... 47% 15.6M 16s
 47750K .......... .......... .......... .......... .......... 47% 42.6M 16s
 47800K .......... .......... .......... .......... .......... 47% 21.1M 16s
 47850K .......... .......... .......... .......... .......... 47% 25.4M 16s
 47900K .......... .......... .......... .......... .......... 47% 11.1M 16s
 47950K .......... .......... .......... .......... .......... 47% 11.3M 16s
 48000K .......... .......... .......... .......... .......... 47% 14.0M 16s
 48050K .......... .......... .......... .......... .......... 47% 7.61M 16s
 48100K .......... .......... .......... .......... .......... 47% 26.4M 16s
 48150K .......... .......... .......... .......... .......... 47% 12.1M 16s
 48200K .......... .......... .......... .......... .......... 48% 2.58M 16s
 48250K .......... .......... .......... .......... .......... 48% 5.01M 16s
 48300K .......... .......... .......... .......... .......... 48% 10.7M 16s
 48350K .......... .......... .......... .......... .......... 48% 4.70M 15s
 48400K .......... .......... .......... .......... .......... 48% 22.8M 15s
 48450K .......... .......... .......... .......... .......... 48% 10.4M 15s
 48500K .......... .......... .......... .......... .......... 48% 10.5M 15s
 48550K .......... .......... .......... .......... .......... 48% 5.34M 15s
 48600K .......... .......... .......... .......... .......... 48% 19.9M 15s
 48650K .......... .......... .......... .......... .......... 48% 6.81M 15s
 48700K .......... .......... .......... .......... .......... 48% 43.4M 15s
 48750K .......... .......... .......... .......... .......... 48% 6.18M 15s
 48800K .......... .......... .......... .......... .......... 48% 20.7M 15s
 48850K .......... .......... .......... .......... .......... 48% 12.8M 15s
 48900K .......... .......... .......... .......... .......... 48% 12.6M 15s
 48950K .......... .......... .......... .......... .......... 48% 13.2M 15s
 49000K .......... .......... .......... .......... .......... 48% 11.4M 15s
 49050K .......... .......... .......... .......... .......... 48% 12.0M 15s
 49100K .......... .......... .......... .......... .......... 48% 10.6M 15s
 49150K .......... .......... .......... .......... .......... 48% 8.03M 15s
 49200K .......... .......... .......... .......... .......... 49% 9.01M 15s
 49250K .......... .......... .......... .......... .......... 49% 9.38M 15s
 49300K .......... .......... .......... .......... .......... 49% 11.5M 15s
 49350K .......... .......... .......... .......... .......... 49% 13.0M 15s
 49400K .......... .......... .......... .......... .......... 49% 4.55M 15s
 49450K .......... .......... .......... .......... .......... 49% 12.7M 15s
 49500K .......... .......... .......... .......... .......... 49% 15.1M 15s
 49550K .......... .......... .......... .......... .......... 49% 10.6M 15s
 49600K .......... .......... .......... .......... .......... 49% 13.0M 15s
 49650K .......... .......... .......... .......... .......... 49% 8.62M 15s
 49700K .......... .......... .......... .......... .......... 49% 15.7M 15s
 49750K .......... .......... .......... .......... .......... 49% 9.80M 15s
 49800K .......... .......... .......... .......... .......... 49% 16.9M 15s
 49850K .......... .......... .......... .......... .......... 49% 11.6M 15s
 49900K .......... .......... .......... .......... .......... 49% 9.67M 15s
 49950K .......... .......... .......... .......... .......... 49% 11.6M 15s
 50000K .......... .......... .......... .......... .......... 49% 12.6M 15s
 50050K .......... .......... .......... .......... .......... 49% 13.7M 15s
 50100K .......... .......... .......... .......... .......... 49% 7.41M 15s
 50150K .......... .......... .......... .......... .......... 49% 10.1M 15s
 50200K .......... .......... .......... .......... .......... 50% 4.32M 15s
 50250K .......... .......... .......... .......... .......... 50% 39.2M 15s
 50300K .......... .......... .......... .......... .......... 50% 23.8M 15s
 50350K .......... .......... .......... .......... .......... 50% 4.59M 14s
 50400K .......... .......... .......... .......... .......... 50% 3.12M 14s
 50450K .......... .......... .......... .......... .......... 50% 6.10M 14s
 50500K .......... .......... .......... .......... .......... 50% 2.74M 14s
 50550K .......... .......... .......... .......... .......... 50% 15.9M 14s
 50600K .......... .......... .......... .......... .......... 50% 9.40M 14s
 50650K .......... .......... .......... .......... .......... 50% 1.58M 14s
 50700K .......... .......... .......... .......... .......... 50% 67.3M 14s
 50750K .......... .......... .......... .......... .......... 50% 35.0M 14s
 50800K .......... .......... .......... .......... .......... 50% 65.8M 14s
 50850K .......... .......... .......... .......... .......... 50% 58.5M 14s
 50900K .......... .......... .......... .......... .......... 50% 50.9M 14s
 50950K .......... .......... .......... .......... .......... 50% 14.5M 14s
 51000K .......... .......... .......... .......... .......... 50% 7.51M 14s
 51050K .......... .......... .......... .......... .......... 50% 11.3M 14s
 51100K .......... .......... .......... .......... .......... 50% 10.7M 14s
 51150K .......... .......... .......... .......... .......... 50% 3.57M 14s
 51200K .......... .......... .......... .......... .......... 51% 13.5M 14s
 51250K .......... .......... .......... .......... .......... 51% 11.3M 14s
 51300K .......... .......... .......... .......... .......... 51% 9.83M 14s
 51350K .......... .......... .......... .......... .......... 51% 6.29M 14s
 51400K .......... .......... .......... .......... .......... 51% 8.46M 14s
 51450K .......... .......... .......... .......... .......... 51% 12.8M 14s
 51500K .......... .......... .......... .......... .......... 51% 10.9M 14s
 51550K .......... .......... .......... .......... .......... 51% 8.97M 14s
 51600K .......... .......... .......... .......... .......... 51% 12.5M 14s
 51650K .......... .......... .......... .......... .......... 51% 8.61M 14s
 51700K .......... .......... .......... .......... .......... 51% 19.2M 14s
 51750K .......... .......... .......... .......... .......... 51% 9.53M 14s
 51800K .......... .......... .......... .......... .......... 51% 11.0M 14s
 51850K .......... .......... .......... .......... .......... 51% 12.1M 14s
 51900K .......... .......... .......... .......... .......... 51% 14.8M 14s
 51950K .......... .......... .......... .......... .......... 51% 9.20M 14s
 52000K .......... .......... .......... .......... .......... 51% 7.83M 14s
 52050K .......... .......... .......... .......... .......... 51% 4.45M 14s
 52100K .......... .......... .......... .......... .......... 51% 43.7M 14s
 52150K .......... .......... .......... .......... .......... 51%  741K 14s
 52200K .......... .......... .......... .......... .......... 52% 16.2M 14s
 52250K .......... .......... .......... .......... .......... 52% 12.4M 14s
 52300K .......... .......... .......... .......... .......... 52% 13.8M 14s
 52350K .......... .......... .......... .......... .......... 52% 33.0M 14s
 52400K .......... .......... .......... .......... .......... 52% 35.0M 14s
 52450K .......... .......... .......... .......... .......... 52% 45.9M 14s
 52500K .......... .......... .......... .......... .......... 52% 38.5M 14s
 52550K .......... .......... .......... .......... .......... 52% 39.1M 14s
 52600K .......... .......... .......... .......... .......... 52% 38.7M 14s
 52650K .......... .......... .......... .......... .......... 52% 15.3M 13s
 52700K .......... .......... .......... .......... .......... 52% 11.7M 13s
 52750K .......... .......... .......... .......... .......... 52% 24.0M 13s
 52800K .......... .......... .......... .......... .......... 52% 58.1M 13s
 52850K .......... .......... .......... .......... .......... 52% 1.48M 13s
 52900K .......... .......... .......... .......... .......... 52% 9.15M 13s
 52950K .......... .......... .......... .......... .......... 52% 12.7M 13s
 53000K .......... .......... .......... .......... .......... 52% 10.5M 13s
 53050K .......... .......... .......... .......... .......... 52% 2.66M 13s
 53100K .......... .......... .......... .......... .......... 52% 45.9M 13s
 53150K .......... .......... .......... .......... .......... 52% 25.7M 13s
 53200K .......... .......... .......... .......... .......... 53% 37.6M 13s
 53250K .......... .......... .......... .......... .......... 53% 22.5M 13s
 53300K .......... .......... .......... .......... .......... 53% 25.7M 13s
 53350K .......... .......... .......... .......... .......... 53% 12.0M 13s
 53400K .......... .......... .......... .......... .......... 53% 5.94M 13s
 53450K .......... .......... .......... .......... .......... 53% 8.45M 13s
 53500K .......... .......... .......... .......... .......... 53% 22.3M 13s
 53550K .......... .......... .......... .......... .......... 53% 4.79M 13s
 53600K .......... .......... .......... .......... .......... 53% 12.1M 13s
 53650K .......... .......... .......... .......... .......... 53% 4.00M 13s
 53700K .......... .......... .......... .......... .......... 53% 9.30M 13s
 53750K .......... .......... .......... .......... .......... 53% 20.2M 13s
 53800K .......... .......... .......... .......... .......... 53% 12.0M 13s
 53850K .......... .......... .......... .......... .......... 53% 13.8M 13s
 53900K .......... .......... .......... .......... .......... 53% 6.67M 13s
 53950K .......... .......... .......... .......... .......... 53% 25.9M 13s
 54000K .......... .......... .......... .......... .......... 53% 11.8M 13s
 54050K .......... .......... .......... .......... .......... 53% 14.5M 13s
 54100K .......... .......... .......... .......... .......... 53% 7.01M 13s
 54150K .......... .......... .......... .......... .......... 53% 10.1M 13s
 54200K .......... .......... .......... .......... .......... 53% 9.28M 13s
 54250K .......... .......... .......... .......... .......... 54% 11.1M 13s
 54300K .......... .......... .......... .......... .......... 54% 23.5M 13s
 54350K .......... .......... .......... .......... .......... 54% 12.7M 13s
 54400K .......... .......... .......... .......... .......... 54% 10.9M 13s
 54450K .......... .......... .......... .......... .......... 54% 13.1M 13s
 54500K .......... .......... .......... .......... .......... 54% 12.4M 13s
 54550K .......... .......... .......... .......... .......... 54% 12.8M 13s
 54600K .......... .......... .......... .......... .......... 54% 5.96M 13s
 54650K .......... .......... .......... .......... .......... 54% 30.0M 13s
 54700K .......... .......... .......... .......... .......... 54% 11.6M 13s
 54750K .......... .......... .......... .......... .......... 54% 1.03M 13s
 54800K .......... .......... .......... .......... .......... 54% 3.91M 13s
 54850K .......... .......... .......... .......... .......... 54% 43.3M 13s
 54900K .......... .......... .......... .......... .......... 54% 29.8M 13s
 54950K .......... .......... .......... .......... .......... 54% 31.5M 13s
 55000K .......... .......... .......... .......... .......... 54% 27.0M 13s
 55050K .......... .......... .......... .......... .......... 54% 25.9M 12s
 55100K .......... .......... .......... .......... .......... 54% 1.22M 12s
 55150K .......... .......... .......... .......... .......... 54% 27.2M 12s
 55200K .......... .......... .......... .......... .......... 54% 51.2M 12s
 55250K .......... .......... .......... .......... .......... 55% 36.2M 12s
 55300K .......... .......... .......... .......... .......... 55% 24.5M 12s
 55350K .......... .......... .......... .......... .......... 55% 37.1M 12s
 55400K .......... .......... .......... .......... .......... 55% 48.3M 12s
 55450K .......... .......... .......... .......... .......... 55% 37.9M 12s
 55500K .......... .......... .......... .......... .......... 55% 49.8M 12s
 55550K .......... .......... .......... .......... .......... 55% 31.3M 12s
 55600K .......... .......... .......... .......... .......... 55% 12.3M 12s
 55650K .......... .......... .......... .......... .......... 55% 10.4M 12s
 55700K .......... .......... .......... .......... .......... 55% 10.5M 12s
 55750K .......... .......... .......... .......... .......... 55% 11.1M 12s
 55800K .......... .......... .......... .......... .......... 55% 6.48M 12s
 55850K .......... .......... .......... .......... .......... 55% 2.22M 12s
 55900K .......... .......... .......... .......... .......... 55% 3.87M 12s
 55950K .......... .......... .......... .......... .......... 55% 13.2M 12s
 56000K .......... .......... .......... .......... .......... 55% 13.1M 12s
 56050K .......... .......... .......... .......... .......... 55% 24.9M 12s
 56100K .......... .......... .......... .......... .......... 55% 7.65M 12s
 56150K .......... .......... .......... .......... .......... 55% 9.24M 12s
 56200K .......... .......... .......... .......... .......... 55% 4.57M 12s
 56250K .......... .......... .......... .......... .......... 56% 11.8M 12s
 56300K .......... .......... .......... .......... .......... 56% 10.2M 12s
 56350K .......... .......... .......... .......... .......... 56% 20.3M 12s
 56400K .......... .......... .......... .......... .......... 56% 20.8M 12s
 56450K .......... .......... .......... .......... .......... 56% 13.2M 12s
 56500K .......... .......... .......... .......... .......... 56% 10.2M 12s
 56550K .......... .......... .......... .......... .......... 56% 9.97M 12s
 56600K .......... .......... .......... .......... .......... 56% 15.9M 12s
 56650K .......... .......... .......... .......... .......... 56% 12.3M 12s
 56700K .......... .......... .......... .......... .......... 56% 9.24M 12s
 56750K .......... .......... .......... .......... .......... 56% 8.48M 12s
 56800K .......... .......... .......... .......... .......... 56% 9.70M 12s
 56850K .......... .......... .......... .......... .......... 56% 12.8M 12s
 56900K .......... .......... .......... .......... .......... 56% 11.3M 12s
 56950K .......... .......... .......... .......... .......... 56% 10.7M 12s
 57000K .......... .......... .......... .......... .......... 56% 4.76M 12s
 57050K .......... .......... .......... .......... .......... 56% 13.3M 12s
 57100K .......... .......... .......... .......... .......... 56% 12.6M 12s
 57150K .......... .......... .......... .......... .......... 56% 9.22M 12s
 57200K .......... .......... .......... .......... .......... 56% 6.27M 12s
 57250K .......... .......... .......... .......... .......... 57% 11.4M 12s
 57300K .......... .......... .......... .......... .......... 57% 2.03M 12s
 57350K .......... .......... .......... .......... .......... 57% 10.4M 12s
 57400K .......... .......... .......... .......... .......... 57% 12.9M 12s
 57450K .......... .......... .......... .......... .......... 57% 6.73M 12s
 57500K .......... .......... .......... .......... .......... 57% 14.5M 12s
 57550K .......... .......... .......... .......... .......... 57% 8.65M 12s
 57600K .......... .......... .......... .......... .......... 57% 13.7M 11s
 57650K .......... .......... .......... .......... .......... 57% 10.5M 11s
 57700K .......... .......... .......... .......... .......... 57% 12.7M 11s
 57750K .......... .......... .......... .......... .......... 57% 12.8M 11s
 57800K .......... .......... .......... .......... .......... 57% 6.84M 11s
 57850K .......... .......... .......... .......... .......... 57% 5.82M 11s
 57900K .......... .......... .......... .......... .......... 57% 13.0M 11s
 57950K .......... .......... .......... .......... .......... 57% 6.58M 11s
 58000K .......... .......... .......... .......... .......... 57% 20.1M 11s
 58050K .......... .......... .......... .......... .......... 57% 10.8M 11s
 58100K .......... .......... .......... .......... .......... 57% 5.00M 11s
 58150K .......... .......... .......... .......... .......... 57% 15.6M 11s
 58200K .......... .......... .......... .......... .......... 57% 14.1M 11s
 58250K .......... .......... .......... .......... .......... 58% 10.4M 11s
 58300K .......... .......... .......... .......... .......... 58% 13.1M 11s
 58350K .......... .......... .......... .......... .......... 58% 10.5M 11s
 58400K .......... .......... .......... .......... .......... 58% 1.04M 11s
 58450K .......... .......... .......... .......... .......... 58% 10.5M 11s
 58500K .......... .......... .......... .......... .......... 58% 11.8M 11s
 58550K .......... .......... .......... .......... .......... 58% 19.8M 11s
 58600K .......... .......... .......... .......... .......... 58% 58.1M 11s
 58650K .......... .......... .......... .......... .......... 58% 17.8M 11s
 58700K .......... .......... .......... .......... .......... 58% 49.9M 11s
 58750K .......... .......... .......... .......... .......... 58% 22.0M 11s
 58800K .......... .......... .......... .......... .......... 58% 45.9M 11s
 58850K .......... .......... .......... .......... .......... 58% 29.1M 11s
 58900K .......... .......... .......... .......... .......... 58% 19.0M 11s
 58950K .......... .......... .......... .......... .......... 58% 63.5M 11s
 59000K .......... .......... .......... .......... .......... 58% 56.7M 11s
 59050K .......... .......... .......... .......... .......... 58% 13.9M 11s
 59100K .......... .......... .......... .......... .......... 58% 21.3M 11s
 59150K .......... .......... .......... .......... .......... 58% 2.20M 11s
 59200K .......... .......... .......... .......... .......... 58% 5.34M 11s
 59250K .......... .......... .......... .......... .......... 59% 9.91M 11s
 59300K .......... .......... .......... .......... .......... 59% 10.0M 11s
 59350K .......... .......... .......... .......... .......... 59% 8.10M 11s
 59400K .......... .......... .......... .......... .......... 59% 15.1M 11s
 59450K .......... .......... .......... .......... .......... 59% 12.5M 11s
 59500K .......... .......... .......... .......... .......... 59% 11.9M 11s
 59550K .......... .......... .......... .......... .......... 59% 8.19M 11s
 59600K .......... .......... .......... .......... .......... 59% 3.61M 11s
 59650K .......... .......... .......... .......... .......... 59% 31.6M 11s
 59700K .......... .......... .......... .......... .......... 59% 55.1M 11s
 59750K .......... .......... .......... .......... .......... 59% 44.9M 11s
 59800K .......... .......... .......... .......... .......... 59% 6.86M 11s
 59850K .......... .......... .......... .......... .......... 59% 10.0M 11s
 59900K .......... .......... .......... .......... .......... 59% 16.1M 11s
 59950K .......... .......... .......... .......... .......... 59% 3.09M 11s
 60000K .......... .......... .......... .......... .......... 59% 56.7M 11s
 60050K .......... .......... .......... .......... .......... 59% 10.6M 11s
 60100K .......... .......... .......... .......... .......... 59% 13.3M 11s
 60150K .......... .......... .......... .......... .......... 59% 11.9M 11s
 60200K .......... .......... .......... .......... .......... 59% 13.2M 11s
 60250K .......... .......... .......... .......... .......... 60% 10.3M 10s
 60300K .......... .......... .......... .......... .......... 60% 14.4M 10s
 60350K .......... .......... .......... .......... .......... 60%  602K 11s
 60400K .......... .......... .......... .......... .......... 60% 34.6M 10s
 60450K .......... .......... .......... .......... .......... 60% 49.8M 10s
 60500K .......... .......... .......... .......... .......... 60% 47.5M 10s
 60550K .......... .......... .......... .......... .......... 60% 27.6M 10s
 60600K .......... .......... .......... .......... .......... 60% 58.6M 10s
 60650K .......... .......... .......... .......... .......... 60% 54.5M 10s
 60700K .......... .......... .......... .......... .......... 60% 73.1M 10s
 60750K .......... .......... .......... .......... .......... 60% 62.0M 10s
 60800K .......... .......... .......... .......... .......... 60% 93.4M 10s
 60850K .......... .......... .......... .......... .......... 60% 47.7M 10s
 60900K .......... .......... .......... .......... .......... 60% 60.2M 10s
 60950K .......... .......... .......... .......... .......... 60% 45.2M 10s
 61000K .......... .......... .......... .......... .......... 60% 52.8M 10s
 61050K .......... .......... .......... .......... .......... 60%  401K 10s
 61100K .......... .......... .......... .......... .......... 60% 2.06M 10s
 61150K .......... .......... .......... .......... .......... 60% 12.9M 10s
 61200K .......... .......... .......... .......... .......... 60%  185M 10s
 61250K .......... .......... .......... .......... .......... 61%  120M 10s
 61300K .......... .......... .......... .......... .......... 61%  186M 10s
 61350K .......... .......... .......... .......... .......... 61%  161M 10s
 61400K .......... .......... .......... .......... .......... 61%  142M 10s
 61450K .......... .......... .......... .......... .......... 61%  152M 10s
 61500K .......... .......... .......... .......... .......... 61%  169M 10s
 61550K .......... .......... .......... .......... .......... 61%  108M 10s
 61600K .......... .......... .......... .......... .......... 61%  161M 10s
 61650K .......... .......... .......... .......... .......... 61%  139M 10s
 61700K .......... .......... .......... .......... .......... 61%  109M 10s
 61750K .......... .......... .......... .......... .......... 61%  109M 10s
 61800K .......... .......... .......... .......... .......... 61%  125M 10s
 61850K .......... .......... .......... .......... .......... 61%  176M 10s
 61900K .......... .......... .......... .......... .......... 61% 98.6M 10s
 61950K .......... .......... .......... .......... .......... 61% 5.99M 10s
 62000K .......... .......... .......... .......... .......... 61% 32.9M 10s
 62050K .......... .......... .......... .......... .......... 61% 13.1M 10s
 62100K .......... .......... .......... .......... .......... 61% 10.2M 10s
 62150K .......... .......... .......... .......... .......... 61% 6.43M 10s
 62200K .......... .......... .......... .......... .......... 61% 11.8M 10s
 62250K .......... .......... .......... .......... .......... 62% 13.5M 10s
 62300K .......... .......... .......... .......... .......... 62% 13.2M 10s
 62350K .......... .......... .......... .......... .......... 62% 3.08M 10s
 62400K .......... .......... .......... .......... .......... 62% 13.0M 10s
 62450K .......... .......... .......... .......... .......... 62% 6.84M 10s
 62500K .......... .......... .......... .......... .......... 62% 14.1M 10s
 62550K .......... .......... .......... .......... .......... 62% 8.00M 10s
 62600K .......... .......... .......... .......... .......... 62% 16.0M 10s
 62650K .......... .......... .......... .......... .......... 62% 12.9M 10s
 62700K .......... .......... .......... .......... .......... 62% 9.52M 10s
 62750K .......... .......... .......... .......... .......... 62% 6.77M 10s
 62800K .......... .......... .......... .......... .......... 62% 10.8M 10s
 62850K .......... .......... .......... .......... .......... 62% 17.8M 10s
 62900K .......... .......... .......... .......... .......... 62% 5.88M 10s
 62950K .......... .......... .......... .......... .......... 62% 8.69M 10s
 63000K .......... .......... .......... .......... .......... 62% 8.99M 10s
 63050K .......... .......... .......... .......... .......... 62% 1.26M 10s
 63100K .......... .......... .......... .......... .......... 62% 32.1M 10s
 63150K .......... .......... .......... .......... .......... 62% 35.2M 10s
 63200K .......... .......... .......... .......... .......... 62% 48.8M 10s
 63250K .......... .......... .......... .......... .......... 63% 39.3M 9s
 63300K .......... .......... .......... .......... .......... 63% 55.9M 9s
 63350K .......... .......... .......... .......... .......... 63% 45.3M 9s
 63400K .......... .......... .......... .......... .......... 63% 16.1M 9s
 63450K .......... .......... .......... .......... .......... 63% 12.1M 9s
 63500K .......... .......... .......... .......... .......... 63% 6.16M 9s
 63550K .......... .......... .......... .......... .......... 63% 7.93M 9s
 63600K .......... .......... .......... .......... .......... 63% 1.72M 9s
 63650K .......... .......... .......... .......... .......... 63% 10.3M 9s
 63700K .......... .......... .......... .......... .......... 63% 5.74M 9s
 63750K .......... .......... .......... .......... .......... 63% 12.3M 9s
 63800K .......... .......... .......... .......... .......... 63% 12.5M 9s
 63850K .......... .......... .......... .......... .......... 63% 10.6M 9s
 63900K .......... .......... .......... .......... .......... 63% 13.2M 9s
 63950K .......... .......... .......... .......... .......... 63% 9.91M 9s
 64000K .......... .......... .......... .......... .......... 63% 7.77M 9s
 64050K .......... .......... .......... .......... .......... 63% 14.2M 9s
 64100K .......... .......... .......... .......... .......... 63% 15.6M 9s
 64150K .......... .......... .......... .......... .......... 63% 8.10M 9s
 64200K .......... .......... .......... .......... .......... 63% 5.39M 9s
 64250K .......... .......... .......... .......... .......... 63% 12.1M 9s
 64300K .......... .......... .......... .......... .......... 64% 3.60M 9s
 64350K .......... .......... .......... .......... .......... 64% 33.9M 9s
 64400K .......... .......... .......... .......... .......... 64% 7.60M 9s
 64450K .......... .......... .......... .......... .......... 64% 3.53M 9s
 64500K .......... .......... .......... .......... .......... 64% 13.2M 9s
 64550K .......... .......... .......... .......... .......... 64% 8.54M 9s
 64600K .......... .......... .......... .......... .......... 64% 6.28M 9s
 64650K .......... .......... .......... .......... .......... 64% 28.9M 9s
 64700K .......... .......... .......... .......... .......... 64% 16.9M 9s
 64750K .......... .......... .......... .......... .......... 64% 29.6M 9s
 64800K .......... .......... .......... .......... .......... 64% 9.05M 9s
 64850K .......... .......... .......... .......... .......... 64% 13.5M 9s
 64900K .......... .......... .......... .......... .......... 64% 2.45M 9s
 64950K .......... .......... .......... .......... .......... 64% 11.1M 9s
 65000K .......... .......... .......... .......... .......... 64% 6.79M 9s
 65050K .......... .......... .......... .......... .......... 64% 9.22M 9s
 65100K .......... .......... .......... .......... .......... 64% 13.6M 9s
 65150K .......... .......... .......... .......... .......... 64% 16.1M 9s
 65200K .......... .......... .......... .......... .......... 64% 11.4M 9s
 65250K .......... .......... .......... .......... .......... 64% 12.2M 9s
 65300K .......... .......... .......... .......... .......... 65% 11.8M 9s
 65350K .......... .......... .......... .......... .......... 65% 12.5M 9s
 65400K .......... .......... .......... .......... .......... 65% 8.74M 9s
 65450K .......... .......... .......... .......... .......... 65% 11.6M 9s
 65500K .......... .......... .......... .......... .......... 65% 7.54M 9s
 65550K .......... .......... .......... .......... .......... 65% 2.77M 9s
 65600K .......... .......... .......... .......... .......... 65% 9.43M 9s
 65650K .......... .......... .......... .......... .......... 65% 10.9M 9s
 65700K .......... .......... .......... .......... .......... 65% 12.8M 9s
 65750K .......... .......... .......... .......... .......... 65% 6.39M 9s
 65800K .......... .......... .......... .......... .......... 65% 26.4M 9s
 65850K .......... .......... .......... .......... .......... 65% 16.5M 9s
 65900K .......... .......... .......... .......... .......... 65% 11.4M 9s
 65950K .......... .......... .......... .......... .......... 65% 9.05M 9s
 66000K .......... .......... .......... .......... .......... 65% 10.4M 9s
 66050K .......... .......... .......... .......... .......... 65% 13.9M 9s
 66100K .......... .......... .......... .......... .......... 65% 2.21M 9s
 66150K .......... .......... .......... .......... .......... 65% 4.17M 9s
 66200K .......... .......... .......... .......... .......... 65% 69.0M 9s
 66250K .......... .......... .......... .......... .......... 65% 43.0M 9s
 66300K .......... .......... .......... .......... .......... 66% 27.8M 8s
 66350K .......... .......... .......... .......... .......... 66% 31.4M 8s
 66400K .......... .......... .......... .......... .......... 66% 17.7M 8s
 66450K .......... .......... .......... .......... .......... 66% 2.66M 8s
 66500K .......... .......... .......... .......... .......... 66% 53.5M 8s
 66550K .......... .......... .......... .......... .......... 66% 75.7M 8s
 66600K .......... .......... .......... .......... .......... 66% 77.4M 8s
 66650K .......... .......... .......... .......... .......... 66% 16.7M 8s
 66700K .......... .......... .......... .......... .......... 66% 2.49M 8s
 66750K .......... .......... .......... .......... .......... 66% 2.34M 8s
 66800K .......... .......... .......... .......... .......... 66% 49.9M 8s
 66850K .......... .......... .......... .......... .......... 66% 1.68M 8s
 66900K .......... .......... .......... .......... .......... 66% 27.5M 8s
 66950K .......... .......... .......... .......... .......... 66% 54.1M 8s
 67000K .......... .......... .......... .......... .......... 66% 98.4M 8s
 67050K .......... .......... .......... .......... .......... 66%  126M 8s
 67100K .......... .......... .......... .......... .......... 66%  139M 8s
 67150K .......... .......... .......... .......... .......... 66%  106M 8s
 67200K .......... .......... .......... .......... .......... 66% 76.9M 8s
 67250K .......... .......... .......... .......... .......... 66% 23.8M 8s
 67300K .......... .......... .......... .......... .......... 67% 18.8M 8s
 67350K .......... .......... .......... .......... .......... 67% 1.24M 8s
 67400K .......... .......... .......... .......... .......... 67% 9.42M 8s
 67450K .......... .......... .......... .......... .......... 67% 11.5M 8s
 67500K .......... .......... .......... .......... .......... 67% 7.97M 8s
 67550K .......... .......... .......... .......... .......... 67% 12.0M 8s
 67600K .......... .......... .......... .......... .......... 67% 12.6M 8s
 67650K .......... .......... .......... .......... .......... 67% 9.81M 8s
 67700K .......... .......... .......... .......... .......... 67% 7.31M 8s
 67750K .......... .......... .......... .......... .......... 67% 25.8M 8s
 67800K .......... .......... .......... .......... .......... 67%  840K 8s
 67850K .......... .......... .......... .......... .......... 67% 25.4M 8s
 67900K .......... .......... .......... .......... .......... 67% 22.0M 8s
 67950K .......... .......... .......... .......... .......... 67% 18.0M 8s
 68000K .......... .......... .......... .......... .......... 67% 33.1M 8s
 68050K .......... .......... .......... .......... .......... 67% 48.0M 8s
 68100K .......... .......... .......... .......... .......... 67% 31.3M 8s
 68150K .......... .......... .......... .......... .......... 67% 43.5M 8s
 68200K .......... .......... .......... .......... .......... 67% 60.9M 8s
 68250K .......... .......... .......... .......... .......... 67% 18.8M 8s
 68300K .......... .......... .......... .......... .......... 68% 31.7M 8s
 68350K .......... .......... .......... .......... .......... 68% 42.8M 8s
 68400K .......... .......... .......... .......... .......... 68% 1.18M 8s
 68450K .......... .......... .......... .......... .......... 68% 20.0M 8s
 68500K .......... .......... .......... .......... .......... 68% 7.57M 8s
 68550K .......... .......... .......... .......... .......... 68% 5.45M 8s
 68600K .......... .......... .......... .......... .......... 68% 15.7M 8s
 68650K .......... .......... .......... .......... .......... 68% 13.4M 8s
 68700K .......... .......... .......... .......... .......... 68% 7.56M 8s
 68750K .......... .......... .......... .......... .......... 68% 13.5M 8s
 68800K .......... .......... .......... .......... .......... 68% 13.7M 8s
 68850K .......... .......... .......... .......... .......... 68% 11.9M 8s
 68900K .......... .......... .......... .......... .......... 68% 10.3M 8s
 68950K .......... .......... .......... .......... .......... 68% 10.1M 8s
 69000K .......... .......... .......... .......... .......... 68% 14.0M 8s
 69050K .......... .......... .......... .......... .......... 68% 6.14M 8s
 69100K .......... .......... .......... .......... .......... 68%  863K 8s
 69150K .......... .......... .......... .......... .......... 68% 10.9M 8s
 69200K .......... .......... .......... .......... .......... 68% 19.4M 8s
 69250K .......... .......... .......... .......... .......... 68% 15.1M 8s
 69300K .......... .......... .......... .......... .......... 69% 65.3M 8s
 69350K .......... .......... .......... .......... .......... 69% 35.4M 8s
 69400K .......... .......... .......... .......... .......... 69% 56.6M 8s
 69450K .......... .......... .......... .......... .......... 69% 42.2M 8s
 69500K .......... .......... .......... .......... .......... 69% 46.1M 8s
 69550K .......... .......... .......... .......... .......... 69% 36.8M 8s
 69600K .......... .......... .......... .......... .......... 69% 40.4M 8s
 69650K .......... .......... .......... .......... .......... 69% 1.30M 8s
 69700K .......... .......... .......... .......... .......... 69% 12.5M 7s
 69750K .......... .......... .......... .......... .......... 69% 9.57M 7s
 69800K .......... .......... .......... .......... .......... 69% 13.1M 7s
 69850K .......... .......... .......... .......... .......... 69% 8.09M 7s
 69900K .......... .......... .......... .......... .......... 69% 5.31M 7s
 69950K .......... .......... .......... .......... .......... 69% 9.46M 7s
 70000K .......... .......... .......... .......... .......... 69% 12.9M 7s
 70050K .......... .......... .......... .......... .......... 69% 4.79M 7s
 70100K .......... .......... .......... .......... .......... 69% 15.1M 7s
 70150K .......... .......... .......... .......... .......... 69% 14.1M 7s
 70200K .......... .......... .......... .......... .......... 69% 3.24M 7s
 70250K .......... .......... .......... .......... .......... 69% 17.0M 7s
 70300K .......... .......... .......... .......... .......... 70% 21.0M 7s
 70350K .......... .......... .......... .......... .......... 70% 8.01M 7s
 70400K .......... .......... .......... .......... .......... 70% 27.8M 7s
 70450K .......... .......... .......... .......... .......... 70% 7.96M 7s
 70500K .......... .......... .......... .......... .......... 70% 7.51M 7s
 70550K .......... .......... .......... .......... .......... 70% 12.6M 7s
 70600K .......... .......... .......... .......... .......... 70% 16.3M 7s
 70650K .......... .......... .......... .......... .......... 70% 11.2M 7s
 70700K .......... .......... .......... .......... .......... 70% 12.5M 7s
 70750K .......... .......... .......... .......... .......... 70% 9.19M 7s
 70800K .......... .......... .......... .......... .......... 70% 3.53M 7s
 70850K .......... .......... .......... .......... .......... 70% 8.82M 7s
 70900K .......... .......... .......... .......... .......... 70% 11.0M 7s
 70950K .......... .......... .......... .......... .......... 70% 3.92M 7s
 71000K .......... .......... .......... .......... .......... 70% 30.6M 7s
 71050K .......... .......... .......... .......... .......... 70% 12.7M 7s
 71100K .......... .......... .......... .......... .......... 70% 2.94M 7s
 71150K .......... .......... .......... .......... .......... 70% 5.32M 7s
 71200K .......... .......... .......... .......... .......... 70% 32.8M 7s
 71250K .......... .......... .......... .......... .......... 70% 11.8M 7s
 71300K .......... .......... .......... .......... .......... 71% 46.9M 7s
 71350K .......... .......... .......... .......... .......... 71% 39.6M 7s
 71400K .......... .......... .......... .......... .......... 71% 37.9M 7s
 71450K .......... .......... .......... .......... .......... 71% 51.0M 7s
 71500K .......... .......... .......... .......... .......... 71% 63.7M 7s
 71550K .......... .......... .......... .......... .......... 71% 4.36M 7s
 71600K .......... .......... .......... .......... .......... 71% 5.93M 7s
 71650K .......... .......... .......... .......... .......... 71% 10.4M 7s
 71700K .......... .......... .......... .......... .......... 71% 4.18M 7s
 71750K .......... .......... .......... .......... .......... 71% 4.03M 7s
 71800K .......... .......... .......... .......... .......... 71% 4.72M 7s
 71850K .......... .......... .......... .......... .......... 71% 7.73M 7s
 71900K .......... .......... .......... .......... .......... 71% 39.9M 7s
 71950K .......... .......... .......... .......... .......... 71% 5.74M 7s
 72000K .......... .......... .......... .......... .......... 71% 7.39M 7s
 72050K .......... .......... .......... .......... .......... 71% 25.4M 7s
 72100K .......... .......... .......... .......... .......... 71% 5.05M 7s
 72150K .......... .......... .......... .......... .......... 71% 17.1M 7s
 72200K .......... .......... .......... .......... .......... 71% 17.3M 7s
 72250K .......... .......... .......... .......... .......... 71% 20.0M 7s
 72300K .......... .......... .......... .......... .......... 72% 9.14M 7s
 72350K .......... .......... .......... .......... .......... 72% 5.28M 7s
 72400K .......... .......... .......... .......... .......... 72% 32.4M 7s
 72450K .......... .......... .......... .......... .......... 72% 10.3M 7s
 72500K .......... .......... .......... .......... .......... 72% 19.8M 7s
 72550K .......... .......... .......... .......... .......... 72% 8.72M 7s
 72600K .......... .......... .......... .......... .......... 72% 1.65M 7s
 72650K .......... .......... .......... .......... .......... 72% 27.8M 7s
 72700K .......... .......... .......... .......... .......... 72% 69.3M 7s
 72750K .......... .......... .......... .......... .......... 72% 51.8M 7s
 72800K .......... .......... .......... .......... .......... 72% 78.1M 7s
 72850K .......... .......... .......... .......... .......... 72% 19.0M 7s
 72900K .......... .......... .......... .......... .......... 72% 6.93M 7s
 72950K .......... .......... .......... .......... .......... 72% 7.53M 7s
 73000K .......... .......... .......... .......... .......... 72% 11.1M 7s
 73050K .......... .......... .......... .......... .......... 72% 11.6M 7s
 73100K .......... .......... .......... .......... .......... 72% 10.4M 6s
 73150K .......... .......... .......... .......... .......... 72% 6.48M 6s
 73200K .......... .......... .......... .......... .......... 72% 2.90M 6s
 73250K .......... .......... .......... .......... .......... 72% 5.33M 6s
 73300K .......... .......... .......... .......... .......... 73% 4.00M 6s
 73350K .......... .......... .......... .......... .......... 73% 6.25M 6s
 73400K .......... .......... .......... .......... .......... 73% 25.2M 6s
 73450K .......... .......... .......... .......... .......... 73% 7.58M 6s
 73500K .......... .......... .......... .......... .......... 73% 8.50M 6s
 73550K .......... .......... .......... .......... .......... 73% 10.7M 6s
 73600K .......... .......... .......... .......... .......... 73% 4.88M 6s
 73650K .......... .......... .......... .......... .......... 73% 8.06M 6s
 73700K .......... .......... .......... .......... .......... 73% 6.46M 6s
 73750K .......... .......... .......... .......... .......... 73% 33.1M 6s
 73800K .......... .......... .......... .......... .......... 73% 12.8M 6s
 73850K .......... .......... .......... .......... .......... 73% 14.8M 6s
 73900K .......... .......... .......... .......... .......... 73% 12.7M 6s
 73950K .......... .......... .......... .......... .......... 73% 5.43M 6s
 74000K .......... .......... .......... .......... .......... 73% 6.39M 6s
 74050K .......... .......... .......... .......... .......... 73% 10.6M 6s
 74100K .......... .......... .......... .......... .......... 73% 11.0M 6s
 74150K .......... .......... .......... .......... .......... 73% 31.3M 6s
 74200K .......... .......... .......... .......... .......... 73% 7.26M 6s
 74250K .......... .......... .......... .......... .......... 73% 14.0M 6s
 74300K .......... .......... .......... .......... .......... 74% 9.30M 6s
 74350K .......... .......... .......... .......... .......... 74% 7.95M 6s
 74400K .......... .......... .......... .......... .......... 74% 6.22M 6s
 74450K .......... .......... .......... .......... .......... 74% 6.84M 6s
 74500K .......... .......... .......... .......... .......... 74% 5.98M 6s
 74550K .......... .......... .......... .......... .......... 74% 8.49M 6s
 74600K .......... .......... .......... .......... .......... 74% 22.6M 6s
 74650K .......... .......... .......... .......... .......... 74% 11.7M 6s
 74700K .......... .......... .......... .......... .......... 74% 5.84M 6s
 74750K .......... .......... .......... .......... .......... 74% 27.5M 6s
 74800K .......... .......... .......... .......... .......... 74% 12.3M 6s
 74850K .......... .......... .......... .......... .......... 74% 7.27M 6s
 74900K .......... .......... .......... .......... .......... 74% 8.29M 6s
 74950K .......... .......... .......... .......... .......... 74% 14.1M 6s
 75000K .......... .......... .......... .......... .......... 74% 10.2M 6s
 75050K .......... .......... .......... .......... .......... 74% 16.4M 6s
 75100K .......... .......... .......... .......... .......... 74% 10.0M 6s
 75150K .......... .......... .......... .......... .......... 74% 8.71M 6s
 75200K .......... .......... .......... .......... .......... 74% 3.58M 6s
 75250K .......... .......... .......... .......... .......... 74% 14.8M 6s
 75300K .......... .......... .......... .......... .......... 74% 12.6M 6s
 75350K .......... .......... .......... .......... .......... 75% 13.1M 6s
 75400K .......... .......... .......... .......... .......... 75% 2.88M 6s
 75450K .......... .......... .......... .......... .......... 75% 2.47M 6s
 75500K .......... .......... .......... .......... .......... 75% 3.15M 6s
 75550K .......... .......... .......... .......... .......... 75% 5.52M 6s
 75600K .......... .......... .......... .......... .......... 75%  145M 6s
 75650K .......... .......... .......... .......... .......... 75% 24.7M 6s
 75700K .......... .......... .......... .......... .......... 75% 18.5M 6s
 75750K .......... .......... .......... .......... .......... 75% 35.0M 6s
 75800K .......... .......... .......... .......... .......... 75% 13.1M 6s
 75850K .......... .......... .......... .......... .......... 75% 21.1M 6s
 75900K .......... .......... .......... .......... .......... 75% 18.3M 6s
 75950K .......... .......... .......... .......... .......... 75% 7.44M 6s
 76000K .......... .......... .......... .......... .......... 75% 17.1M 6s
 76050K .......... .......... .......... .......... .......... 75% 16.9M 6s
 76100K .......... .......... .......... .......... .......... 75% 4.17M 6s
 76150K .......... .......... .......... .......... .......... 75% 2.03M 6s
 76200K .......... .......... .......... .......... .......... 75% 18.9M 6s
 76250K .......... .......... .......... .......... .......... 75% 9.54M 6s
 76300K .......... .......... .......... .......... .......... 75% 13.4M 6s
 76350K .......... .......... .......... .......... .......... 76% 9.84M 6s
 76400K .......... .......... .......... .......... .......... 76% 11.5M 6s
 76450K .......... .......... .......... .......... .......... 76% 2.16M 6s
 76500K .......... .......... .......... .......... .......... 76% 51.8M 6s
 76550K .......... .......... .......... .......... .......... 76% 12.2M 6s
 76600K .......... .......... .......... .......... .......... 76% 2.54M 6s
 76650K .......... .......... .......... .......... .......... 76% 2.80M 6s
 76700K .......... .......... .......... .......... .......... 76% 36.9M 6s
 76750K .......... .......... .......... .......... .......... 76% 30.8M 6s
 76800K .......... .......... .......... .......... .......... 76% 30.9M 5s
 76850K .......... .......... .......... .......... .......... 76% 17.8M 5s
 76900K .......... .......... .......... .......... .......... 76% 44.7M 5s
 76950K .......... .......... .......... .......... .......... 76% 32.8M 5s
 77000K .......... .......... .......... .......... .......... 76% 41.0M 5s
 77050K .......... .......... .......... .......... .......... 76% 31.3M 5s
 77100K .......... .......... .......... .......... .......... 76% 14.4M 5s
 77150K .......... .......... .......... .......... .......... 76% 6.00M 5s
 77200K .......... .......... .......... .......... .......... 76% 1.56M 5s
 77250K .......... .......... .......... .......... .......... 76% 6.21M 5s
 77300K .......... .......... .......... .......... .......... 76% 13.0M 5s
 77350K .......... .......... .......... .......... .......... 77% 7.41M 5s
 77400K .......... .......... .......... .......... .......... 77% 14.7M 5s
 77450K .......... .......... .......... .......... .......... 77% 12.7M 5s
 77500K .......... .......... .......... .......... .......... 77% 11.5M 5s
 77550K .......... .......... .......... .......... .......... 77% 5.24M 5s
 77600K .......... .......... .......... .......... .......... 77% 7.99M 5s
 77650K .......... .......... .......... .......... .......... 77% 9.37M 5s
 77700K .......... .......... .......... .......... .......... 77% 10.3M 5s
 77750K .......... .......... .......... .......... .......... 77% 13.1M 5s
 77800K .......... .......... .......... .......... .......... 77% 5.97M 5s
 77850K .......... .......... .......... .......... .......... 77% 11.2M 5s
 77900K .......... .......... .......... .......... .......... 77% 9.77M 5s
 77950K .......... .......... .......... .......... .......... 77% 4.74M 5s
 78000K .......... .......... .......... .......... .......... 77% 16.7M 5s
 78050K .......... .......... .......... .......... .......... 77% 12.1M 5s
 78100K .......... .......... .......... .......... .......... 77% 5.81M 5s
 78150K .......... .......... .......... .......... .......... 77% 8.22M 5s
 78200K .......... .......... .......... .......... .......... 77% 11.7M 5s
 78250K .......... .......... .......... .......... .......... 77%  977K 5s
 78300K .......... .......... .......... .......... .......... 77% 20.0M 5s
 78350K .......... .......... .......... .......... .......... 78% 11.3M 5s
 78400K .......... .......... .......... .......... .......... 78% 35.7M 5s
 78450K .......... .......... .......... .......... .......... 78% 44.9M 5s
 78500K .......... .......... .......... .......... .......... 78% 69.6M 5s
 78550K .......... .......... .......... .......... .......... 78% 52.5M 5s
 78600K .......... .......... .......... .......... .......... 78% 27.9M 5s
 78650K .......... .......... .......... .......... .......... 78% 24.2M 5s
 78700K .......... .......... .......... .......... .......... 78% 24.1M 5s
 78750K .......... .......... .......... .......... .......... 78% 7.34M 5s
 78800K .......... .......... .......... .......... .......... 78% 13.5M 5s
 78850K .......... .......... .......... .......... .......... 78% 12.1M 5s
 78900K .......... .......... .......... .......... .......... 78% 1.71M 5s
 78950K .......... .......... .......... .......... .......... 78% 8.91M 5s
 79000K .......... .......... .......... .......... .......... 78% 6.93M 5s
 79050K .......... .......... .......... .......... .......... 78% 7.00M 5s
 79100K .......... .......... .......... .......... .......... 78% 29.6M 5s
 79150K .......... .......... .......... .......... .......... 78% 2.65M 5s
 79200K .......... .......... .......... .......... .......... 78% 1.56M 5s
 79250K .......... .......... .......... .......... .......... 78% 15.9M 5s
 79300K .......... .......... .......... .......... .......... 78% 4.92M 5s
 79350K .......... .......... .......... .......... .......... 79% 37.0M 5s
 79400K .......... .......... .......... .......... .......... 79% 5.47M 5s
 79450K .......... .......... .......... .......... .......... 79% 21.5M 5s
 79500K .......... .......... .......... .......... .......... 79% 24.3M 5s
 79550K .......... .......... .......... .......... .......... 79% 9.21M 5s
 79600K .......... .......... .......... .......... .......... 79% 13.5M 5s
 79650K .......... .......... .......... .......... .......... 79% 27.1M 5s
 79700K .......... .......... .......... .......... .......... 79% 18.6M 5s
 79750K .......... .......... .......... .......... .......... 79% 32.4M 5s
 79800K .......... .......... .......... .......... .......... 79% 26.0M 5s
 79850K .......... .......... .......... .......... .......... 79% 3.56M 5s
 79900K .......... .......... .......... .......... .......... 79% 4.01M 5s
 79950K .......... .......... .......... .......... .......... 79% 3.50M 5s
 80000K .......... .......... .......... .......... .......... 79% 42.7M 5s
 80050K .......... .......... .......... .......... .......... 79% 11.6M 5s
 80100K .......... .......... .......... .......... .......... 79% 12.2M 5s
 80150K .......... .......... .......... .......... .......... 79% 15.0M 5s
 80200K .......... .......... .......... .......... .......... 79% 9.97M 5s
 80250K .......... .......... .......... .......... .......... 79% 14.0M 5s
 80300K .......... .......... .......... .......... .......... 79% 5.92M 5s
 80350K .......... .......... .......... .......... .......... 80% 11.8M 5s
 80400K .......... .......... .......... .......... .......... 80% 9.50M 5s
 80450K .......... .......... .......... .......... .......... 80% 7.74M 5s
 80500K .......... .......... .......... .......... .......... 80% 12.4M 5s
 80550K .......... .......... .......... .......... .......... 80% 5.54M 5s
 80600K .......... .......... .......... .......... .......... 80% 6.11M 5s
 80650K .......... .......... .......... .......... .......... 80% 12.4M 5s
 80700K .......... .......... .......... .......... .......... 80% 13.6M 4s
 80750K .......... .......... .......... .......... .......... 80% 2.98M 4s
 80800K .......... .......... .......... .......... .......... 80% 40.5M 4s
 80850K .......... .......... .......... .......... .......... 80% 13.6M 4s
 80900K .......... .......... .......... .......... .......... 80% 12.8M 4s
 80950K .......... .......... .......... .......... .......... 80% 13.1M 4s
 81000K .......... .......... .......... .......... .......... 80% 13.0M 4s
 81050K .......... .......... .......... .......... .......... 80% 6.63M 4s
 81100K .......... .......... .......... .......... .......... 80% 4.94M 4s
 81150K .......... .......... .......... .......... .......... 80% 7.92M 4s
 81200K .......... .......... .......... .......... .......... 80% 28.9M 4s
 81250K .......... .......... .......... .......... .......... 80% 10.4M 4s
 81300K .......... .......... .......... .......... .......... 80% 10.6M 4s
 81350K .......... .......... .......... .......... .......... 81% 9.09M 4s
 81400K .......... .......... .......... .......... .......... 81% 10.5M 4s
 81450K .......... .......... .......... .......... .......... 81% 5.86M 4s
 81500K .......... .......... .......... .......... .......... 81% 37.0M 4s
 81550K .......... .......... .......... .......... .......... 81% 7.66M 4s
 81600K .......... .......... .......... .......... .......... 81% 11.2M 4s
 81650K .......... .......... .......... .......... .......... 81% 12.2M 4s
 81700K .......... .......... .......... .......... .......... 81% 4.77M 4s
 81750K .......... .......... .......... .......... .......... 81% 10.6M 4s
 81800K .......... .......... .......... .......... .......... 81% 10.4M 4s
 81850K .......... .......... .......... .......... .......... 81% 5.78M 4s
 81900K .......... .......... .......... .......... .......... 81% 2.66M 4s
 81950K .......... .......... .......... .......... .......... 81% 63.4M 4s
 82000K .......... .......... .......... .......... .......... 81% 55.1M 4s
 82050K .......... .......... .......... .......... .......... 81% 90.9M 4s
 82100K .......... .......... .......... .......... .......... 81% 46.1M 4s
 82150K .......... .......... .......... .......... .......... 81% 24.2M 4s
 82200K .......... .......... .......... .......... .......... 81% 12.4M 4s
 82250K .......... .......... .......... .......... .......... 81% 7.30M 4s
 82300K .......... .......... .......... .......... .......... 81% 9.19M 4s
 82350K .......... .......... .......... .......... .......... 82% 7.25M 4s
 82400K .......... .......... .......... .......... .......... 82% 18.1M 4s
 82450K .......... .......... .......... .......... .......... 82% 12.4M 4s
 82500K .......... .......... .......... .......... .......... 82% 7.01M 4s
 82550K .......... .......... .......... .......... .......... 82% 1.62M 4s
 82600K .......... .......... .......... .......... .......... 82% 11.0M 4s
 82650K .......... .......... .......... .......... .......... 82% 11.1M 4s
 82700K .......... .......... .......... .......... .......... 82% 28.6M 4s
 82750K .......... .......... .......... .......... .......... 82% 8.29M 4s
 82800K .......... .......... .......... .......... .......... 82% 12.8M 4s
 82850K .......... .......... .......... .......... .......... 82% 13.2M 4s
 82900K .......... .......... .......... .......... .......... 82% 4.47M 4s
 82950K .......... .......... .......... .......... .......... 82% 12.5M 4s
 83000K .......... .......... .......... .......... .......... 82% 7.33M 4s
 83050K .......... .......... .......... .......... .......... 82% 30.4M 4s
 83100K .......... .......... .......... .......... .......... 82% 12.3M 4s
 83150K .......... .......... .......... .......... .......... 82% 6.03M 4s
 83200K .......... .......... .......... .......... .......... 82% 17.3M 4s
 83250K .......... .......... .......... .......... .......... 82% 1.69M 4s
 83300K .......... .......... .......... .......... .......... 82% 84.9M 4s
 83350K .......... .......... .......... .......... .......... 83% 48.7M 4s
 83400K .......... .......... .......... .......... .......... 83% 65.2M 4s
 83450K .......... .......... .......... .......... .......... 83% 64.4M 4s
 83500K .......... .......... .......... .......... .......... 83% 55.3M 4s
 83550K .......... .......... .......... .......... .......... 83% 2.14M 4s
 83600K .......... .......... .......... .......... .......... 83% 34.1M 4s
 83650K .......... .......... .......... .......... .......... 83% 67.4M 4s
 83700K .......... .......... .......... .......... .......... 83% 5.10M 4s
 83750K .......... .......... .......... .......... .......... 83% 9.70M 4s
 83800K .......... .......... .......... .......... .......... 83% 9.03M 4s
 83850K .......... .......... .......... .......... .......... 83% 7.89M 4s
 83900K .......... .......... .......... .......... .......... 83% 6.22M 4s
 83950K .......... .......... .......... .......... .......... 83%  695K 4s
 84000K .......... .......... .......... .......... .......... 83% 23.4M 4s
 84050K .......... .......... .......... .......... .......... 83% 26.6M 4s
 84100K .......... .......... .......... .......... .......... 83% 27.7M 4s
 84150K .......... .......... .......... .......... .......... 83% 31.2M 4s
 84200K .......... .......... .......... .......... .......... 83% 22.9M 4s
 84250K .......... .......... .......... .......... .......... 83% 18.5M 4s
 84300K .......... .......... .......... .......... .......... 83% 16.9M 4s
 84350K .......... .......... .......... .......... .......... 84% 28.6M 4s
 84400K .......... .......... .......... .......... .......... 84% 33.0M 4s
 84450K .......... .......... .......... .......... .......... 84% 26.9M 4s
 84500K .......... .......... .......... .......... .......... 84% 20.8M 4s
 84550K .......... .......... .......... .......... .......... 84% 34.6M 4s
 84600K .......... .......... .......... .......... .......... 84%  905K 4s
 84650K .......... .......... .......... .......... .......... 84% 39.5M 4s
 84700K .......... .......... .......... .......... .......... 84% 46.4M 4s
 84750K .......... .......... .......... .......... .......... 84% 21.2M 3s
 84800K .......... .......... .......... .......... .......... 84% 21.6M 3s
 84850K .......... .......... .......... .......... .......... 84% 12.1M 3s
 84900K .......... .......... .......... .......... .......... 84% 1.48M 3s
 84950K .......... .......... .......... .......... .......... 84%  102M 3s
 85000K .......... .......... .......... .......... .......... 84%  119M 3s
 85050K .......... .......... .......... .......... .......... 84%  164M 3s
 85100K .......... .......... .......... .......... .......... 84%  168M 3s
 85150K .......... .......... .......... .......... .......... 84%  142M 3s
 85200K .......... .......... .......... .......... .......... 84%  110M 3s
 85250K .......... .......... .......... .......... .......... 84% 3.92M 3s
 85300K .......... .......... .......... .......... .......... 84% 8.80M 3s
 85350K .......... .......... .......... .......... .......... 85% 10.2M 3s
 85400K .......... .......... .......... .......... .......... 85% 10.9M 3s
 85450K .......... .......... .......... .......... .......... 85% 13.1M 3s
 85500K .......... .......... .......... .......... .......... 85% 7.33M 3s
 85550K .......... .......... .......... .......... .......... 85% 2.46M 3s
 85600K .......... .......... .......... .......... .......... 85% 7.23M 3s
 85650K .......... .......... .......... .......... .......... 85% 15.0M 3s
 85700K .......... .......... .......... .......... .......... 85% 13.1M 3s
 85750K .......... .......... .......... .......... .......... 85% 7.78M 3s
 85800K .......... .......... .......... .......... .......... 85% 16.5M 3s
 85850K .......... .......... .......... .......... .......... 85% 12.4M 3s
 85900K .......... .......... .......... .......... .......... 85% 7.41M 3s
 85950K .......... .......... .......... .......... .......... 85% 17.0M 3s
 86000K .......... .......... .......... .......... .......... 85% 7.29M 3s
 86050K .......... .......... .......... .......... .......... 85% 9.68M 3s
 86100K .......... .......... .......... .......... .......... 85% 26.9M 3s
 86150K .......... .......... .......... .......... .......... 85% 16.3M 3s
 86200K .......... .......... .......... .......... .......... 85% 11.1M 3s
 86250K .......... .......... .......... .......... .......... 85% 12.1M 3s
 86300K .......... .......... .......... .......... .......... 85% 6.83M 3s
 86350K .......... .......... .......... .......... .......... 85% 8.91M 3s
 86400K .......... .......... .......... .......... .......... 86% 5.35M 3s
 86450K .......... .......... .......... .......... .......... 86% 15.5M 3s
 86500K .......... .......... .......... .......... .......... 86% 8.53M 3s
 86550K .......... .......... .......... .......... .......... 86% 5.81M 3s
 86600K .......... .......... .......... .......... .......... 86% 14.3M 3s
 86650K .......... .......... .......... .......... .......... 86% 13.0M 3s
 86700K .......... .......... .......... .......... .......... 86% 11.5M 3s
 86750K .......... .......... .......... .......... .......... 86% 9.46M 3s
 86800K .......... .......... .......... .......... .......... 86% 6.02M 3s
 86850K .......... .......... .......... .......... .......... 86% 22.0M 3s
 86900K .......... .......... .......... .......... .......... 86% 18.5M 3s
 86950K .......... .......... .......... .......... .......... 86% 13.1M 3s
 87000K .......... .......... .......... .......... .......... 86%  560K 3s
 87050K .......... .......... .......... .......... .......... 86% 41.5M 3s
 87100K .......... .......... .......... .......... .......... 86% 37.1M 3s
 87150K .......... .......... .......... .......... .......... 86% 24.4M 3s
 87200K .......... .......... .......... .......... .......... 86% 22.9M 3s
 87250K .......... .......... .......... .......... .......... 86% 25.7M 3s
 87300K .......... .......... .......... .......... .......... 86% 29.8M 3s
 87350K .......... .......... .......... .......... .......... 86% 40.6M 3s
 87400K .......... .......... .......... .......... .......... 87% 32.5M 3s
 87450K .......... .......... .......... .......... .......... 87% 73.2M 3s
 87500K .......... .......... .......... .......... .......... 87% 28.7M 3s
 87550K .......... .......... .......... .......... .......... 87% 24.1M 3s
 87600K .......... .......... .......... .......... .......... 87% 31.2M 3s
 87650K .......... .......... .......... .......... .......... 87% 1.36M 3s
 87700K .......... .......... .......... .......... .......... 87% 6.84M 3s
 87750K .......... .......... .......... .......... .......... 87% 10.6M 3s
 87800K .......... .......... .......... .......... .......... 87% 18.2M 3s
 87850K .......... .......... .......... .......... .......... 87% 1.52M 3s
 87900K .......... .......... .......... .......... .......... 87% 33.6M 3s
 87950K .......... .......... .......... .......... .......... 87% 19.0M 3s
 88000K .......... .......... .......... .......... .......... 87% 27.9M 3s
 88050K .......... .......... .......... .......... .......... 87% 19.5M 3s
 88100K .......... .......... .......... .......... .......... 87% 22.0M 3s
 88150K .......... .......... .......... .......... .......... 87% 50.4M 3s
 88200K .......... .......... .......... .......... .......... 87% 17.2M 3s
 88250K .......... .......... .......... .......... .......... 87% 46.6M 3s
 88300K .......... .......... .......... .......... .......... 87% 15.0M 3s
 88350K .......... .......... .......... .......... .......... 87% 7.96M 3s
 88400K .......... .......... .......... .......... .......... 88% 9.52M 3s
 88450K .......... .......... .......... .......... .......... 88% 67.6M 3s
 88500K .......... .......... .......... .......... .......... 88% 1.81M 3s
 88550K .......... .......... .......... .......... .......... 88% 7.21M 3s
 88600K .......... .......... .......... .......... .......... 88% 12.3M 3s
 88650K .......... .......... .......... .......... .......... 88% 13.0M 3s
 88700K .......... .......... .......... .......... .......... 88% 3.20M 3s
 88750K .......... .......... .......... .......... .......... 88% 15.7M 3s
 88800K .......... .......... .......... .......... .......... 88% 12.3M 3s
 88850K .......... .......... .......... .......... .......... 88% 12.4M 3s
 88900K .......... .......... .......... .......... .......... 88% 10.5M 3s
 88950K .......... .......... .......... .......... .......... 88% 12.8M 3s
 89000K .......... .......... .......... .......... .......... 88% 13.0M 2s
 89050K .......... .......... .......... .......... .......... 88% 8.32M 2s
 89100K .......... .......... .......... .......... .......... 88% 8.16M 2s
 89150K .......... .......... .......... .......... .......... 88% 18.9M 2s
 89200K .......... .......... .......... .......... .......... 88% 7.64M 2s
 89250K .......... .......... .......... .......... .......... 88% 23.5M 2s
 89300K .......... .......... .......... .......... .......... 88% 12.4M 2s
 89350K .......... .......... .......... .......... .......... 88% 12.2M 2s
 89400K .......... .......... .......... .......... .......... 89% 6.54M 2s
 89450K .......... .......... .......... .......... .......... 89% 8.74M 2s
 89500K .......... .......... .......... .......... .......... 89% 12.8M 2s
 89550K .......... .......... .......... .......... .......... 89% 7.23M 2s
 89600K .......... .......... .......... .......... .......... 89% 11.6M 2s
 89650K .......... .......... .......... .......... .......... 89% 13.1M 2s
 89700K .......... .......... .......... .......... .......... 89% 12.9M 2s
 89750K .......... .......... .......... .......... .......... 89% 4.81M 2s
 89800K .......... .......... .......... .......... .......... 89% 5.71M 2s
 89850K .......... .......... .......... .......... .......... 89% 30.5M 2s
 89900K .......... .......... .......... .......... .......... 89% 11.7M 2s
 89950K .......... .......... .......... .......... .......... 89% 9.88M 2s
 90000K .......... .......... .......... .......... .......... 89% 12.2M 2s
 90050K .......... .......... .......... .......... .......... 89% 12.2M 2s
 90100K .......... .......... .......... .......... .......... 89% 12.4M 2s
 90150K .......... .......... .......... .......... .......... 89% 10.2M 2s
 90200K .......... .......... .......... .......... .......... 89% 11.2M 2s
 90250K .......... .......... .......... .......... .......... 89% 5.75M 2s
 90300K .......... .......... .......... .......... .......... 89% 36.6M 2s
 90350K .......... .......... .......... .......... .......... 89% 7.42M 2s
 90400K .......... .......... .......... .......... .......... 90% 12.4M 2s
 90450K .......... .......... .......... .......... .......... 90% 13.7M 2s
 90500K .......... .......... .......... .......... .......... 90% 6.19M 2s
 90550K .......... .......... .......... .......... .......... 90%  515K 2s
 90600K .......... .......... .......... .......... .......... 90% 31.8M 2s
 90650K .......... .......... .......... .......... .......... 90% 56.0M 2s
 90700K .......... .......... .......... .......... .......... 90% 43.0M 2s
 90750K .......... .......... .......... .......... .......... 90% 15.5M 2s
 90800K .......... .......... .......... .......... .......... 90% 45.3M 2s
 90850K .......... .......... .......... .......... .......... 90% 49.2M 2s
 90900K .......... .......... .......... .......... .......... 90% 57.6M 2s
 90950K .......... .......... .......... .......... .......... 90% 39.6M 2s
 91000K .......... .......... .......... .......... .......... 90% 27.6M 2s
 91050K .......... .......... .......... .......... .......... 90% 42.2M 2s
 91100K .......... .......... .......... .......... .......... 90% 63.2M 2s
 91150K .......... .......... .......... .......... .......... 90% 51.0M 2s
 91200K .......... .......... .......... .......... .......... 90%  931K 2s
 91250K .......... .......... .......... .......... .......... 90% 15.4M 2s
 91300K .......... .......... .......... .......... .......... 90% 10.5M 2s
 91350K .......... .......... .......... .......... .......... 90% 11.9M 2s
 91400K .......... .......... .......... .......... .......... 91% 5.99M 2s
 91450K .......... .......... .......... .......... .......... 91% 34.3M 2s
 91500K .......... .......... .......... .......... .......... 91% 12.8M 2s
 91550K .......... .......... .......... .......... .......... 91% 8.61M 2s
 91600K .......... .......... .......... .......... .......... 91% 10.9M 2s
 91650K .......... .......... .......... .......... .......... 91% 12.1M 2s
 91700K .......... .......... .......... .......... .......... 91% 8.09M 2s
 91750K .......... .......... .......... .......... .......... 91% 10.9M 2s
 91800K .......... .......... .......... .......... .......... 91% 5.23M 2s
 91850K .......... .......... .......... .......... .......... 91% 17.5M 2s
 91900K .......... .......... .......... .......... .......... 91% 4.53M 2s
 91950K .......... .......... .......... .......... .......... 91% 7.68M 2s
 92000K .......... .......... .......... .......... .......... 91% 7.93M 2s
 92050K .......... .......... .......... .......... .......... 91% 13.3M 2s
 92100K .......... .......... .......... .......... .......... 91% 5.97M 2s
 92150K .......... .......... .......... .......... .......... 91% 69.9M 2s
 92200K .......... .......... .......... .......... .......... 91% 12.8M 2s
 92250K .......... .......... .......... .......... .......... 91% 11.7M 2s
 92300K .......... .......... .......... .......... .......... 91% 10.7M 2s
 92350K .......... .......... .......... .......... .......... 91% 10.4M 2s
 92400K .......... .......... .......... .......... .......... 92% 6.01M 2s
 92450K .......... .......... .......... .......... .......... 92% 17.2M 2s
 92500K .......... .......... .......... .......... .......... 92% 13.0M 2s
 92550K .......... .......... .......... .......... .......... 92% 10.8M 2s
 92600K .......... .......... .......... .......... .......... 92% 7.76M 2s
 92650K .......... .......... .......... .......... .......... 92% 24.6M 2s
 92700K .......... .......... .......... .......... .......... 92% 7.63M 2s
 92750K .......... .......... .......... .......... .......... 92% 9.05M 2s
 92800K .......... .......... .......... .......... .......... 92% 6.24M 2s
 92850K .......... .......... .......... .......... .......... 92% 3.52M 2s
 92900K .......... .......... .......... .......... .......... 92% 22.3M 2s
 92950K .......... .......... .......... .......... .......... 92% 13.4M 2s
 93000K .......... .......... .......... .......... .......... 92% 4.89M 2s
 93050K .......... .......... .......... .......... .......... 92% 16.8M 2s
 93100K .......... .......... .......... .......... .......... 92% 23.8M 2s
 93150K .......... .......... .......... .......... .......... 92% 9.79M 2s
 93200K .......... .......... .......... .......... .......... 92% 54.6M 2s
 93250K .......... .......... .......... .......... .......... 92% 8.01M 2s
 93300K .......... .......... .......... .......... .......... 92% 9.91M 2s
 93350K .......... .......... .......... .......... .......... 92% 6.75M 2s
 93400K .......... .......... .......... .......... .......... 93% 55.7M 2s
 93450K .......... .......... .......... .......... .......... 93% 11.3M 1s
 93500K .......... .......... .......... .......... .......... 93% 9.47M 1s
 93550K .......... .......... .......... .......... .......... 93% 9.32M 1s
 93600K .......... .......... .......... .......... .......... 93% 7.01M 1s
 93650K .......... .......... .......... .......... .......... 93% 1.14M 1s
 93700K .......... .......... .......... .......... .......... 93% 5.18M 1s
 93750K .......... .......... .......... .......... .......... 93% 85.4M 1s
 93800K .......... .......... .......... .......... .......... 93% 17.3M 1s
 93850K .......... .......... .......... .......... .......... 93% 8.20M 1s
 93900K .......... .......... .......... .......... .......... 93% 9.01M 1s
 93950K .......... .......... .......... .......... .......... 93% 10.6M 1s
 94000K .......... .......... .......... .......... .......... 93%  103M 1s
 94050K .......... .......... .......... .......... .......... 93% 10.1M 1s
 94100K .......... .......... .......... .......... .......... 93% 5.37M 1s
 94150K .......... .......... .......... .......... .......... 93% 22.8M 1s
 94200K .......... .......... .......... .......... .......... 93% 12.7M 1s
 94250K .......... .......... .......... .......... .......... 93% 14.1M 1s
 94300K .......... .......... .......... .......... .......... 93% 11.1M 1s
 94350K .......... .......... .......... .......... .......... 93% 7.27M 1s
 94400K .......... .......... .......... .......... .......... 94% 10.3M 1s
 94450K .......... .......... .......... .......... .......... 94% 6.45M 1s
 94500K .......... .......... .......... .......... .......... 94% 10.1M 1s
 94550K .......... .......... .......... .......... .......... 94% 1.33M 1s
 94600K .......... .......... .......... .......... .......... 94% 23.5M 1s
 94650K .......... .......... .......... .......... .......... 94% 10.7M 1s
 94700K .......... .......... .......... .......... .......... 94% 13.4M 1s
 94750K .......... .......... .......... .......... .......... 94% 8.86M 1s
 94800K .......... .......... .......... .......... .......... 94% 11.5M 1s
 94850K .......... .......... .......... .......... .......... 94% 10.3M 1s
 94900K .......... .......... .......... .......... .......... 94% 11.4M 1s
 94950K .......... .......... .......... .......... .......... 94% 6.95M 1s
 95000K .......... .......... .......... .......... .......... 94% 10.1M 1s
 95050K .......... .......... .......... .......... .......... 94% 26.4M 1s
 95100K .......... .......... .......... .......... .......... 94% 18.6M 1s
 95150K .......... .......... .......... .......... .......... 94% 1.22M 1s
 95200K .......... .......... .......... .......... .......... 94% 10.3M 1s
 95250K .......... .......... .......... .......... .......... 94% 50.2M 1s
 95300K .......... .......... .......... .......... .......... 94% 6.05M 1s
 95350K .......... .......... .......... .......... .......... 94% 14.8M 1s
 95400K .......... .......... .......... .......... .......... 95% 21.7M 1s
 95450K .......... .......... .......... .......... .......... 95% 36.4M 1s
 95500K .......... .......... .......... .......... .......... 95% 34.1M 1s
 95550K .......... .......... .......... .......... .......... 95% 53.1M 1s
 95600K .......... .......... .......... .......... .......... 95% 43.8M 1s
 95650K .......... .......... .......... .......... .......... 95% 41.1M 1s
 95700K .......... .......... .......... .......... .......... 95% 39.1M 1s
 95750K .......... .......... .......... .......... .......... 95% 25.8M 1s
 95800K .......... .......... .......... .......... .......... 95% 30.1M 1s
 95850K .......... .......... .......... .......... .......... 95% 1.65M 1s
 95900K .......... .......... .......... .......... .......... 95% 9.88M 1s
 95950K .......... .......... .......... .......... .......... 95% 6.65M 1s
 96000K .......... .......... .......... .......... .......... 95% 12.6M 1s
 96050K .......... .......... .......... .......... .......... 95% 7.28M 1s
 96100K .......... .......... .......... .......... .......... 95% 7.07M 1s
 96150K .......... .......... .......... .......... .......... 95% 12.5M 1s
 96200K .......... .......... .......... .......... .......... 95% 6.34M 1s
 96250K .......... .......... .......... .......... .......... 95% 41.7M 1s
 96300K .......... .......... .......... .......... .......... 95% 13.0M 1s
 96350K .......... .......... .......... .......... .......... 95% 9.27M 1s
 96400K .......... .......... .......... .......... .......... 95% 5.58M 1s
 96450K .......... .......... .......... .......... .......... 96% 21.6M 1s
 96500K .......... .......... .......... .......... .......... 96% 7.53M 1s
 96550K .......... .......... .......... .......... .......... 96% 19.1M 1s
 96600K .......... .......... .......... .......... .......... 96% 13.0M 1s
 96650K .......... .......... .......... .......... .......... 96% 13.4M 1s
 96700K .......... .......... .......... .......... .......... 96% 13.0M 1s
 96750K .......... .......... .......... .......... .......... 96% 6.32M 1s
 96800K .......... .......... .......... .......... .......... 96% 18.7M 1s
 96850K .......... .......... .......... .......... .......... 96% 14.6M 1s
 96900K .......... .......... .......... .......... .......... 96% 4.10M 1s
 96950K .......... .......... .......... .......... .......... 96% 11.6M 1s
 97000K .......... .......... .......... .......... .......... 96% 20.9M 1s
 97050K .......... .......... .......... .......... .......... 96%  854K 1s
 97100K .......... .......... .......... .......... .......... 96% 57.6M 1s
 97150K .......... .......... .......... .......... .......... 96% 27.2M 1s
 97200K .......... .......... .......... .......... .......... 96% 25.0M 1s
 97250K .......... .......... .......... .......... .......... 96% 27.2M 1s
 97300K .......... .......... .......... .......... .......... 96% 34.5M 1s
 97350K .......... .......... .......... .......... .......... 96% 33.7M 1s
 97400K .......... .......... .......... .......... .......... 96% 15.5M 1s
 97450K .......... .......... .......... .......... .......... 97% 20.3M 1s
 97500K .......... .......... .......... .......... .......... 97% 31.6M 1s
 97550K .......... .......... .......... .......... .......... 97% 8.63M 1s
 97600K .......... .......... .......... .......... .......... 97% 14.0M 1s
 97650K .......... .......... .......... .......... .......... 97% 13.3M 1s
 97700K .......... .......... .......... .......... .......... 97%  719K 1s
 97750K .......... .......... .......... .......... .......... 97% 12.2M 1s
 97800K .......... .......... .......... .......... .......... 97% 8.55M 1s
 97850K .......... .......... .......... .......... .......... 97% 2.23M 1s
 97900K .......... .......... .......... .......... .......... 97% 2.78M 1s
 97950K .......... .......... .......... .......... .......... 97% 2.96M 1s
 98000K .......... .......... .......... .......... .......... 97% 5.50M 1s
 98050K .......... .......... .......... .......... .......... 97% 6.46M 0s
 98100K .......... .......... .......... .......... .......... 97% 16.2M 0s
 98150K .......... .......... .......... .......... .......... 97% 21.8M 0s
 98200K .......... .......... .......... .......... .......... 97% 18.4M 0s
 98250K .......... .......... .......... .......... .......... 97% 17.3M 0s
 98300K .......... .......... .......... .......... .......... 97% 26.0M 0s
 98350K .......... .......... .......... .......... .......... 97% 29.3M 0s
 98400K .......... .......... .......... .......... .......... 97% 34.0M 0s
 98450K .......... .......... .......... .......... .......... 98% 28.8M 0s
 98500K .......... .......... .......... .......... .......... 98% 23.9M 0s
 98550K .......... .......... .......... .......... .......... 98% 7.87M 0s
 98600K .......... .......... .......... .......... .......... 98% 3.29M 0s
 98650K .......... .......... .......... .......... .......... 98% 8.67M 0s
 98700K .......... .......... .......... .......... .......... 98% 2.16M 0s
 98750K .......... .......... .......... .......... .......... 98% 19.9M 0s
 98800K .......... .......... .......... .......... .......... 98% 13.1M 0s
 98850K .......... .......... .......... .......... .......... 98% 18.7M 0s
 98900K .......... .......... .......... .......... .......... 98% 31.2M 0s
 98950K .......... .......... .......... .......... .......... 98% 9.29M 0s
 99000K .......... .......... .......... .......... .......... 98% 15.0M 0s
 99050K .......... .......... .......... .......... .......... 98% 9.06M 0s
 99100K .......... .......... .......... .......... .......... 98% 13.3M 0s
 99150K .......... .......... .......... .......... .......... 98% 7.42M 0s
 99200K .......... .......... .......... .......... .......... 98% 11.0M 0s
 99250K .......... .......... .......... .......... .......... 98% 9.26M 0s
 99300K .......... .......... .......... .......... .......... 98% 7.48M 0s
 99350K .......... .......... .......... .......... .......... 98% 61.8M 0s
 99400K .......... .......... .......... .......... .......... 98% 4.62M 0s
 99450K .......... .......... .......... .......... .......... 99% 9.40M 0s
 99500K .......... .......... .......... .......... .......... 99% 13.7M 0s
 99550K .......... .......... .......... .......... .......... 99% 8.33M 0s
 99600K .......... .......... .......... .......... .......... 99% 6.69M 0s
 99650K .......... .......... .......... .......... .......... 99% 13.0M 0s
 99700K .......... .......... .......... .......... .......... 99% 4.19M 0s
 99750K .......... .......... .......... .......... .......... 99% 30.3M 0s
 99800K .......... .......... .......... .......... .......... 99% 13.6M 0s
 99850K .......... .......... .......... .......... .......... 99% 11.4M 0s
 99900K .......... .......... .......... .......... .......... 99% 5.66M 0s
 99950K .......... .......... .......... .......... .......... 99% 7.62M 0s
100000K .......... .......... .......... .......... .......... 99% 7.21M 0s
100050K .......... .......... .......... .......... .......... 99% 44.2M 0s
100100K .......... .......... .......... .......... .......... 99% 12.6M 0s
100150K .......... .......... .......... .......... .......... 99% 12.0M 0s
100200K .......... .......... .......... .......... .......... 99% 13.6M 0s
100250K .......... .......... .......... .......... .......... 99% 11.6M 0s
100300K .......... .......... .......... .......... .......... 99% 13.8M 0s
100350K .......... .......... .......... .......... .......... 99% 4.88M 0s
100400K .......... .......... .......... .......... .......... 99% 13.0M 0s
100450K .......... ..........                                 100% 44.1M=21s

2023-03-31 21:22:20 (4.70 MB/s) - ‘Teuk_amps_a0.0_lmax_10_nmax_30_new.h5’ saved [102881792/102881792]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fast_wave</span> <span class="o">=</span> <span class="n">few</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">slow_wave</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fast_wave</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Length check:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fast_wave</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">slow_wave</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mismatch:&#39;</span><span class="p">,</span> <span class="n">get_mismatch</span><span class="p">(</span><span class="n">slow_wave</span><span class="p">,</span> <span class="n">fast_wave</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Length check: 10520 10520
Mismatch: 2.308998239264337e-05
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_24_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_24_1.png" />
</div>
</div>
</section>
</section>
<section id="Trajectory-Module">
<h1>Trajectory Module<a class="headerlink" href="#Trajectory-Module" title="Permalink to this heading"></a></h1>
<p>The trajectory module generates orbital and phase trajectories, <span class="math notranslate nohighlight">\(G(t)\)</span>, for an EMRI orbit:</p>
<p><span class="math">\begin{equation}
G(t) = \{p(t), e(t), \iota(t), \Phi_\phi(t), \Phi_\theta(t), \Phi_r(t)\}
\end{equation}</span></p>
<p>with inputs <span class="math notranslate nohighlight">\(M, \mu, p_0, e_0, \iota_0, \Phi_{\phi,0}, \Phi_{\theta,0}, \Phi_{r, 0}\)</span>. <span class="math notranslate nohighlight">\(M\)</span> is the larger mass (<span class="math notranslate nohighlight">\(M_\odot\)</span>), <span class="math notranslate nohighlight">\(\mu\)</span> is the compact object mass (<span class="math notranslate nohighlight">\(M_\odot\)</span>), <span class="math notranslate nohighlight">\(p_0\)</span> is the initial semi-latus rectum (dimensionless), <span class="math notranslate nohighlight">\(e_0\)</span> is the initial eccentricity, and the final three are the initial phases in <span class="math notranslate nohighlight">\(\phi, \theta, r\)</span>. When working in equatorial orbits, <span class="math notranslate nohighlight">\(\iota(t)\)</span> and <span class="math notranslate nohighlight">\(\Phi_\theta(t)\)</span> are zero. The trajectory module also produces the
gravitational wave flux for normalization information.</p>
<section id="Run-a-basic-trajectory">
<h2>Run a basic trajectory<a class="headerlink" href="#Run-a-basic-trajectory" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize trajectory class</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;SchwarzEccFlux&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="c1"># run trajectory</span>
<span class="c1"># must include for generic inputs, will fix a = 0 and x = 1.0</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_r$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Flux&#39;</span><span class="p">]</span>
<span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xlab</span><span class="p">,</span> <span class="n">ylab</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_30_0.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_30_0.png" />
</div>
</div>
</section>
<section id="Defining-a-new-t-vector">
<h2>Defining a new t vector<a class="headerlink" href="#Defining-a-new-t-vector" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="c1"># a warning will be thrown if the new_t array goes beyond the time array output from the trajectory</span>
<span class="n">t1</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">Phi_phi1</span><span class="p">,</span> <span class="n">Phi_theta1</span><span class="p">,</span> <span class="n">Phi_r1</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">new_t</span><span class="o">=</span><span class="n">new_t</span><span class="p">,</span> <span class="n">upsample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># you can cut the excess on these arrays by setting fix_t to True</span>
<span class="n">t2</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">Phi_phi2</span><span class="p">,</span> <span class="n">Phi_theta2</span><span class="p">,</span> <span class="n">Phi_r2</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">new_t</span><span class="o">=</span><span class="n">new_t</span><span class="p">,</span> <span class="n">upsample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fix_t</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">Phi_phi1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Phi_\phi$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">Phi_r1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Phi_r$&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 max:&#39;</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;t2 max:&#39;</span><span class="p">,</span> <span class="n">t2</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mkatz/miniconda3/envs/few_env/lib/python3.9/site-packages/few-1.4.11-py3.9-macosx-10.9-x86_64.egg/few/utils/baseclasses.py:739: UserWarning: new_t array goes beyond generated t array. If you want to cut the t array at the end of the trajectory, set fix_t to True.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
t1 max: 999999.0 t2 max: 464363.0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_32_2.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_32_2.png" />
</div>
</div>
</section>
<section id="Defining-dt-and-T">
<h2>Defining dt and T<a class="headerlink" href="#Defining-dt-and-T" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.005</span> <span class="c1"># years</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">upsample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fix_t</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Phi_\phi$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Phi_r$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x141093ac0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_34_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_34_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
157785.0
</pre></div></div>
</div>
</section>
<section id="Getting-dimensionless-time-(t/M)">
<h2>Getting dimensionless time (<span class="math notranslate nohighlight">\(t/M\)</span>)<a class="headerlink" href="#Getting-dimensionless-time-(t/M)" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">in_coordinate_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Phi_\phi$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Phi_r$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dimensionless time step:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dimensionless time step: 20.30254435033953
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_37_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_37_1.png" />
</div>
</div>
</section>
<section id="Dense-Stepping">
<h2>Dense Stepping<a class="headerlink" href="#Dense-Stepping" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize trajectory class</span>
<span class="n">dense_traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;SchwarzEccFlux&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.005</span> <span class="c1"># years</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="c1"># make sure to increase the memory allocated for the trajectory with max_init_len</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">dense_traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">DENSE_STEPPING</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_init_len</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e7</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(10520,)
</pre></div></div>
</div>
</section>
</section>
<section id="Amplitude-Module">
<h1>Amplitude Module<a class="headerlink" href="#Amplitude-Module" title="Permalink to this heading"></a></h1>
<p>The amplitude module generates the complex mode amplitudes for each harmonic mode requested, <span class="math notranslate nohighlight">\(A_{lmkn}(t)\)</span> (<span class="math notranslate nohighlight">\(k=0\)</span> for equatorial orbits). With Schwarzschild eccentric amplitudes, the user provides <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(e\)</span> as arrays and is returned the requested Teukolsky modes in a 2D array of shape (trajectory length, number of modes).</p>
<section id="ROMAN-amplitude-generation">
<h2>ROMAN amplitude generation<a class="headerlink" href="#ROMAN-amplitude-generation" title="Permalink to this heading"></a></h2>
<p>ROMAN uses a reduced order model representing the mode amplitude space. It then trains a neural network on this reduced model. The neural network is evaluated and the resulting matrix is transformed from the reduced basis back to the full mode space.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize ROMAN class</span>
<span class="n">amp</span> <span class="o">=</span> <span class="n">RomanAmplitude</span><span class="p">(</span><span class="n">max_init_len</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>  <span class="c1"># max_init_len creates memory buffers</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>

<span class="n">p_all</span><span class="p">,</span> <span class="n">e_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">temp</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total trajectory points:&#39;</span><span class="p">,</span> <span class="n">p_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">teuk_modes</span> <span class="o">=</span> <span class="n">amp</span><span class="p">(</span><span class="n">p_all</span><span class="p">,</span> <span class="n">e_all</span><span class="p">)</span>

<span class="c1"># look at the contours of the (2,2,0) mode</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">teuk_modes</span><span class="p">[:,</span> <span class="n">amp</span><span class="o">.</span><span class="n">special_index_map</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total trajectory points: 2500
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;e&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_47_2.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_47_2.png" />
</div>
</div>
<p>Specific modes can be selected by providing a list of tuple of (l,m,n) values as the <code class="docutils literal notranslate"><span class="pre">specific_modes</span></code> kwarg:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (2, 2, 0) and (7, -3, 1) modes</span>
<span class="n">specific_modes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

<span class="c1"># notice this returns a dictionary with keys as the mode tuple and values as the mode values at all trajectory points</span>
<span class="n">specific_teuk_modes</span> <span class="o">=</span> <span class="n">amp</span><span class="p">(</span><span class="n">p_all</span><span class="p">,</span> <span class="n">e_all</span><span class="p">,</span> <span class="n">specific_modes</span><span class="o">=</span><span class="n">specific_modes</span><span class="p">)</span>

<span class="c1"># we can find the index to these modes to check</span>
<span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">amp</span><span class="o">.</span><span class="n">special_index_map</span><span class="p">[</span><span class="n">lmn</span><span class="p">]</span> <span class="k">for</span> <span class="n">lmn</span> <span class="ow">in</span> <span class="n">specific_modes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Indices of interest:&#39;</span><span class="p">,</span> <span class="n">inds</span><span class="p">)</span>

<span class="c1"># make sure they are the same</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">specific_teuk_modes</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">teuk_modes</span><span class="p">[:,</span> <span class="n">inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>

<span class="c1"># to check -m modes we need to take the conjugate</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">specific_teuk_modes</span><span class="p">[(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">teuk_modes</span><span class="p">[:,</span> <span class="n">inds</span><span class="p">[</span><span class="mi">1</span><span class="p">]])))</span>

<span class="c1"># look at the contours of the (220)mode</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">specific_teuk_modes</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Indices of interest: [ 640 1922]
True
True
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;e&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_49_2.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_49_2.png" />
</div>
</div>
</section>
<section id="Interpolate-modes-with-bicubic-spline">
<h2>Interpolate modes with bicubic spline<a class="headerlink" href="#Interpolate-modes-with-bicubic-spline" title="Permalink to this heading"></a></h2>
<p>For this amplitude generator, amplitudes are interpolated in 2D (<span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(e\)</span>) using bicubic splines. They are then evaluated for the desired modes. This is used to produce our slow waveform. This will also not scale well with dimensionality. <strong>Note</strong>: Specific modes can be selected in the same way as above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize class</span>
<span class="n">amp2</span> <span class="o">=</span> <span class="n">Interp2DAmplitude</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>

<span class="n">p_all</span><span class="p">,</span> <span class="n">e_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">temp</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total trajectory points:&#39;</span><span class="p">,</span> <span class="n">p_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># to get all modes we can simply do this</span>
<span class="n">teuk_modes</span> <span class="o">=</span> <span class="n">amp2</span><span class="p">(</span><span class="n">p_all</span><span class="p">,</span> <span class="n">e_all</span><span class="p">)</span>

<span class="c1"># look at the contours of the (220) mode</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">teuk_modes</span><span class="p">[:,</span> <span class="n">amp2</span><span class="o">.</span><span class="n">special_index_map</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total trajectory points: 2500
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;e&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_53_2.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_53_2.png" />
</div>
</div>
</section>
</section>
<section id="Spin-weighted-spherical-harmonics">
<h1>Spin-weighted spherical harmonics<a class="headerlink" href="#Spin-weighted-spherical-harmonics" title="Permalink to this heading"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">few</span> <span class="o">=</span> <span class="n">FastSchwarzschildEccentricFlux</span><span class="p">()</span>  <span class="c1"># get mode information</span>

<span class="n">ylm_gen</span> <span class="o">=</span> <span class="n">GetYlms</span><span class="p">(</span><span class="n">assume_positive_m</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">ms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># viewing angles</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ylm_gen</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 2.17261840e-17+3.54815511e-01j -1.28533838e-17-2.09911687e-01j
  1.24292687e-16-1.24292687e-16j -2.46692086e-01+2.46692086e-01j]
</pre></div></div>
</div>
<p>If we assume positive m, it will return -m entries for all +m. The last 5 below are for -m. The final shape will be twice the initial length and will duplicate m=0 so be careful.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ylm_gen</span> <span class="o">=</span> <span class="n">GetYlms</span><span class="p">(</span><span class="n">assume_positive_m</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">ms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># viewing angles</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>

<span class="n">ylms</span> <span class="o">=</span> <span class="n">ylm_gen</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>

<span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">ylm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">ylms</span><span class="p">[:</span><span class="mi">5</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">ylm</span><span class="p">)</span>

<span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">ylm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">ylms</span><span class="p">[</span><span class="mi">5</span><span class="p">:]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">,-</span><span class="si">{}</span><span class="s1">):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">ylm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2,2): (2.1726183986132194e-17+0.35481551090908514j)
(3,2): (-1.2853383784425917e-17-0.2099116870819398j)
(4,3): (1.242926870060164e-16-1.2429268700601641e-16j)
(5,3): (-0.24669208642519044+0.2466920864251905j)
(2,0): (0.2897056515173922+0j)
(2,-2): (2.4140204429035754e-18-0.039423945656564985j)
(3,-2): (-9.997076276775717e-18+0.16326464550817543j)
(4,-3): (-0.12119256904280647-0.12119256904280648j)
(5,-3): (0.2357279936951819+0.23572799369518194j)
(2,-0): (0.2897056515173922+0j)
</pre></div></div>
</div>
</section>
<section id="Mode-Selection">
<h1>Mode Selection<a class="headerlink" href="#Mode-Selection" title="Permalink to this heading"></a></h1>
<p>The mode selection module is paramount to the computational efficiency of this model. Below we show how we perform this selection operation by moving from a set of amplitudes to only those that contribute.</p>
<section id="Mode-selection-by-power-contribution">
<h2>Mode selection by power contribution<a class="headerlink" href="#Mode-selection-by-power-contribution" title="Permalink to this heading"></a></h2>
<p>Modes can also be weighted by a Power Spectral Density (PSD) function from your favorite sensitivity curve.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first, lets get amplitudes for a trajectory</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;SchwarzEccFlux&quot;</span><span class="p">)</span>

<span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span>

<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># get amplitudes along trajectory</span>
<span class="n">amp</span> <span class="o">=</span> <span class="n">RomanAmplitude</span><span class="p">()</span>

<span class="n">teuk_modes</span> <span class="o">=</span> <span class="n">amp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

<span class="c1"># get ylms</span>
<span class="n">ylms</span> <span class="o">=</span> <span class="n">ylm_gen</span><span class="p">(</span><span class="n">amp</span><span class="o">.</span><span class="n">unique_l</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">unique_m</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">amp</span><span class="o">.</span><span class="n">inverse_lm</span><span class="p">]</span>

<span class="c1"># select modes</span>

<span class="n">mode_selector</span> <span class="o">=</span> <span class="n">ModeSelector</span><span class="p">(</span><span class="n">amp</span><span class="o">.</span><span class="n">m0mask</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-5</span>  <span class="c1"># tolerance on mode contribution to total power</span>

<span class="n">modeinds</span> <span class="o">=</span> <span class="p">[</span><span class="n">amp</span><span class="o">.</span><span class="n">l_arr</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">m_arr</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">n_arr</span><span class="p">]</span>
<span class="p">(</span><span class="n">teuk_modes_in</span><span class="p">,</span> <span class="n">ylms_in</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">ns</span><span class="p">)</span> <span class="o">=</span> <span class="n">mode_selector</span><span class="p">(</span><span class="n">teuk_modes</span><span class="p">,</span> <span class="n">ylms</span><span class="p">,</span> <span class="n">modeinds</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We reduced the mode content from </span><span class="si">{}</span><span class="s2"> modes to </span><span class="si">{}</span><span class="s2"> modes.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">teuk_modes_in</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
We reduced the mode content from 3843 modes to 874 modes.
</pre></div></div>
</div>
</section>
<section id="Mode-selection-by-noise-weighted-power-contribution">
<h2>Mode selection by noise-weighted power contribution<a class="headerlink" href="#Mode-selection-by-noise-weighted-power-contribution" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># produce sensitivity function</span>

<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&quot;files/LPA.txt&quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">PSD</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">noise</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">noise</span><span class="p">[</span><span class="s2">&quot;ASD&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sens_fn</span> <span class="o">=</span> <span class="n">CubicSplineInterpolant</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">PSD</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># select modes with noise weighting</span>

<span class="c1"># provide sensitivity function kwarg</span>
<span class="n">mode_selector_noise_weighted</span> <span class="o">=</span> <span class="n">ModeSelector</span><span class="p">(</span><span class="n">amp</span><span class="o">.</span><span class="n">m0mask</span><span class="p">,</span> <span class="n">sensitivity_fn</span><span class="o">=</span><span class="n">sens_fn</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-5</span>  <span class="c1"># tolerance on mode contribution to total power</span>

<span class="c1"># Schwarzschild</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="c1"># equatorial / cos iota</span>
<span class="n">fund_freq_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">modeinds</span> <span class="o">=</span> <span class="p">[</span><span class="n">amp</span><span class="o">.</span><span class="n">l_arr</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">m_arr</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">n_arr</span><span class="p">]</span>
<span class="p">(</span><span class="n">teuk_modes_in</span><span class="p">,</span> <span class="n">ylms_in</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">ns</span><span class="p">)</span> <span class="o">=</span> <span class="n">mode_selector_noise_weighted</span><span class="p">(</span><span class="n">teuk_modes</span><span class="p">,</span> <span class="n">ylms</span><span class="p">,</span> <span class="n">modeinds</span><span class="p">,</span>
                                                                    <span class="n">fund_freq_args</span><span class="o">=</span><span class="n">fund_freq_args</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We reduced the mode content from </span><span class="si">{}</span><span class="s2"> modes to </span><span class="si">{}</span><span class="s2"> modes when using noise-weighting.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">teuk_modes_in</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mkatz/miniconda3/envs/few_env/lib/python3.9/site-packages/few-1.4.11-py3.9-macosx-10.9-x86_64.egg/few/summation/interpolatedmodesum.py:201: UserWarning: New t array outside bounds of input t array. These points are filled with edge values.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
We reduced the mode content from 3843 modes to 783 modes when using noise-weighting.
</pre></div></div>
</div>
</section>
<section id="Compare-the-two-waves-with-and-without-noise-weighting">
<h2>Compare the two waves with and without noise-weighting<a class="headerlink" href="#Compare-the-two-waves-with-and-without-noise-weighting" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mode_selector_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">noise_weighted_mode_selector_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sensitivity_fn</span><span class="o">=</span><span class="n">sens_fn</span><span class="p">)</span>

<span class="n">few_base</span> <span class="o">=</span> <span class="n">FastSchwarzschildEccentricFlux</span><span class="p">(</span>
    <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span>
    <span class="n">amplitude_kwargs</span><span class="o">=</span><span class="n">amplitude_kwargs</span><span class="p">,</span>
    <span class="n">Ylm_kwargs</span><span class="o">=</span><span class="n">Ylm_kwargs</span><span class="p">,</span>
    <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span>
    <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">few_noise_weighted</span> <span class="o">=</span> <span class="n">FastSchwarzschildEccentricFlux</span><span class="p">(</span>
    <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span>
    <span class="n">amplitude_kwargs</span><span class="o">=</span><span class="n">amplitude_kwargs</span><span class="p">,</span>
    <span class="n">Ylm_kwargs</span><span class="o">=</span><span class="n">Ylm_kwargs</span><span class="p">,</span>
    <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span>
    <span class="n">mode_selector_kwargs</span><span class="o">=</span><span class="n">noise_weighted_mode_selector_kwargs</span><span class="p">,</span>
    <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">4.</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="n">wave_base</span> <span class="o">=</span> <span class="n">few_base</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">wave_weighted</span> <span class="o">=</span> <span class="n">few_noise_weighted</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave_base</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave_weighted</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mismatch:&#39;</span><span class="p">,</span> <span class="n">get_mismatch</span><span class="p">(</span><span class="n">wave_base</span><span class="p">,</span> <span class="n">wave_weighted</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;base modes:&#39;</span><span class="p">,</span> <span class="n">few_base</span><span class="o">.</span><span class="n">num_modes_kept</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;noise-weighted modes:&#39;</span><span class="p">,</span> <span class="n">few_noise_weighted</span><span class="o">.</span><span class="n">num_modes_kept</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mismatch: 8.458387527277011e-06
base modes: 249
noise-weighted modes: 447
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_66_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_66_1.png" />
</div>
</div>
</section>
<section id="Specific-mode-selection">
<h2>Specific mode selection<a class="headerlink" href="#Specific-mode-selection" title="Permalink to this heading"></a></h2>
<p>The user can also select a specific set of modes to use in the waveform.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># l = 2, m = 2 wave</span>
<span class="n">specific_modes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">)]</span>

<span class="n">wave_22</span> <span class="o">=</span> <span class="n">few_base</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">mode_selection</span><span class="o">=</span><span class="n">specific_modes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave_22</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mismatch with full wave:&#39;</span><span class="p">,</span> <span class="n">get_mismatch</span><span class="p">(</span><span class="n">wave_22</span><span class="p">,</span> <span class="n">wave_base</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mismatch with full wave: 0.04836198716639939
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_69_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_69_1.png" />
</div>
</div>
</section>
<section id="Turn-off-(-m)">
<h2>Turn off (<span class="math notranslate nohighlight">\(-m\)</span>)<a class="headerlink" href="#Turn-off-(-m)" title="Permalink to this heading"></a></h2>
<p>By default, symmetry is used to generate <span class="math notranslate nohighlight">\(-m\)</span> modes. To turn this off and only use modes with (<span class="math notranslate nohighlight">\(m\)</span>), provide <code class="docutils literal notranslate"><span class="pre">False</span></code> to the <code class="docutils literal notranslate"><span class="pre">include_minus_m</span></code> kwarg. This only affects the waveform when <code class="docutils literal notranslate"><span class="pre">mode_selection</span></code> is a list of specific modes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># l = 2, m = 2 wave without m = -2</span>
<span class="n">specific_modes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">)]</span>

<span class="n">specific_modes_minus_m</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">)]</span>

<span class="n">wave_22_pos_m</span> <span class="o">=</span> <span class="n">few_base</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span>
                   <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                   <span class="n">mode_selection</span><span class="o">=</span><span class="n">specific_modes</span><span class="p">,</span> <span class="n">include_minus_m</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">wave_22_minus_m</span> <span class="o">=</span> <span class="n">few_base</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span>
                   <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                   <span class="n">mode_selection</span><span class="o">=</span><span class="n">specific_modes_minus_m</span><span class="p">,</span> <span class="n">include_minus_m</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave_22_pos_m</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;+m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave_22_minus_m</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mismatch with 22 wave with + and - m:&#39;</span><span class="p">,</span> <span class="n">get_mismatch</span><span class="p">(</span><span class="n">wave_22_minus_m</span><span class="p">,</span> <span class="n">wave_22_pos_m</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mismatch with 22 original wave with adding + and - m&#39;</span><span class="p">,</span> <span class="n">get_mismatch</span><span class="p">(</span><span class="n">wave_22</span><span class="p">,</span> <span class="n">wave_22_pos_m</span> <span class="o">+</span> <span class="n">wave_22_minus_m</span><span class="p">))</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mismatch with 22 wave with + and - m: 0.9986497050904085
mismatch with 22 original wave with adding + and - m 0.0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_72_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_72_1.png" />
</div>
</div>
</section>
</section>
<section id="Parallelized-Cubic-Spline-Interpolation">
<h1>Parallelized Cubic Spline Interpolation<a class="headerlink" href="#Parallelized-Cubic-Spline-Interpolation" title="Permalink to this heading"></a></h1>
<p>A part of the Fast EMRI waveforms package is parallelized cubic spline interpolation. This generally means fitting and evaluating many splines in parallel with the same input x array. This is available for GPUs and CPUs (OMP). The user can perform this operation entirely in Python while leveraging <a class="reference external" href="https://cupy.dev/">CuPy</a> for GPUs. However, the evaluation will not be as efficient as when it is implemented properly in a customized kernel. The spline class
(<a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html?highlight=modeselector#few.summation.interpolatedmodesum.CubicSplineInterpolant">CubicSplineInterpolant</a>) can provide an 1D flattened array of all spline coefficients for use in a custom CUDA kernel.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s take the amplitudes from the last step and spline those.</span>
<span class="c1"># We have to arange everything in the shape (ninterps, length)</span>
<span class="c1"># We will split real and imaginary components</span>

<span class="n">interp_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">interp_in</span><span class="p">[:</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">real</span>
<span class="n">interp_in</span><span class="p">[</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">imag</span>

<span class="n">spline</span> <span class="o">=</span> <span class="n">CubicSplineInterpolant</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">interp_in</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get new values</span>
<span class="n">t_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># notice the new shape is (ninterps, length) just like the inital input to the spline</span>
<span class="n">new_teuk_modes</span> <span class="o">=</span> <span class="n">spline</span><span class="p">(</span><span class="n">t_new</span><span class="p">)</span>

<span class="c1"># (220) mode (real part)</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">amp</span><span class="o">.</span><span class="n">special_index_map</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_new</span><span class="p">,</span> <span class="n">new_teuk_modes</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">teuk_modes</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x1425c50d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_76_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_76_1.png" />
</div>
</div>
<p>To get the array of interp coefficients for CUDA implementations, do the following. The underlying shape of the array is (4, length, ninterps). It is flattened though for entry into GPU kernel.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spline</span><span class="o">.</span><span class="n">interp_array</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 6.23856751e-06,  3.56609646e-06, -1.26237401e-06, ...,
        0.00000000e+00,  0.00000000e+00,  0.00000000e+00])
</pre></div></div>
</div>
</section>
<section id="Mode-Summation">
<h1>Mode Summation<a class="headerlink" href="#Mode-Summation" title="Permalink to this heading"></a></h1>
<p>Mode summation is the bottleneck of this calculation. We handle this in two ways: interpolation for fast waveforms and direct summation for slow waveforms. They both have the same interface and produce the same product. They take Teukolsky modes and phases and combine that information to create the waveform.</p>
<section id="Interpolated-summation">
<h2>Interpolated summation<a class="headerlink" href="#Interpolated-summation" title="Permalink to this heading"></a></h2>
<p>To maximize efficiency we use the cubic spline discussed above to accelerate the computation with interpolation and parallelized summation (on the GPU or OpenMP). This class is <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/user/sum.html?highlight=interpolated%20mode%20sum#few.summation.interpolatedmodesum.InterpolatedModeSum">InterpolatedModeSum</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">5.</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">Tsec</span> <span class="o">=</span> <span class="n">T</span> <span class="o">*</span> <span class="n">YRSID_SI</span>

<span class="n">traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;SchwarzEccFlux&quot;</span><span class="p">)</span>
<span class="n">amp</span> <span class="o">=</span> <span class="n">RomanAmplitude</span><span class="p">()</span>
<span class="n">interpolate_mode_sum</span> <span class="o">=</span> <span class="n">InterpolatedModeSum</span><span class="p">()</span>
<span class="n">ylm_gen</span> <span class="o">=</span> <span class="n">GetYlms</span><span class="p">(</span><span class="n">assume_positive_m</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># very simplified waveform example</span>

<span class="c1"># get trajectory</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">)</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>

<span class="n">ylms</span> <span class="o">=</span> <span class="n">ylm_gen</span><span class="p">(</span><span class="n">amp</span><span class="o">.</span><span class="n">unique_l</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">unique_m</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span>
    <span class="n">amp</span><span class="o">.</span><span class="n">inverse_lm</span>
<span class="p">]</span>

<span class="c1"># amplitudes</span>
<span class="n">teuk_modes</span> <span class="o">=</span> <span class="n">amp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">l_arr</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">m_arr</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">n_arr</span><span class="p">)</span>

<span class="c1"># need to prepare arrays for sum with all modes due to +/- m setup</span>
<span class="n">ls</span> <span class="o">=</span> <span class="n">amp</span><span class="o">.</span><span class="n">l_arr</span><span class="p">[:</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">ms</span> <span class="o">=</span> <span class="n">amp</span><span class="o">.</span><span class="n">m_arr</span><span class="p">[:</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">ns</span> <span class="o">=</span> <span class="n">amp</span><span class="o">.</span><span class="n">n_arr</span><span class="p">[:</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">keep_modes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">temp2</span> <span class="o">=</span> <span class="n">keep_modes</span> <span class="o">*</span> <span class="p">(</span><span class="n">keep_modes</span> <span class="o">&lt;</span> <span class="n">amp</span><span class="o">.</span><span class="n">num_m0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
    <span class="n">keep_modes</span> <span class="o">+</span> <span class="n">amp</span><span class="o">.</span><span class="n">num_m_1_up</span>
<span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">keep_modes</span> <span class="o">&gt;=</span> <span class="n">amp</span><span class="o">.</span><span class="n">num_m0</span><span class="p">)</span>

<span class="n">ylmkeep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">keep_modes</span><span class="p">,</span> <span class="n">temp2</span><span class="p">])</span>
<span class="n">ylms_in</span> <span class="o">=</span> <span class="n">ylms</span><span class="p">[</span><span class="n">ylmkeep</span><span class="p">]</span>
<span class="n">teuk_modes_in</span> <span class="o">=</span> <span class="n">teuk_modes</span>

<span class="c1"># summation</span>
<span class="n">waveform1</span> <span class="o">=</span> <span class="n">interpolate_mode_sum</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">teuk_modes_in</span><span class="p">,</span> <span class="n">ylms_in</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">m_arr</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">n_arr</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">waveform1</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">400</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">waveform1</span><span class="o">.</span><span class="n">imag</span><span class="p">[:</span><span class="mi">400</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x142859c70&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_82_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_82_1.png" />
</div>
</div>
</section>
<section id="Direct-summation">
<h2>Direct summation<a class="headerlink" href="#Direct-summation" title="Permalink to this heading"></a></h2>
<p>For the direct mode summation, <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/user/sum.html?highlight=interpolated%20mode%20sum#few.summation.directmodesum.DirectModeSum">DirectModeSum</a>, we are summing up all modes at each time step directly. So, no interpolation. However, in this example, we will use interpolation up front because we need amplitude and phase arrays at all time steps for the direct mode sum because the direct mode sum will not fill in time steps like the interpolated
mode sum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interp_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">interp_in</span><span class="p">[:</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">real</span>
<span class="n">interp_in</span><span class="p">[</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">imag</span>

<span class="n">spline</span> <span class="o">=</span> <span class="n">CubicSplineInterpolant</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">interp_in</span><span class="p">)</span>

<span class="c1"># get new valu`es</span>
<span class="n">t_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">interp_in2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">interp_in2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phi_phi</span>
<span class="n">interp_in2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phi_r</span>

<span class="n">spline2</span> <span class="o">=</span> <span class="n">CubicSplineInterpolant</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">interp_in2</span><span class="p">)</span>

<span class="n">Phi_phi_in</span><span class="p">,</span> <span class="n">Phi_r_in</span> <span class="o">=</span> <span class="n">spline2</span><span class="p">(</span><span class="n">t_new</span><span class="p">)</span>

<span class="c1"># notice the new shape is (ninterps, length) just like the inital input to the spline</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">spline</span><span class="p">(</span><span class="n">t_new</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>


<span class="n">teuk_modes_in</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[:,</span> <span class="p">:</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">temp</span><span class="p">[:,</span> <span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span>

<span class="n">direct_mode_sum</span> <span class="o">=</span> <span class="n">DirectModeSum</span><span class="p">()</span>

<span class="n">waveform2</span> <span class="o">=</span> <span class="n">direct_mode_sum</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">teuk_modes_in</span><span class="p">,</span> <span class="n">ylms_in</span><span class="p">,</span> <span class="n">Phi_phi_in</span><span class="p">,</span> <span class="n">Phi_r_in</span><span class="p">,</span> <span class="n">amp</span><span class="o">.</span><span class="n">m_arr</span><span class="p">[:</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">amp</span><span class="o">.</span><span class="n">n_arr</span><span class="p">[:</span><span class="n">teuk_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_new</span><span class="p">,</span> <span class="n">waveform1</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_new</span><span class="p">,</span> <span class="n">waveform2</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mismatch:&#39;</span><span class="p">,</span> <span class="n">get_mismatch</span><span class="p">(</span><span class="n">waveform1</span><span class="p">,</span> <span class="n">waveform2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mismatch: 0.0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_84_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_84_1.png" />
</div>
</div>
</section>
</section>
<section id="Utility-functions">
<h1>Utility functions<a class="headerlink" href="#Utility-functions" title="Permalink to this heading"></a></h1>
<section id="Get-options-for-installed-ODE-functions">
<h2>Get options for installed ODE functions<a class="headerlink" href="#Get-options-for-installed-ODE-functions" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">few.utils.utility</span> <span class="kn">import</span> <span class="n">get_ode_function_options</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">get_ode_function_options</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Options:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Info:&quot;</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Options: [&#39;pn5&#39;, &#39;SchwarzEccFlux&#39;]
Info: {&#39;pn5&#39;: {&#39;type&#39;: &#39;func&#39;, &#39;files&#39;: [], &#39;citations&#39;: [&#39;Pn5_citation&#39;], &#39;convert_Y&#39;: True, &#39;num_add_args&#39;: 0, &#39;background&#39;: &#39;Kerr&#39;, &#39;equatorial&#39;: False, &#39;circular&#39;: False}, &#39;SchwarzEccFlux&#39;: {&#39;type&#39;: &#39;class&#39;, &#39;files&#39;: [&#39;FluxNewMinusPNScaled_fixed_y_order.dat&#39;], &#39;citations&#39;: [], &#39;num_add_args&#39;: 0, &#39;background&#39;: &#39;Schwarzschild&#39;, &#39;equatorial&#39;: True, &#39;circular&#39;: False, &#39;convert_Y&#39;: False}}
</pre></div></div>
</div>
</section>
<section id="Fundamental-Frequencies">
<h2>Fundamental Frequencies<a class="headerlink" href="#Fundamental-Frequencies" title="Permalink to this heading"></a></h2>
<p>Get dimensionless fundamental frequencies from <a class="reference external" href="https://arxiv.org/abs/gr-qc/0202090">Schmidt 2002</a>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>

<span class="n">OmegaPhi</span><span class="p">,</span> <span class="n">OmegaTheta</span><span class="p">,</span> <span class="n">OmegaR</span> <span class="o">=</span> <span class="n">get_fundamental_frequencies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">OmegaPhi</span><span class="p">,</span> <span class="n">OmegaTheta</span><span class="p">,</span> <span class="n">OmegaR</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p</span><span class="se">\t\t</span><span class="s1">e</span><span class="se">\t\t</span><span class="s1">x</span><span class="se">\t</span><span class="s1">OmegaPhi</span><span class="se">\t</span><span class="s1">OmegaTheta</span><span class="se">\t</span><span class="s1">OmegaR&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
p               e               x       OmegaPhi        OmegaTheta      OmegaR
[[ 8.          0.2         0.3         0.04344785  0.04162395  0.02349858]
 [ 8.22222222  0.22222222  0.31111111  0.0412017   0.03953685  0.02299122]
 [ 8.44444444  0.24444444  0.32222222  0.03905666  0.03753599  0.02241441]
 [ 8.66666667  0.26666667  0.33333333  0.03700405  0.03561442  0.02178189]
 [ 8.88888889  0.28888889  0.34444444  0.03503633  0.03376608  0.02110469]
 [ 9.11111111  0.31111111  0.35555556  0.0331469   0.03198567  0.02039181]
 [ 9.33333333  0.33333333  0.36666667  0.03133003  0.03026855  0.01965064]
 [ 9.55555556  0.35555556  0.37777778  0.02958068  0.02861065  0.01888732]
 [ 9.77777778  0.37777778  0.38888889  0.02789444  0.02700838  0.01810703]
 [10.          0.4         0.4         0.02626744  0.02545863  0.01731413]]
</pre></div></div>
</div>
</section>
<section id="Separatrix-in-Generic-Kerr">
<h2>Separatrix in Generic Kerr<a class="headerlink" href="#Separatrix-in-Generic-Kerr" title="Permalink to this heading"></a></h2>
<p>Get the separatrix in generic Kerr from <a class="reference external" href="https://arxiv.org/abs/1912.07609">Stein &amp; Warburton 2020</a>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>

<span class="n">p_sep</span> <span class="o">=</span> <span class="n">get_separatrix</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">p_sep</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e</span><span class="se">\t\t</span><span class="s1">x</span><span class="se">\t</span><span class="s1">separatrix&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
e               x       separatrix
[[0.2        0.3        5.69505166]
 [0.22222222 0.31111111 5.71503602]
 [0.24444444 0.32222222 5.73483554]
 [0.26666667 0.33333333 5.75445883]
 [0.28888889 0.34444444 5.77391509]
 [0.31111111 0.35555556 5.79321249]
 [0.33333333 0.36666667 5.81235943]
 [0.35555556 0.37777778 5.83136416]
 [0.37777778 0.38888889 5.85023483]
 [0.4        0.4        5.86897945]]
</pre></div></div>
</div>
</section>
<section id="Get-Kerr-Constants-of-Motion-(E,-L,-Q)">
<h2>Get Kerr Constants of Motion <span class="math notranslate nohighlight">\((E, L, Q)\)</span><a class="headerlink" href="#Get-Kerr-Constants-of-Motion-(E,-L,-Q)" title="Permalink to this heading"></a></h2>
<p>Get the three constants of motion <span class="math notranslate nohighlight">\((E,L,Q)\)</span> in generic Kerr spacetime.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>

<span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">get_kerr_geo_constants_of_motion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Q</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p</span><span class="se">\t\t</span><span class="s1">e</span><span class="se">\t\t</span><span class="s1">x</span><span class="se">\t</span><span class="s1">E</span><span class="se">\t</span><span class="s1">L</span><span class="se">\t</span><span class="s1">Q&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
p               e               x       E       L       Q
[[ 8.          0.2         0.3         0.94869805  1.0488073  11.14493312]
 [ 8.22222222  0.22222222  0.31111111  0.95009671  1.09509066 11.21268793]
 [ 8.44444444  0.24444444  0.32222222  0.95151386  1.1421481  11.28086888]
 [ 8.66666667  0.26666667  0.33333333  0.95294475  1.1899692  11.34863504]
 [ 8.88888889  0.28888889  0.34444444  0.95438558  1.23854433 11.4152404 ]
 [ 9.11111111  0.31111111  0.35555556  0.95583338  1.28786454 11.48001664]
 [ 9.33333333  0.33333333  0.36666667  0.95728578  1.33792152 11.54235943]
 [ 9.55555556  0.35555556  0.37777778  0.95874089  1.38870748 11.60171749]
 [ 9.77777778  0.37777778  0.38888889  0.96019724  1.44021512 11.65758381]
 [10.          0.4         0.4         0.96165365  1.49243756 11.70948848]]
</pre></div></div>
</div>
</section>
<section id="Convert-from-x_I-to-Y">
<h2>Convert from <span class="math notranslate nohighlight">\(x_I\)</span> to <span class="math notranslate nohighlight">\(Y\)</span><a class="headerlink" href="#Convert-from-x_I-to-Y" title="Permalink to this heading"></a></h2>
<p><span class="math notranslate nohighlight">\(Y\equiv\cos{\iota}=L/\sqrt{L^2 + Q}\)</span> is different than <span class="math notranslate nohighlight">\(x_I\equiv \cos{I}\)</span>, which is accepted for relativistic waveforms and in the generic waveform interface discussed above. <span class="math notranslate nohighlight">\(I\)</span> is the inclination angle of the orbital plane to the to equatorial plane.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">xI_to_Y</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;To Y:</span><span class="se">\n</span><span class="s1">p</span><span class="se">\t\t</span><span class="s1">e</span><span class="se">\t\t</span><span class="s1">x</span><span class="se">\t</span><span class="s1">Y&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

<span class="n">x_new</span> <span class="o">=</span> <span class="n">Y_to_xI</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x_new</span><span class="p">,</span> <span class="n">Y</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;To x:</span><span class="se">\n</span><span class="s1">p</span><span class="se">\t\t</span><span class="s1">e</span><span class="se">\t\t</span><span class="s1">x</span><span class="se">\t</span><span class="s1">Y&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
To Y:
p               e               x       Y
[[ 8.          0.2         0.3         0.29972126]
 [ 8.22222222  0.22222222  0.31111111  0.31083559]
 [ 8.44444444  0.24444444  0.32222222  0.32195073]
 [ 8.66666667  0.26666667  0.33333333  0.33306659]
 [ 8.88888889  0.28888889  0.34444444  0.3441831 ]
 [ 9.11111111  0.31111111  0.35555556  0.3553002 ]
 [ 9.33333333  0.33333333  0.36666667  0.36641781]
 [ 9.55555556  0.35555556  0.37777778  0.3775359 ]
 [ 9.77777778  0.37777778  0.38888889  0.38865439]
 [10.          0.4         0.4         0.39977325]]
To x:
p               e               x       Y
[[ 8.          0.2         0.3         0.29972126]
 [ 8.22222222  0.22222222  0.31111111  0.31083559]
 [ 8.44444444  0.24444444  0.32222222  0.32195073]
 [ 8.66666667  0.26666667  0.33333333  0.33306659]
 [ 8.88888889  0.28888889  0.34444444  0.3441831 ]
 [ 9.11111111  0.31111111  0.35555556  0.3553002 ]
 [ 9.33333333  0.33333333  0.36666667  0.36641781]
 [ 9.55555556  0.35555556  0.37777778  0.3775359 ]
 [ 9.77777778  0.37777778  0.38888889  0.38865439]
 [10.          0.4         0.4         0.39977325]]
</pre></div></div>
</div>
</section>
<section id="Get-\mu-based-on-desired-duration-of-waveform">
<h2>Get <span class="math notranslate nohighlight">\(\mu\)</span> based on desired duration of waveform<a class="headerlink" href="#Get-\mu-based-on-desired-duration-of-waveform" title="Permalink to this heading"></a></h2>
<p>If you have a desired length of waveform to analyze, this function will give you the value of <span class="math notranslate nohighlight">\(\mu\)</span> that corresponds to the proper evolution time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_module</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;SchwarzEccFlux&quot;</span><span class="p">)</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">11.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="n">traj_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">traj_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">index_of_mu</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t_out</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="c1"># run trajectory</span>
<span class="n">mu_new</span> <span class="o">=</span> <span class="n">get_mu_at_t</span><span class="p">(</span>
    <span class="n">traj_module</span><span class="p">,</span>
    <span class="n">t_out</span><span class="p">,</span>
    <span class="n">traj_args</span><span class="p">,</span>
    <span class="n">index_of_mu</span><span class="o">=</span><span class="n">index_of_mu</span><span class="p">,</span>
    <span class="n">traj_kwargs</span><span class="o">=</span><span class="n">traj_kwargs</span><span class="p">,</span>
    <span class="n">xtol</span><span class="o">=</span><span class="mf">2e-12</span><span class="p">,</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">8.881784197001252e-16</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mu = </span><span class="si">{}</span><span class="s1"> will create a waveform that is </span><span class="si">{}</span><span class="s1"> years long, given the other input parameters.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mu_new</span><span class="p">,</span> <span class="n">t_out</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mu = 18.804088097128368 will create a waveform that is 1.5 years long, given the other input parameters.
</pre></div></div>
</div>
</section>
<section id="Get-p_0-based-on-desired-duration-of-waveform">
<h2>Get <span class="math notranslate nohighlight">\(p_0\)</span> based on desired duration of waveform<a class="headerlink" href="#Get-p_0-based-on-desired-duration-of-waveform" title="Permalink to this heading"></a></h2>
<p>If you have a desired length of waveform to analyze, this function will give you the value of <span class="math notranslate nohighlight">\(p_0\)</span> that corresponds to the proper evolution time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj_module</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;SchwarzEccFlux&quot;</span><span class="p">)</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">5e1</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>

<span class="n">traj_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">traj_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">index_of_p</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t_out</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="c1"># run trajectory</span>
<span class="n">p_new</span> <span class="o">=</span> <span class="n">get_p_at_t</span><span class="p">(</span>
    <span class="n">traj_module</span><span class="p">,</span>
    <span class="n">t_out</span><span class="p">,</span>
    <span class="n">traj_args</span><span class="p">,</span>
    <span class="n">index_of_p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">index_of_a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">index_of_e</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">index_of_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">traj_kwargs</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">xtol</span><span class="o">=</span><span class="mf">2e-12</span><span class="p">,</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">8.881784197001252e-16</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p0 = </span><span class="si">{}</span><span class="s1"> will create a waveform that is </span><span class="si">{}</span><span class="s1"> years long, given the other input parameters.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_new</span><span class="p">,</span> <span class="n">t_out</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
p0 = 13.059790165171117 will create a waveform that is 1.5 years long, given the other input parameters.
</pre></div></div>
</div>
</section>
<section id="Set/get-omp_num_threads">
<h2>Set/get <code class="docutils literal notranslate"><span class="pre">omp_num_threads</span></code><a class="headerlink" href="#Set/get-omp_num_threads" title="Permalink to this heading"></a></h2>
<p>THE FOLLOWING THREAD COMMANDS DO NOT WORK ON THE M1 CHIP, BUT CAN BE USED WITH OLDER MODELS EVENTUALLY WE WILL PROBABLY REMOVE OMP WHICH NOW PARALLELIZES WITHIN ONE WAVEFORM AND LEAVE IT TO THE USER TO PARALLELIZE FOR MANY WAVEFORMS ON THEIR OWN.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from few.utils.utility import omp_get_num_threads, omp_set_num_threads</span>

<span class="c1"># omp_set_num_threads(3)</span>
<span class="c1"># omp_get_num_threads()</span>
</pre></div>
</div>
</div>
</section>
<section id="Change-CUDA-device">
<h2>Change CUDA device<a class="headerlink" href="#Change-CUDA-device" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">few.utils.utility</span> <span class="kn">import</span> <span class="n">cuda_set_device</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Creating-modules">
<h1>Creating modules<a class="headerlink" href="#Creating-modules" title="Permalink to this heading"></a></h1>
<p>In addition to using our built-in modules and waveforms, you can easily create your own module or waveform. Below is an example of creating your own trajectory module and using it in a custom waveform. If you can get a reasonably fast trajectory from your specific brand of EMRI physics, you can be generating waveforms in no time! Please see the <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/">documentation</a> on this for more details on the constructions behind this.</p>
<p><strong>Important Note</strong>: If you do use this package to examine EMRI analysis problems, please contact the authors of this code (see docs) about possible collaboration and/or contribution.</p>
<section id="Post-Newtonian-trajectory">
<h2>Post-Newtonian trajectory<a class="headerlink" href="#Post-Newtonian-trajectory" title="Permalink to this heading"></a></h2>
<p>The example will be to implement a Post-Newtonian trajectory in a Schwarzschild eccentric waveform. This will be done purely in Python. However, most of our modules have backends in C/C++/CUDA for maximum efficiency. If you have a trajectory in python and want to see if it can be ported for speed, please contact the authors.</p>
<p>To get started, we will import an integrator (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.DOP853.html#scipy.integrate.DOP853">DOP853</a>) and a library for elliptical integrals that mirrors the mathematica format <code class="docutils literal notranslate"><span class="pre">mpmath</span></code>. You can run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pip install mpmath
</pre></div>
</div>
<p>in your conda environment to attain that library.</p>
<p>We will also import necessary things from our package. This includes constants from <code class="docutils literal notranslate"><span class="pre">few.utils.constants</span></code>, as well as two base classes to be inherited by the new module.</p>
<p>The first base class is <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/user/main.html#few.utils.baseclasses.SchwarzschildEccentric">SchwarzschildEccentric</a> base class that passes information specific to any Schwarzschild eccentric waveform (number of modes, (l,m,n) sets, etc.). It also has methods for general sanity checks in these limits for input parameters, trajectories, and other things. You can see the documentation for more detail on its properties.</p>
<p>The other base class is <a class="reference external" href="file:///Users/michaelkatz/Research/FastEMRIWaveforms/docs/html/user/traj.html#few.utils.baseclasses.TrajectoryBase">TrajectoryBase</a>. This houses both information for trajectory modules, as well as the interface that should be common to all trajectory modules (i.e. <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/user/traj.html?highlight=trajectorybase#few.utils.baseclasses.TrajectoryBase.__call__">call</a> function). It allows for flexible parameter calling
interfaces, but ensures the strict interface will be the same for all trajectory modules. Trajectory modules must implement the method <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/user/traj.html?highlight=trajectorybase#few.utils.baseclasses.TrajectoryBase.get_inspiral">get_inspial</a>. The common interface uses this to generate the specific trajectory.</p>
<p>This is a common theme amongst module and waveform creation. The user will take one parent abstract base class related to the waveform limits, domain of validity, and its waveform properties, and one parent abstract based class for the module type (like trajectory or summation).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we need to import an integrator and elliptic integrals</span>
<span class="kn">from</span> <span class="nn">mpmath</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">DOP853</span>

<span class="c1"># base classes</span>
<span class="kn">from</span> <span class="nn">few.utils.baseclasses</span> <span class="kn">import</span> <span class="n">TrajectoryBase</span>
<span class="kn">from</span> <span class="nn">few.utils.baseclasses</span> <span class="kn">import</span> <span class="n">SchwarzschildEccentric</span>

<span class="c1"># settings for elliptic integrals</span>
<span class="n">mp</span><span class="o">.</span><span class="n">dps</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">mp</span><span class="o">.</span><span class="n">pretty</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># constants from our package</span>
<span class="kn">from</span> <span class="nn">few.utils.constants</span> <span class="kn">import</span> <span class="n">MTSUN_SI</span><span class="p">,</span> <span class="n">YRSID_SI</span><span class="p">,</span> <span class="n">Pi</span>

<span class="c1"># for common interface with C/mathematica</span>
<span class="k">def</span> <span class="nf">Power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="n">n</span>

<span class="k">def</span> <span class="nf">Sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># this is class object just to hold epsilon as it steps</span>
<span class="c1"># this class is instantiated and then run like the derivative function in the integrator (ex. dydt)</span>
<span class="k">class</span> <span class="nc">PN</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

        <span class="c1"># mass ratio</span>
        <span class="n">epsilon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span>

        <span class="c1"># extract the four evolving parameters</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">y</span>

        <span class="c1"># guard against bad integration steps</span>
        <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="mf">1e-2</span> <span class="ow">or</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">6.0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span> <span class="n">e</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>


        <span class="c1"># perform elliptic calculations</span>
        <span class="n">EllipE</span> <span class="o">=</span> <span class="n">ellipe</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">))</span>
        <span class="n">EllipK</span> <span class="o">=</span> <span class="n">ellipk</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">))</span>
        <span class="n">EllipPi1</span> <span class="o">=</span> <span class="n">ellippi</span><span class="p">(</span><span class="mi">16</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="mf">12.0</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">p</span><span class="o">*</span><span class="n">p</span><span class="p">),</span> <span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">))</span>
        <span class="n">EllipPi2</span> <span class="o">=</span> <span class="n">ellippi</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mf">1.0</span><span class="o">+</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">)),</span> <span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">6.0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">))</span>

        <span class="c1"># Azimuthal frequency</span>
        <span class="n">Omega_phi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">1.5</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">Sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">EllipPi2</span><span class="o">*</span><span class="p">(</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">EllipE</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
              <span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">28</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">EllipK</span> <span class="o">+</span> <span class="n">EllipPi2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">EllipPi1</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span>
            <span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))))</span>

        <span class="c1"># Post-Newtonian calculations</span>
        <span class="n">yPN</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">Omega_phi</span><span class="p">,</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>

        <span class="n">EdotPN</span> <span class="o">=</span> <span class="p">(</span><span class="mi">96</span> <span class="o">+</span> <span class="mi">292</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">37</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">15.</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mf">3.5</span><span class="p">))</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">yPN</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">LdotPN</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">yPN</span><span class="p">,</span> <span class="mf">7.</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>

        <span class="c1"># flux</span>
        <span class="n">Edot</span> <span class="o">=</span> <span class="o">-</span><span class="n">epsilon</span><span class="o">*</span><span class="p">(</span><span class="n">EdotPN</span><span class="p">)</span>
        <span class="n">Ldot</span> <span class="o">=</span> <span class="o">-</span><span class="n">epsilon</span><span class="o">*</span><span class="p">(</span><span class="n">LdotPN</span><span class="p">)</span>

        <span class="c1"># time derivatives</span>
        <span class="n">pdot</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Edot</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ldot</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

        <span class="n">edot</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">Edot</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">))</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span><span class="o">*</span>
        <span class="p">(</span><span class="mi">18</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">Ldot</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span>
        <span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">p</span><span class="p">))</span>

        <span class="n">Phi_phi_dot</span> <span class="o">=</span> <span class="n">Omega_phi</span><span class="p">;</span>

        <span class="n">Phi_r_dot</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">((</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="n">Pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">EllipK</span> <span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">EllipPi2</span><span class="o">*</span><span class="p">(</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">EllipE</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
        <span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">28</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">EllipK</span> <span class="o">+</span> <span class="n">EllipPi2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">EllipK</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">EllipPi1</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="n">Power</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

        <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">pdot</span><span class="p">,</span> <span class="n">edot</span><span class="p">,</span> <span class="n">Phi_phi_dot</span><span class="p">,</span> <span class="n">Phi_r_dot</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">dydt</span>


<span class="c1"># this is the actual class that implements a PN trajectory. It uses the PN class in the integrator.</span>
<span class="k">class</span> <span class="nc">PnTrajectory</span><span class="p">(</span><span class="n">TrajectoryBase</span><span class="p">):</span>

    <span class="c1"># for common interface with *args and **kwargs</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># required by the trajectory base class</span>
    <span class="k">def</span> <span class="nf">get_inspiral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># set up quantities and integrator</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

        <span class="n">T</span> <span class="o">=</span> <span class="n">T</span> <span class="o">*</span> <span class="n">YRSID_SI</span> <span class="o">/</span> <span class="p">(</span><span class="n">M</span> <span class="o">*</span> <span class="n">MTSUN_SI</span><span class="p">)</span>

        <span class="n">Msec</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">MTSUN_SI</span>

        <span class="n">epsilon</span> <span class="o">=</span> <span class="n">mu</span><span class="o">/</span><span class="n">M</span>
        <span class="n">integrator</span> <span class="o">=</span> <span class="n">DOP853</span><span class="p">(</span><span class="n">PN</span><span class="p">(</span><span class="n">epsilon</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

        <span class="n">t_out</span><span class="p">,</span> <span class="n">p_out</span><span class="p">,</span> <span class="n">e_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">Phi_phi_out</span><span class="p">,</span> <span class="n">Phi_r_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">t_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
        <span class="n">e_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e0</span><span class="p">)</span>
        <span class="n">Phi_phi_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">Phi_r_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># run the integrator down to T or separatrix</span>
        <span class="n">run</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">while</span> <span class="n">integrator</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span> <span class="ow">and</span> <span class="n">run</span><span class="p">:</span>
            <span class="n">integrator</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">integrator</span><span class="o">.</span><span class="n">y</span>
            <span class="n">t_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integrator</span><span class="o">.</span><span class="n">t</span> <span class="o">*</span> <span class="n">Msec</span><span class="p">)</span>
            <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="n">e_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">Phi_phi_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Phi_phi</span><span class="p">)</span>
            <span class="n">Phi_r_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Phi_r</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">run</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># read out data. It must return length 6 tuple</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">t_out</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">p_out</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">e_out</span><span class="p">)</span>
        <span class="n">Phi_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Phi_phi_out</span><span class="p">)</span>
        <span class="n">Phi_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Phi_r_out</span><span class="p">)</span>

        <span class="c1"># need to add polar info</span>
        <span class="n">Phi_theta</span> <span class="o">=</span> <span class="n">Phi_phi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># by construction</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Phi_theta</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Test-your-trajectory">
<h2>Test your trajectory<a class="headerlink" href="#Test-your-trajectory" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">traj</span> <span class="o">=</span> <span class="n">PnTrajectory</span><span class="p">()</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="n">traj2</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;SchwarzEccFlux&quot;</span><span class="p">)</span>

<span class="n">flux</span> <span class="o">=</span> <span class="n">traj2</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">flux</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">flux</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;flux&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pn&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;trajectory_pn_vs_flux.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_116_0.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_116_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">flux</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">flux</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;p&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_117_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_117_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">flux</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">flux</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;e&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_118_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_118_1.png" />
</div>
</div>
</section>
<section id="Implement-ODE-in-C/C++">
<h2>Implement ODE in C/C++<a class="headerlink" href="#Implement-ODE-in-C/C++" title="Permalink to this heading"></a></h2>
<p>If you want to implement a set of ODE equations in C/C++, you can add your function to <code class="docutils literal notranslate"><span class="pre">src/ode_base.cc</span></code>. You have to create the file if you have not already. Make sure it is in the <code class="docutils literal notranslate"><span class="pre">src/</span></code> directory. When you run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup</span> <span class="pre">install</span></code>, the installer will build a full file of ODEs and take care of all of the backend aspects to the integration. <strong>You only have to implement the ODE</strong>. You identify the ODE functions with <code class="docutils literal notranslate"><span class="pre">__deriv__</span></code> decorator. <code class="docutils literal notranslate"><span class="pre">#define</span></code> is then used to give extra
necessary information on the function. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">{waveform</span> <span class="pre">function</span> <span class="pre">name}_num_add_args</span> <span class="pre">{number</span> <span class="pre">of</span> <span class="pre">added</span> <span class="pre">args}</span></code>: Number of additional arguments beyond the required arguments.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">{waveform</span> <span class="pre">function</span> <span class="pre">name}_spinless</span></code>: Indicated Schwarzschild background.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">{waveform</span> <span class="pre">function</span> <span class="pre">name}_circular</span></code>: No eccentricity.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">{waveform</span> <span class="pre">function</span> <span class="pre">name}_equatorial</span></code>: Constrained to equatorial plane.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">{waveform</span> <span class="pre">function</span> <span class="pre">name}_Y</span></code>: Indicates the function is integrated in <span class="math notranslate nohighlight">\(Y\)</span> rather than <span class="math notranslate nohighlight">\(x_I\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">{waveform</span> <span class="pre">function</span> <span class="pre">name}_file{file</span> <span class="pre">number}</span> <span class="pre">{file</span> <span class="pre">name}</span></code>: File names required for proper use of function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">{waveform</span> <span class="pre">function</span> <span class="pre">name}_citation{citation</span> <span class="pre">number}</span> <span class="pre">{citation</span> <span class="pre">name}</span></code>: Citations for the function. <code class="docutils literal notranslate"><span class="pre">citation</span> <span class="pre">name</span></code> should be the name of the variable the citation is assigned to in <code class="docutils literal notranslate"><span class="pre">few.utils.citations</span></code>.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">__deriv__</span></code> function must be of the form:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void {functionname}(double* pdot, double* edot, double* Ydot,
                  double* Omega_phi, double* Omega_theta, double* Omega_r,
                  double epsilon, double a, double p, double e, double Y, double* additional_args)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">double*</span></code> args, except <code class="docutils literal notranslate"><span class="pre">additional_args</span></code>, represent pointers to doubles representing the output derivative values. <code class="docutils literal notranslate"><span class="pre">double</span></code> args are input values. <code class="docutils literal notranslate"><span class="pre">additional_args</span></code> is a pointer to a double array that holds any extra arguments to be included.</p>
<section id="Analytic-functions-that-do-not-need-storage">
<h3>Analytic functions that do not need storage<a class="headerlink" href="#Analytic-functions-that-do-not-need-storage" title="Permalink to this heading"></a></h3>
<p>If the ODE is purely analytic, a function will work. Here is an example with the 5PN trajectory (see<code class="docutils literal notranslate"><span class="pre">include/ode_base_example.cc</span></code>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define pn5_Y
#define pn5_citation1 pn5_citation
__deriv__
void pn5(double* pdot, double* edot, double* Ydot,
                  double* Omega_phi, double* Omega_theta, double* Omega_r,
                  double epsilon, double a, double p, double e, double Y, double* additional_args)
{
    // evaluate ODEs

    // the frequency variables are pointers!
    double x = Y_to_xI(a, p, e, Y);
    KerrGeoCoordinateFrequencies(Omega_phi, Omega_theta, Omega_r, a, p, e, x);

    int Nv = 10;
    int ne = 10;
    *pdot = epsilon * dpdt8H_5PNe10 (a, p, e, Y, Nv, ne);

    // needs adjustment for validity
    Nv = 10;
    ne = 8;
    *edot = epsilon * dedt8H_5PNe10 (a, p, e, Y, Nv, ne);

    Nv = 7;
    ne = 10;
    *Ydot = epsilon * dYdt8H_5PNe10 (a, p, e, Y, Nv, ne);

}
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">pn5_y</span></code> indicates the function integrates in <span class="math notranslate nohighlight">\(Y\)</span> rather than <span class="math notranslate nohighlight">\(x_I\)</span>.</p>
</section>
<section id="Functions-that-require-storage">
<h3>Functions that require storage<a class="headerlink" href="#Functions-that-require-storage" title="Permalink to this heading"></a></h3>
<p>If your function requires the storage of files or interpolants, you can also build your ODE as a class. In this case, it must have a constructor, destructor, and method called <code class="docutils literal notranslate"><span class="pre">deriv_func</span></code> with the ODEs.</p>
<p>Here is the implementation for the flux driven trajectory (see<code class="docutils literal notranslate"><span class="pre">include/ode_base_example.cc</span></code>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Class to carry gsl interpolants for the inspiral data
// also executes inspiral calculations
SchwarzEccFlux::SchwarzEccFlux(std::string few_dir)
{
    interps = new interp_params;

    // prepare the data
    // python will download the data if
    // the user does not have it in the correct place
    load_and_interpolate_flux_data(interps, few_dir);
    //load_and_interpolate_amp_vec_norm_data(&amp;amp_vec_norm_interp, few_dir);
}

#define SchwarzEccFlux_num_add_args 0
#define SchwarzEccFlux_spinless
#define SchwarzEccFlux_equatorial
#define SchwarzEccFlux_file1 FluxNewMinusPNScaled_fixed_y_order.dat
__deriv__
void SchwarzEccFlux::deriv_func(double* pdot, double* edot, double* xdot,
                  double* Omega_phi, double* Omega_theta, double* Omega_r,
                  double epsilon, double a, double p, double e, double x, double* additional_args)
{
    if ((6.0 + 2. * e) &gt; p)
    {
        *pdot = 0.0;
        *edot = 0.0;
        *xdot = 0.0;
        return;
    }

    SchwarzschildGeoCoordinateFrequencies(Omega_phi, Omega_r, p, e);
    *Omega_theta = *Omega_phi;

    double y1 = log((p -2.*e - 2.1));

    // evaluate ODEs, starting with PN contribution, then interpolating over remaining flux contribution

    double yPN = pow((*Omega_phi),2./3.);

    double EdotPN = (96 + 292*Power(e,2) + 37*Power(e,4))/(15.*Power(1 - Power(e,2),3.5)) * pow(yPN, 5);
    double LdotPN = (4*(8 + 7*Power(e,2)))/(5.*Power(-1 + Power(e,2),2)) * pow(yPN, 7./2.);

    double Edot = -epsilon*(interps-&gt;Edot-&gt;eval(y1, e)*pow(yPN,6.) + EdotPN);

    double Ldot = -epsilon*(interps-&gt;Ldot-&gt;eval(y1, e)*pow(yPN,9./2.) + LdotPN);

    *pdot = (-2*(Edot*Sqrt((4*Power(e,2) - Power(-2 + p,2))/(3 + Power(e,2) - p))*(3 + Power(e,2) - p)*Power(p,1.5) + Ldot*Power(-4 + p,2)*Sqrt(-3 - Power(e,2) + p)))/(4*Power(e,2) - Power(-6 + p,2));

    // handle e = 0.0
    if (e &gt; 0.)
    {
        *edot = -((Edot*Sqrt((4*Power(e,2) - Power(-2 + p,2))/(3 + Power(e,2) - p))*Power(p,1.5)*
                  (18 + 2*Power(e,4) - 3*Power(e,2)*(-4 + p) - 9*p + Power(p,2)) +
                 (-1 + Power(e,2))*Ldot*Sqrt(-3 - Power(e,2) + p)*(12 + 4*Power(e,2) - 8*p + Power(p,2)))/
                (e*(4*Power(e,2) - Power(-6 + p,2))*p));
    }
    else
    {
        *edot = 0.0;
    }

    *xdot = 0.0;
}

// When interfacing with cython, it helps to have  dealloc function to explicitly call
// rather than the deconstructor
SchwarzEccFlux::~SchwarzEccFlux()
{

    delete interps-&gt;Edot;
    delete interps-&gt;Ldot;
    delete interps;


}
</pre></div>
</div>
<p>In this case, where the functions are implemented in a class, you will have to add the class to the header file: <code class="docutils literal notranslate"><span class="pre">include/ode_base.hh</span></code>. You do not need to add anything to the header file if you are working with functions and not classes. You will need to create this file if you have not already. Make sure it is in the <code class="docutils literal notranslate"><span class="pre">include/</span></code> directory. Here is an example of what is placed in the header file when working with classes (see <code class="docutils literal notranslate"><span class="pre">include/ode_base_example.hh</span></code>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#include &quot;Interpolant.h&quot;

// Used to pass the interpolants to the ODE solver
struct interp_params{
    double epsilon;
    Interpolant *Edot;
    Interpolant *Ldot;
};

class SchwarzEccFlux{
public:
    interp_params *interps;
    Interpolant *amp_vec_norm_interp;
    double test;

    SchwarzEccFlux(std::string few_dir);

    void deriv_func(double* pdot, double* edot, double* Ydot,
                      double* Omega_phi, double* Omega_theta, double* Omega_r,
                      double epsilon, double a, double p, double e, double Y, double* additional_args);
    ~SchwarzEccFlux();
};
</pre></div>
</div>
</section>
</section>
<section id="Make-a-waveform-model">
<h2>Make a waveform model<a class="headerlink" href="#Make-a-waveform-model" title="Permalink to this heading"></a></h2>
<p>Now we will create a waveform with our new trajectory model. To do this, we will start with <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/user/main.html#few.waveform.SchwarzschildEccentricWaveformBase">SchwarzschildEccentricWaveformBase</a>. This base class has already inherited from <a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/user/main.html#few.utils.baseclasses.SchwarzschildEccentric">SchwarzschildEccentric</a>. It creates the common interface for all waveform modules (and how
they interface with there constituent modules). A requirement when creating a module is to have properties describing the GPU capability of the waveform, as well as whether or not it allows for batching the waveform creation (after trajectory).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FastSchwarzschildEccentricPn</span><span class="p">(</span><span class="n">SchwarzschildEccentricWaveformBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">amplitude_kwargs</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">sum_kwargs</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">Ylm_kwargs</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>

        <span class="n">SchwarzschildEccentricWaveformBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">PnTrajectory</span><span class="p">,</span>
            <span class="n">RomanAmplitude</span><span class="p">,</span>
            <span class="n">InterpolatedModeSum</span><span class="p">,</span>
            <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span>
            <span class="n">amplitude_kwargs</span><span class="o">=</span><span class="n">amplitude_kwargs</span><span class="p">,</span>
            <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span>
            <span class="n">Ylm_kwargs</span><span class="o">=</span><span class="n">Ylm_kwargs</span><span class="p">,</span>
            <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gpu_capability</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">allow_batching</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</section>
<section id="Test-your-waveform">
<h2>Test your waveform<a class="headerlink" href="#Test-your-waveform" title="Permalink to this heading"></a></h2>
<p>It will have the same interface as the other waveforms.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">FastSchwarzschildEccentricPn</span><span class="p">()</span>

<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">3.</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">4.</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">T</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>

<span class="n">wave1</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>

<span class="n">wave2</span> <span class="o">=</span> <span class="n">few</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># end of waveform is where we can see the difference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave1</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="o">-</span><span class="mi">6000</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pn&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave2</span><span class="o">.</span><span class="n">real</span><span class="p">[</span><span class="o">-</span><span class="mi">6000</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;flux&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mismatch:&#39;</span><span class="p">,</span> <span class="n">get_mismatch</span><span class="p">(</span><span class="n">wave1</span><span class="p">,</span> <span class="n">wave2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;pn_vs_flux.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mismatch: 0.9327087705171118
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_131_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_131_1.png" />
</div>
</div>
</section>
</section>
<section id="Augmented-Analytic-Kludge-with-5PN-trajectory">
<h1>Augmented Analytic Kludge with 5PN trajectory<a class="headerlink" href="#Augmented-Analytic-Kludge-with-5PN-trajectory" title="Permalink to this heading"></a></h1>
<p>We have now implemented a new version of the Augmented Analytic Kludge with 5PN trajectories.</p>
<p>Waveforms are generated based on the Augmented Analytic Kludge given in the <a class="reference external" href="https://github.com/alvincjk/EMRI_Kludge_Suite/">EMRI Kludge Suite</a>. However, here the trajectory is vastly improved by employing the 5PN fluxes for generic Kerr orbits from <a class="reference external" href="https://arxiv.org/abs/2008.13554">Fujita &amp; Shibata (2020)</a>.</p>
<p>The 5PN trajectory produces orbital and phase trajectories. The trajectory is calculated until the orbit reaches within 0.2 of the separatrix, determined from <a class="reference external" href="https://arxiv.org/abs/1912.07609/">Stein and Warburton (2020)</a>. The fundamental frequencies along the trajectory at each point are then calculated from the orbital parameters and the spin value given by <a class="reference external" href="https://arxiv.org/abs/gr-qc/0202090%3E">Schmidt (2002)</a>.</p>
<p>These frequencies along the trajectory are then used to map to the frequency basis of the <a class="reference external" href="https://arxiv.org/abs/gr-qc/0310125">Analytic Kludge</a>. This mapping takes the form of time evolving large mass and spin parameters, as well as the use of phases and frequencies in <span class="math notranslate nohighlight">\(\alpha, \Phi, \gamma\)</span>:</p>
<p><span class="math">\begin{align}
\Phi &= \Phi_\phi, \\
\gamma &= \Phi_\phi + \Phi_\theta, \\
\alpha &= \Phi_\phi + \Phi_\theta + \Phi_r. \\
\end{align}</span></p>
<p>The frequencies in that basis are found by taking the time derivatives of each equation above.</p>
<p><strong>Please note:</strong> the 5PN trajectory and AAK waveform take the parameter <span class="math notranslate nohighlight">\(Y\equiv\cos{\iota}=L/\sqrt{L^2 + Q}\)</span> rather than <span class="math notranslate nohighlight">\(x_I\)</span> as is accepted for relativistic waveforms and in the generic waveform interface discussed above. The generic waveform interface directly converts <span class="math notranslate nohighlight">\(x_I\)</span> to <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>This class has GPU capabilities and works from the sparse trajectory methodoligy with cubic spine interpolation of the smoothly varying waveform quantities. This waveform does not have the freedom in terms of user-chosen quantitites that <code class="docutils literal notranslate"><span class="pre">few.waveform.SchwarzschildEccentricWaveformBase</span></code> contains. This is mainly due to the specific waveform constructions particular to the AAK/AK.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">use_gpu</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># keyword arguments for inspiral generator (RunKerrGenericPn5Inspiral)</span>
<span class="n">inspiral_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;DENSE_STEPPING&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># we want a sparsely sampled trajectory</span>
    <span class="s2">&quot;max_init_len&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">),</span>  <span class="c1"># all of the trajectories will be well under len = 1000</span>
<span class="p">}</span>

<span class="c1"># keyword arguments for summation generator (AAKSummation)</span>
<span class="n">sum_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;use_gpu&quot;</span><span class="p">:</span> <span class="n">use_gpu</span><span class="p">,</span>  <span class="c1"># GPU is availabel for this type of summation</span>
    <span class="s2">&quot;pad_output&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">wave_generator</span> <span class="o">=</span> <span class="n">Pn5AAKWaveform</span><span class="p">(</span><span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span> <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">14.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">iota0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iota0</span><span class="p">)</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">0.8</span>


<span class="n">qS</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">phiS</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">qK</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">phiK</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">mich</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="n">waveform</span> <span class="o">=</span> <span class="n">wave_generator</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">qS</span><span class="p">,</span> <span class="n">phiS</span><span class="p">,</span> <span class="n">qK</span><span class="p">,</span> <span class="n">phiK</span><span class="p">,</span>
                          <span class="n">Phi_phi0</span><span class="o">=</span><span class="n">Phi_phi0</span><span class="p">,</span> <span class="n">Phi_theta0</span><span class="o">=</span><span class="n">Phi_theta0</span><span class="p">,</span> <span class="n">Phi_r0</span><span class="o">=</span><span class="n">Phi_r0</span><span class="p">,</span> <span class="n">mich</span><span class="o">=</span><span class="n">mich</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">waveform</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">waveform</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">waveform</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x143f225b0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_135_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_135_1.png" />
</div>
</div>
<p>We can also assume a long-wavelength LISA response by setting <code class="docutils literal notranslate"><span class="pre">mich=True</span></code>. Please note this is not Time-delay interferometry (TDI).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">waveform_lw</span> <span class="o">=</span> <span class="n">wave_generator</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">qS</span><span class="p">,</span> <span class="n">phiS</span><span class="p">,</span> <span class="n">qK</span><span class="p">,</span> <span class="n">phiK</span><span class="p">,</span> <span class="n">mich</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">waveform_lw</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">waveform_lw</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">waveform_lw</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x143f7dc10&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_138_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_138_1.png" />
</div>
</div>
<section id="5PN-Trajectory">
<h2>5PN Trajectory<a class="headerlink" href="#5PN-Trajectory" title="Permalink to this heading"></a></h2>
<p>This new waveform includes 5PN trajectories from <a class="reference external" href="https://arxiv.org/abs/2008.13554">Fujita &amp; Shibata 2020</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize trajectory class</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;pn5&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">14.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">iota0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iota0</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">3.0</span>


<span class="c1"># run trajectory</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">Phi_theta</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span>
                                             <span class="n">Phi_phi0</span><span class="o">=</span><span class="n">Phi_phi0</span><span class="p">,</span> <span class="n">Phi_theta0</span><span class="o">=</span><span class="n">Phi_theta0</span><span class="p">,</span> <span class="n">Phi_r0</span><span class="o">=</span><span class="n">Phi_r0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
140 4.530571061589189
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$Y$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_r$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\theta$&#39;</span><span class="p">]</span>
<span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xlab</span><span class="p">,</span> <span class="n">ylab</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_143_0.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_143_0.png" />
</div>
</div>
<p>With the PN trajectory, we need to be careful at smaller <span class="math notranslate nohighlight">\(p\)</span>, larger <span class="math notranslate nohighlight">\(a\)</span>, and larger <span class="math notranslate nohighlight">\(e\)</span>. This trajectory can exihibt pathological behavior near these extremes. Therefore, we provide the option to truncate the trajectory at the Schwarzschild (<span class="math notranslate nohighlight">\(a=0\)</span>) separatrix, <span class="math notranslate nohighlight">\(6 + 2e\)</span>. To do this, you provide the keyword <code class="docutils literal notranslate"><span class="pre">enforce_schwarz_sep=True</span></code> to the initialization of the class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize trajectory class</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">EMRIInspiral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="s2">&quot;pn5&quot;</span><span class="p">,</span> <span class="n">enforce_schwarz_sep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">14.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">iota0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iota0</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">3.0</span>


<span class="c1"># run trajectory</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">Phi_theta</span> <span class="o">=</span> <span class="n">traj</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span>
                                             <span class="n">Phi_phi0</span><span class="o">=</span><span class="n">Phi_phi0</span><span class="p">,</span> <span class="n">Phi_theta0</span><span class="o">=</span><span class="n">Phi_theta0</span><span class="p">,</span> <span class="n">Phi_r0</span><span class="o">=</span><span class="n">Phi_r0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
104 6.549942276116756
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$e$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$Y$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_r$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\Phi_\theta$&#39;</span><span class="p">]</span>
<span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$p$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Phi_phi</span><span class="p">,</span> <span class="n">Phi_r</span><span class="p">,</span> <span class="n">Phi_theta</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xlab</span><span class="p">,</span> <span class="n">ylab</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_147_0.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_147_0.png" />
</div>
</div>
</section>
<section id="Building-an-AAK-waveform-from-a-given-trajectory-(in-this-case-the-5PN-trajectory)">
<h2>Building an AAK waveform from a given trajectory (in this case the 5PN trajectory)<a class="headerlink" href="#Building-an-AAK-waveform-from-a-given-trajectory-(in-this-case-the-5PN-trajectory)" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">few.utils.baseclasses</span> <span class="kn">import</span> <span class="n">Pn5AAK</span><span class="p">,</span> <span class="n">ParallelModuleBase</span>

<span class="k">class</span> <span class="nc">NewPn5AAKWaveform</span><span class="p">(</span><span class="n">AAKWaveformBase</span><span class="p">,</span> <span class="n">Pn5AAK</span><span class="p">,</span> <span class="n">ParallelModuleBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">sum_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_threads</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>

        <span class="n">inspiral_kwargs</span><span class="p">[</span><span class="s2">&quot;func&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pn5&quot;</span>

        <span class="n">AAKWaveformBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">EMRIInspiral</span><span class="p">,</span>  <span class="c1"># trajectory class</span>
            <span class="n">AAKSummation</span><span class="p">,</span>
            <span class="n">inspiral_kwargs</span><span class="o">=</span><span class="n">inspiral_kwargs</span><span class="p">,</span>
            <span class="n">sum_kwargs</span><span class="o">=</span><span class="n">sum_kwargs</span><span class="p">,</span>
            <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">,</span>
            <span class="n">num_threads</span><span class="o">=</span><span class="n">num_threads</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set initial parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">14.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">iota0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iota0</span><span class="p">)</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">0.8</span>


<span class="n">qS</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">phiS</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">qK</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">phiK</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">mich</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="n">wave_generator</span> <span class="o">=</span> <span class="n">NewPn5AAKWaveform</span><span class="p">()</span>
<span class="n">AAK_out</span> <span class="o">=</span> <span class="n">wave_generator</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> <span class="n">qS</span><span class="p">,</span> <span class="n">phiS</span><span class="p">,</span> <span class="n">qK</span><span class="p">,</span> <span class="n">phiK</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span>
                          <span class="n">Phi_phi0</span><span class="o">=</span><span class="n">Phi_phi0</span><span class="p">,</span> <span class="n">Phi_theta0</span><span class="o">=</span><span class="n">Phi_theta0</span><span class="p">,</span> <span class="n">Phi_r0</span><span class="o">=</span><span class="n">Phi_r0</span><span class="p">,</span> <span class="n">mich</span><span class="o">=</span><span class="n">mich</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AAK_out</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AAK_out</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x14460f520&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_151_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_151_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AAK_out</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">400</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AAK_out</span><span class="o">.</span><span class="n">imag</span><span class="p">[:</span><span class="mi">400</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x1446adc40&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_152_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_152_1.png" />
</div>
</div>
</section>
<section id="Generating-the-new-AAK-with-the-generic-waveform-generator">
<h2>Generating the new AAK with the generic waveform generator<a class="headerlink" href="#Generating-the-new-AAK-with-the-generic-waveform-generator" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_wave</span> <span class="o">=</span> <span class="n">GenerateEMRIWaveform</span><span class="p">(</span><span class="s2">&quot;Pn5AAKWaveform&quot;</span><span class="p">)</span>

<span class="c1"># parameters</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># years</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">15.0</span>  <span class="c1"># seconds</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1e6</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.6</span>  <span class="c1"># notice this is x_I, not Y. The AAK waveform can convert to Y.</span>
<span class="n">qK</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># polar spin angle</span>
<span class="n">phiK</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">qS</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># polar sky angle</span>
<span class="n">phiS</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># azimuthal viewing angle</span>
<span class="n">dist</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># distance</span>
<span class="n">Phi_phi0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Phi_theta0</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">Phi_r0</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">gen_wave</span><span class="p">(</span>
    <span class="n">M</span><span class="p">,</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">a</span><span class="p">,</span>
    <span class="n">p0</span><span class="p">,</span>
    <span class="n">e0</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">dist</span><span class="p">,</span>
    <span class="n">qS</span><span class="p">,</span>
    <span class="n">phiS</span><span class="p">,</span>
    <span class="n">qK</span><span class="p">,</span>
    <span class="n">phiK</span><span class="p">,</span>
    <span class="n">Phi_phi0</span><span class="p">,</span>
    <span class="n">Phi_theta0</span><span class="p">,</span>
    <span class="n">Phi_r0</span><span class="p">,</span>
    <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">real</span><span class="p">[:</span><span class="mi">2000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x140729310&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_FastEMRIWaveforms_tutorial_154_1.png" src="../_images/tutorial_FastEMRIWaveforms_tutorial_154_1.png" />
</div>
</div>
</section>
</section>
<section id="Citing-waveforms-and-modules">
<h1>Citing waveforms and modules<a class="headerlink" href="#Citing-waveforms-and-modules" title="Permalink to this heading"></a></h1>
<p>If you use any work from this package please cite our papers <a class="reference external" href="https://arxiv.org/abs/2104.04582">arxiv.org/2104.04582</a> and <a class="reference external" href="https://arxiv.org/abs/2008.06071">arxiv.org/2008.06071</a>. Additionally please cite any additional work for each module used by calling the <code class="docutils literal notranslate"><span class="pre">citation</span></code> attribute on the module class:</p>
<section id="Fast-Schwarzschild-Eccentric-Waveforms">
<h2>Fast Schwarzschild Eccentric Waveforms<a class="headerlink" href="#Fast-Schwarzschild-Eccentric-Waveforms" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">FastSchwarzschildEccentricFlux</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">citation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

@article{Katz:2021yft,
    author = &#34;Katz, Michael L. and Chua, Alvin J. K. and Speri, Lorenzo and Warburton, Niels and Hughes, Scott A.&#34;,
    title = &#34;{FastEMRIWaveforms: New tools for millihertz gravitational-wave data analysis}&#34;,
    eprint = &#34;2104.04582&#34;,
    archivePrefix = &#34;arXiv&#34;,
    primaryClass = &#34;gr-qc&#34;,
    month = &#34;4&#34;,
    year = &#34;2021&#34;
}

@article{Chua:2020stf,
    author = &#34;Chua, Alvin J. K. and Katz, Michael L. and Warburton, Niels and Hughes, Scott A.&#34;,
    title = &#34;{Rapid generation of fully relativistic extreme-mass-ratio-inspiral waveform templates for LISA data analysis}&#34;,
    eprint = &#34;2008.06071&#34;,
    archivePrefix = &#34;arXiv&#34;,
    primaryClass = &#34;gr-qc&#34;,
    doi = &#34;10.1103/PhysRevLett.126.051102&#34;,
    journal = &#34;Phys. Rev. Lett.&#34;,
    volume = &#34;126&#34;,
    number = &#34;5&#34;,
    pages = &#34;051102&#34;,
    year = &#34;2021&#34;
}

@software{michael_l_katz_2020_4005001,
  author       = {Michael L. Katz and
                  Alvin J. K. Chua and
                  Niels Warburton and
                  Scott A. Hughes.},
  title        = {{BlackHolePerturbationToolkit/FastEMRIWaveforms:
                   Official Release}},
  month        = aug,
  year         = 2020,
  publisher    = {Zenodo},
  version      = {v1.0.0},
  doi          = {10.5281/zenodo.4005001},
  url          = {https://doi.org/10.5281/zenodo.4005001}
}

@article{Chua:2018woh,
    author = &#34;Chua, Alvin J.K. and Galley, Chad R. and Vallisneri, Michele&#34;,
    title = &#34;{Reduced-order modeling with artificial neurons for gravitational-wave inference}&#34;,
    eprint = &#34;1811.05491&#34;,
    archivePrefix = &#34;arXiv&#34;,
    primaryClass = &#34;astro-ph.IM&#34;,
    doi = &#34;10.1103/PhysRevLett.122.211101&#34;,
    journal = &#34;Phys. Rev. Lett.&#34;,
    volume = &#34;122&#34;,
    number = &#34;21&#34;,
    pages = &#34;211101&#34;,
    year = &#34;2019&#34;
}

</pre></div></div>
</div>
</section>
<section id="New-and-Improved-AAK-with-5PN-Trajectory">
<h2>New and Improved AAK with 5PN Trajectory<a class="headerlink" href="#New-and-Improved-AAK-with-5PN-Trajectory" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave_aak</span> <span class="o">=</span> <span class="n">Pn5AAKWaveform</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wave_aak</span><span class="o">.</span><span class="n">citation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

@article{Katz:2021yft,
    author = &#34;Katz, Michael L. and Chua, Alvin J. K. and Speri, Lorenzo and Warburton, Niels and Hughes, Scott A.&#34;,
    title = &#34;{FastEMRIWaveforms: New tools for millihertz gravitational-wave data analysis}&#34;,
    eprint = &#34;2104.04582&#34;,
    archivePrefix = &#34;arXiv&#34;,
    primaryClass = &#34;gr-qc&#34;,
    month = &#34;4&#34;,
    year = &#34;2021&#34;
}

@article{Chua:2020stf,
    author = &#34;Chua, Alvin J. K. and Katz, Michael L. and Warburton, Niels and Hughes, Scott A.&#34;,
    title = &#34;{Rapid generation of fully relativistic extreme-mass-ratio-inspiral waveform templates for LISA data analysis}&#34;,
    eprint = &#34;2008.06071&#34;,
    archivePrefix = &#34;arXiv&#34;,
    primaryClass = &#34;gr-qc&#34;,
    doi = &#34;10.1103/PhysRevLett.126.051102&#34;,
    journal = &#34;Phys. Rev. Lett.&#34;,
    volume = &#34;126&#34;,
    number = &#34;5&#34;,
    pages = &#34;051102&#34;,
    year = &#34;2021&#34;
}

@software{michael_l_katz_2020_4005001,
  author       = {Michael L. Katz and
                  Alvin J. K. Chua and
                  Niels Warburton and
                  Scott A. Hughes.},
  title        = {{BlackHolePerturbationToolkit/FastEMRIWaveforms:
                   Official Release}},
  month        = aug,
  year         = 2020,
  publisher    = {Zenodo},
  version      = {v1.0.0},
  doi          = {10.5281/zenodo.4005001},
  url          = {https://doi.org/10.5281/zenodo.4005001}
}


@article{Chua:2015mua,
    author = &#34;Chua, Alvin J.K. and Gair, Jonathan R.&#34;,
    title = &#34;{Improved analytic extreme-mass-ratio inspiral model for scoping out eLISA data analysis}&#34;,
    eprint = &#34;1510.06245&#34;,
    archivePrefix = &#34;arXiv&#34;,
    primaryClass = &#34;gr-qc&#34;,
    doi = &#34;10.1088/0264-9381/32/23/232002&#34;,
    journal = &#34;Class. Quant. Grav.&#34;,
    volume = &#34;32&#34;,
    pages = &#34;232002&#34;,
    year = &#34;2015&#34;
}


@article{Chua:2017ujo,
    author = &#34;Chua, Alvin J.K. and Moore, Christopher J. and Gair, Jonathan R.&#34;,
    title = &#34;{Augmented kludge waveforms for detecting extreme-mass-ratio inspirals}&#34;,
    eprint = &#34;1705.04259&#34;,
    archivePrefix = &#34;arXiv&#34;,
    primaryClass = &#34;gr-qc&#34;,
    doi = &#34;10.1103/PhysRevD.96.044005&#34;,
    journal = &#34;Phys. Rev. D&#34;,
    volume = &#34;96&#34;,
    number = &#34;4&#34;,
    pages = &#34;044005&#34;,
    year = &#34;2017&#34;
}

@article{Barack:2003fp,
    author = &#34;Barack, Leor and Cutler, Curt&#34;,
    title = &#34;{LISA capture sources: Approximate waveforms, signal-to-noise ratios, and parameter estimation accuracy}&#34;,
    eprint = &#34;gr-qc/0310125&#34;,
    archivePrefix = &#34;arXiv&#34;,
    doi = &#34;10.1103/PhysRevD.69.082005&#34;,
    journal = &#34;Phys. Rev. D&#34;,
    volume = &#34;69&#34;,
    pages = &#34;082005&#34;,
    year = &#34;2004&#34;
}

@article{Fujita:2020zxe,
    author = &#34;Fujita, Ryuichi and Shibata, Masaru&#34;,
    title = &#34;{Extreme mass ratio inspirals on the equatorial plane in the adiabatic order}&#34;,
    eprint = &#34;2008.13554&#34;,
    archivePrefix = &#34;arXiv&#34;,
    primaryClass = &#34;gr-qc&#34;,
    doi = &#34;10.1103/PhysRevD.102.064005&#34;,
    journal = &#34;Phys. Rev. D&#34;,
    volume = &#34;102&#34;,
    number = &#34;6&#34;,
    pages = &#34;064005&#34;,
    year = &#34;2020&#34;
}

@article{Stein:2019buj,
    author = &#34;Stein, Leo C. and Warburton, Niels&#34;,
    title = &#34;{Location of the last stable orbit in Kerr spacetime}&#34;,
    eprint = &#34;1912.07609&#34;,
    archivePrefix = &#34;arXiv&#34;,
    primaryClass = &#34;gr-qc&#34;,
    doi = &#34;10.1103/PhysRevD.101.064007&#34;,
    journal = &#34;Phys. Rev. D&#34;,
    volume = &#34;101&#34;,
    number = &#34;6&#34;,
    pages = &#34;064007&#34;,
    year = &#34;2020&#34;
}

</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../user/cite.html" class="btn btn-neutral float-left" title="Citations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../general/docs_main.html" class="btn btn-neutral float-right" title="FastEMRIWaveforms Publications" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Michael Katz, Alvin Chua, Niels Warburton.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>