

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Utilities &mdash; few: Fast EMRI Waveforms 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Citations" href="cite.html" />
    <link rel="prev" title="Summation Package" href="sum.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >

          
          
          <a href="../index.html" class="icon icon-home">
            few: Fast EMRI Waveforms
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="main.html">Overall Waveform Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="traj.html">Trajectory Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="amp.html">Amplitude Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="sum.html">Summation Package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-few.utils.modeselector">Mode Filtering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.modeselector.ModeSelector"><code class="docutils literal notranslate"><span class="pre">ModeSelector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.ModeSelector.gpu_capability"><code class="docutils literal notranslate"><span class="pre">ModeSelector.gpu_capability</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.ModeSelector.is_predictive"><code class="docutils literal notranslate"><span class="pre">ModeSelector.is_predictive</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.ModeSelector.attributes_ModeSelector"><code class="docutils literal notranslate"><span class="pre">ModeSelector.attributes_ModeSelector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.ModeSelector.citation"><code class="docutils literal notranslate"><span class="pre">ModeSelector.citation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.ModeSelector.__call__"><code class="docutils literal notranslate"><span class="pre">ModeSelector.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.ModeSelector.adjust_gpu_usage"><code class="docutils literal notranslate"><span class="pre">ModeSelector.adjust_gpu_usage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.ModeSelector.attributes_ParallelModuleBase"><code class="docutils literal notranslate"><span class="pre">ModeSelector.attributes_ParallelModuleBase()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.ModeSelector.sanity_check_gpu"><code class="docutils literal notranslate"><span class="pre">ModeSelector.sanity_check_gpu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">ModeSelector.xp</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.modeselector.NeuralModeSelector"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.NeuralModeSelector.gpu_capability"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector.gpu_capability</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.NeuralModeSelector.is_predictive"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector.is_predictive</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.NeuralModeSelector.attributes_ModeSelector"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector.attributes_ModeSelector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.NeuralModeSelector.adjust_gpu_usage"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector.adjust_gpu_usage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.NeuralModeSelector.attributes_ParallelModuleBase"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector.attributes_ParallelModuleBase()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.NeuralModeSelector.citation"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector.citation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.NeuralModeSelector.sanity_check_gpu"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector.sanity_check_gpu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector.xp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.modeselector.NeuralModeSelector.__call__"><code class="docutils literal notranslate"><span class="pre">NeuralModeSelector.__call__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-few.utils.ylm">(-2) Spin-Weighted Spherical Harmonics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.ylm.GetYlms"><code class="docutils literal notranslate"><span class="pre">GetYlms</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.ylm.GetYlms.gpu_capability"><code class="docutils literal notranslate"><span class="pre">GetYlms.gpu_capability</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.ylm.GetYlms.attributes_GetYlms"><code class="docutils literal notranslate"><span class="pre">GetYlms.attributes_GetYlms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.ylm.GetYlms.__call__"><code class="docutils literal notranslate"><span class="pre">GetYlms.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.ylm.GetYlms.adjust_gpu_usage"><code class="docutils literal notranslate"><span class="pre">GetYlms.adjust_gpu_usage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.ylm.GetYlms.attributes_ParallelModuleBase"><code class="docutils literal notranslate"><span class="pre">GetYlms.attributes_ParallelModuleBase()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.ylm.GetYlms.citation"><code class="docutils literal notranslate"><span class="pre">GetYlms.citation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.ylm.GetYlms.sanity_check_gpu"><code class="docutils literal notranslate"><span class="pre">GetYlms.sanity_check_gpu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">GetYlms.xp</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-few.utils.fdutils">Frequency Domain Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.fdutils.get_convolution"><code class="docutils literal notranslate"><span class="pre">get_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.fdutils.get_fft_td_windowed"><code class="docutils literal notranslate"><span class="pre">get_fft_td_windowed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.fdutils.get_fd_windowed"><code class="docutils literal notranslate"><span class="pre">get_fd_windowed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.fdutils.GetFDWaveformFromFD"><code class="docutils literal notranslate"><span class="pre">GetFDWaveformFromFD</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.fdutils.GetFDWaveformFromFD.__call__"><code class="docutils literal notranslate"><span class="pre">GetFDWaveformFromFD.__call__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.fdutils.GetFDWaveformFromTD"><code class="docutils literal notranslate"><span class="pre">GetFDWaveformFromTD</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#few.utils.fdutils.GetFDWaveformFromTD.__call__"><code class="docutils literal notranslate"><span class="pre">GetFDWaveformFromTD.__call__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-few.utils.utility">Analysis and Other Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.get_overlap"><code class="docutils literal notranslate"><span class="pre">get_overlap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.get_mismatch"><code class="docutils literal notranslate"><span class="pre">get_mismatch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.p_to_y"><code class="docutils literal notranslate"><span class="pre">p_to_y()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.kerr_p_to_u"><code class="docutils literal notranslate"><span class="pre">kerr_p_to_u()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.ELQ_to_pex"><code class="docutils literal notranslate"><span class="pre">ELQ_to_pex()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.get_fundamental_frequencies"><code class="docutils literal notranslate"><span class="pre">get_fundamental_frequencies()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.get_fundamental_frequencies_spin_corrections"><code class="docutils literal notranslate"><span class="pre">get_fundamental_frequencies_spin_corrections()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.get_kerr_geo_constants_of_motion"><code class="docutils literal notranslate"><span class="pre">get_kerr_geo_constants_of_motion()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.get_separatrix"><code class="docutils literal notranslate"><span class="pre">get_separatrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.get_at_t"><code class="docutils literal notranslate"><span class="pre">get_at_t()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.get_p_at_t"><code class="docutils literal notranslate"><span class="pre">get_p_at_t()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.get_mu_at_t"><code class="docutils literal notranslate"><span class="pre">get_mu_at_t()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.check_for_file_download"><code class="docutils literal notranslate"><span class="pre">check_for_file_download()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.wrapper"><code class="docutils literal notranslate"><span class="pre">wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.pointer_adjust"><code class="docutils literal notranslate"><span class="pre">pointer_adjust()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.utility.cuda_set_device"><code class="docutils literal notranslate"><span class="pre">cuda_set_device()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#elliptic-integrals-legendre-and-carlson-symmetric-forms">Elliptic integrals (Legendre and Carlson symmetric forms)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.elliptic.RF"><code class="docutils literal notranslate"><span class="pre">RF()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.elliptic.RC"><code class="docutils literal notranslate"><span class="pre">RC()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.elliptic.RJ"><code class="docutils literal notranslate"><span class="pre">RJ()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.elliptic.RD"><code class="docutils literal notranslate"><span class="pre">RD()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.elliptic.EllipK"><code class="docutils literal notranslate"><span class="pre">EllipK()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.elliptic.EllipE"><code class="docutils literal notranslate"><span class="pre">EllipE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.elliptic.EllipPi"><code class="docutils literal notranslate"><span class="pre">EllipPi()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pn-parameter-mapping-utilities">PN Parameter Mapping Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.pn_map.Y_to_xI"><code class="docutils literal notranslate"><span class="pre">Y_to_xI()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#few.utils.pn_map.xI_to_Y"><code class="docutils literal notranslate"><span class="pre">xI_to_Y()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">Citations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Trajectory_tutorial.html">Fast self-forced trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html">Fast and Accurate EMRI Waveforms Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Full-EMRI-Waveforms-in-Schwarzschild-Eccentric">Full EMRI Waveforms in Schwarzschild Eccentric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Trajectory-Module">Trajectory Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Amplitude-Module">Amplitude Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Spin-weighted-spherical-harmonics">Spin-weighted spherical harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Mode-Selection">Mode Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Parallelized-Cubic-Spline-Interpolation">Parallelized Cubic Spline Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Mode-Summation">Mode Summation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Utility-functions">Utility functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Creating-modules">Creating modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Augmented-Analytic-Kludge-with-5PN-trajectory">Augmented Analytic Kludge with 5PN trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Citing-waveforms-and-modules">Citing waveforms and modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Tutorial_FD_construction_single_mode.html">Single Mode Frequency Domain Waveform Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Tutorial_FrequencyDomain_Waveforms.html">EMRI Waveforms in frequency domain</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html">FastEMRIWaveforms Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html#package-todos">Package TODOs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html#change-log">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: coral" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">few: Fast EMRI Waveforms</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Utilities</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user/util.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="sum.html" class="btn btn-neutral float-left" title="Summation Package" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cite.html" class="btn btn-neutral float-right" title="Citations" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-few.utils">
<span id="utilities"></span><span id="utilities-label"></span><h1>Utilities<a class="headerlink" href="#module-few.utils" title="Link to this heading"></a></h1>
<section id="module-few.utils.modeselector">
<span id="mode-filtering"></span><h2>Mode Filtering<a class="headerlink" href="#module-few.utils.modeselector" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">few.utils.modeselector.</span></span><span class="sig-name descname"><span class="pre">ModeSelector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.ModeSelector" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="main.html#few.utils.baseclasses.ParallelModuleBase" title="few.utils.baseclasses.ParallelModuleBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelModuleBase</span></code></a></p>
<p>Filter teukolsky amplitudes based on power contribution.</p>
<p>This module takes teukolsky modes, combines them with their associated ylms,
and determines the power contribution from each mode. It then filters the
modes bases on the fractional accuracy on the total power (eps) parameter.
Additionally, if a sensitivity curve is provided, the mode power is also
weighted according to the PSD of the sensitivity.</p>
<p>The mode filtering is a major contributing factor to the speed of these
waveforms as it removes large numbers of useles modes from the final
summation calculation.</p>
<p>Be careful as this is built based on the construction that input mode arrays
will in order of <span class="math notranslate nohighlight">\(m=0\)</span>, <span class="math notranslate nohighlight">\(m&gt;0\)</span>, and then <span class="math notranslate nohighlight">\(m&lt;0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_arr</strong> (<em>1D int self.xp.ndarray</em>) – The l-mode indices for each mode index.</p></li>
<li><p><strong>m_arr</strong> (<em>1D int self.xp.ndarray</em>) – The m-mode indices for each mode index.</p></li>
<li><p><strong>n_arr</strong> (<em>1D int self.xp.ndarray</em>) – The n-mode indices for each mode index.</p></li>
<li><p><strong>sensitivity_fn</strong> (<em>object</em><em>, </em><em>optional</em>) – Sensitivity curve function that takes
a frequency (Hz) array as input and returns the Power Spectral Density (PSD)
of the sensitivity curve. Default is None. If this is not none, this
sennsitivity is used to weight the mode values when determining which
modes to keep. <strong>Note</strong>: if the sensitivity function is provided,
and GPUs are used, then this function must accept CuPy arrays as input.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for the base classes:
<a class="reference internal" href="main.html#few.utils.baseclasses.ParallelModuleBase" title="few.utils.baseclasses.ParallelModuleBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.ParallelModuleBase</span></code></a>.
Default is {}.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.gpu_capability">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gpu_capability</span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.gpu_capability" title="Link to this definition"></a></dt>
<dd><p>Confirms GPU capability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.is_predictive">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_predictive</span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.is_predictive" title="Link to this definition"></a></dt>
<dd><p>Whether this mode selector should be used before or after amplitude generation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.attributes_ModeSelector">
<span class="sig-name descname"><span class="pre">attributes_ModeSelector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.attributes_ModeSelector" title="Link to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.xp">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.xp" title="Link to this definition"></a></dt>
<dd><p>cupy or numpy depending on GPU usage.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.num_m_zero_up">
<span class="sig-name descname"><span class="pre">num_m_zero_up</span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.num_m_zero_up" title="Link to this definition"></a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.num_m_1_up">
<span class="sig-name descname"><span class="pre">num_m_1_up</span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.num_m_1_up" title="Link to this definition"></a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.num_m0">
<span class="sig-name descname"><span class="pre">num_m0</span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.num_m0" title="Link to this definition"></a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.sensitivity_fn">
<span class="sig-name descname"><span class="pre">sensitivity_fn</span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.sensitivity_fn" title="Link to this definition"></a></dt>
<dd><p>sensitivity generating function for power-weighting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.citation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">citation</span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.citation" title="Link to this definition"></a></dt>
<dd><p>Return citations related to this class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">teuk_modes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeinds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fund_freq_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.__call__" title="Link to this definition"></a></dt>
<dd><p>Call to sort and filer teukolsky modes.</p>
<p>This is the call function that takes the teukolsky modes, ylms,
mode indices and fractional accuracy of the total power and returns
filtered teukolsky modes and ylms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>teuk_modes</strong> (<em>2D complex128 self.xp.ndarray</em>) – Complex teukolsky amplitudes
from the amplitude modules.
Shape: (number of trajectory points, number of modes).</p></li>
<li><p><strong>ylms</strong> (<em>1D complex128 self.xp.ndarray</em>) – Array of ylm values for each mode,
including m&lt;0. Shape is (num of m==0,) + (num of m&gt;0,)
+ (num of m&lt;0). Number of m&lt;0 and m&gt;0 is the same, but they are
ordered as (m==0) first then m&gt;0 then m&lt;0.</p></li>
<li><p><strong>modeinds</strong> (<em>list</em><em> of </em><em>int self.xp.ndarrays</em>) – List containing the mode index arrays. If in an
equatorial model, need <span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays. If generic,
<span class="math notranslate nohighlight">\((l,m,k,n)\)</span> arrays. e.g. [l_arr, m_arr, n_arr].</p></li>
<li><p><strong>fund_freq_args</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Args necessary to determine
fundamental frequencies along trajectory. The tuple will represent
<span class="math notranslate nohighlight">\((M, a, e, p, \cos\iota)\)</span> where the large black hole mass (<span class="math notranslate nohighlight">\(M\)</span>)
and spin (<span class="math notranslate nohighlight">\(a\)</span>) are scalar and the other three quantities are self.xp.ndarrays.
This must be provided if sensitivity weighting is used. Default is None.</p></li>
<li><p><strong>eps</strong> (<em>double</em><em>, </em><em>optional</em>) – Fractional accuracy of the total power used
to determine the contributing modes. Lowering this value will
calculate more modes slower the waveform down, but generally
improving accuracy. Increasing this value removes modes from
consideration and can have a considerable affect on the speed of
the waveform, albeit at the cost of some accuracy (usually an
acceptable loss). Default that gives good mismatch qualities is
1e-5.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.adjust_gpu_usage">
<span class="sig-name descname"><span class="pre">adjust_gpu_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.adjust_gpu_usage" title="Link to this definition"></a></dt>
<dd><p>Adjust all inputs for gpu usage</p>
<p>If user wants to use gpu, it will change all <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code> in
so that <code class="code docutils literal notranslate"><span class="pre">use_gpu=True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_gpu</strong> (<em>bool</em>) – If True, use gpu resources.</p></li>
<li><p><strong>kwargs</strong> (<em>list</em><em> of </em><em>dicts</em><em> or </em><em>dict</em>) – List of kwargs dictionaries or
single dictionary for each constituent class in the
waveform generator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.attributes_ParallelModuleBase">
<span class="sig-name descname"><span class="pre">attributes_ParallelModuleBase</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.attributes_ParallelModuleBase" title="Link to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.use_gpu">
<span class="sig-name descname"><span class="pre">use_gpu</span></span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.use_gpu" title="Link to this definition"></a></dt>
<dd><p>If True, use GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Either numpy or CuPy based on gpu preference.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.ModeSelector.sanity_check_gpu">
<span class="sig-name descname"><span class="pre">sanity_check_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.sanity_check_gpu" title="Link to this definition"></a></dt>
<dd><p>Check if this class has GPU capability</p>
<p>If the user is requesting GPU usage, this will confirm the class has
GPU capabilites.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>use_gpu</strong> (<em>bool</em>) – If True, the user is requesting GPU usage.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – The user is requesting GPU usage, but this class does
    not have that capability.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">object</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Cupy or Numpy</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">few.utils.modeselector.</span></span><span class="sig-name descname"><span class="pre">NeuralModeSelector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_selector_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tuples'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximise_over_theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="main.html#few.utils.baseclasses.ParallelModuleBase" title="few.utils.baseclasses.ParallelModuleBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelModuleBase</span></code></a></p>
<p>Filter teukolsky amplitudes based on power contribution.</p>
<p>This module uses a combination of a pre-computed mask and a feed-forward neural
network to predict the mode content of the waveform given its parameters. Therefore,
the results will vary compared to manually computing the mode selection, but it should be
very accurate especially for the stronger modes.</p>
<p>The mode filtering is a major contributing factor to the speed of these
waveforms as it removes large numbers of useles modes from the final
summation calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_arr</strong> (<em>1D int self.xp.ndarray</em>) – The l-mode indices for each mode index.</p></li>
<li><p><strong>m_arr</strong> (<em>1D int self.xp.ndarray</em>) – The m-mode indices for each mode index.</p></li>
<li><p><strong>n_arr</strong> (<em>1D int self.xp.ndarray</em>) – The n-mode indices for each mode index.</p></li>
<li><p><strong>threshold</strong> (<em>double</em>) – The network threshold value for mode retention. Decrease to keep more modes,
minimising missed modes but slowing down the waveform computation. Defaults to 0.5 (the optimal value for accuracy).</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for the base classes:
<a class="reference internal" href="main.html#few.utils.baseclasses.ParallelModuleBase" title="few.utils.baseclasses.ParallelModuleBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.ParallelModuleBase</span></code></a>.
Default is {}.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.gpu_capability">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gpu_capability</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.gpu_capability" title="Link to this definition"></a></dt>
<dd><p>Confirms GPU capability</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.is_predictive">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_predictive</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.is_predictive" title="Link to this definition"></a></dt>
<dd><p>Whether this mode selector should be used before or after amplitude generation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.attributes_ModeSelector">
<span class="sig-name descname"><span class="pre">attributes_ModeSelector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.attributes_ModeSelector" title="Link to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.xp">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.xp" title="Link to this definition"></a></dt>
<dd><p>cupy or numpy depending on GPU usage.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.torch">
<span class="sig-name descname"><span class="pre">torch</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.torch" title="Link to this definition"></a></dt>
<dd><p>pytorch module.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.device" title="Link to this definition"></a></dt>
<dd><p>The pytorch device currently in use: should agree with what is set by cupy.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.threshold">
<span class="sig-name descname"><span class="pre">threshold</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.threshold" title="Link to this definition"></a></dt>
<dd><p>network evaluation threshold for keeping/discarding modes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.vector_min">
<span class="sig-name descname"><span class="pre">vector_min</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.vector_min" title="Link to this definition"></a></dt>
<dd><p>minimum bounds of the training data, for rescaling.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.vector_max">
<span class="sig-name descname"><span class="pre">vector_max</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.vector_max" title="Link to this definition"></a></dt>
<dd><p>maximum bounds of the training data, for rescaling.</p>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.adjust_gpu_usage">
<span class="sig-name descname"><span class="pre">adjust_gpu_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.adjust_gpu_usage" title="Link to this definition"></a></dt>
<dd><p>Adjust all inputs for gpu usage</p>
<p>If user wants to use gpu, it will change all <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code> in
so that <code class="code docutils literal notranslate"><span class="pre">use_gpu=True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_gpu</strong> (<em>bool</em>) – If True, use gpu resources.</p></li>
<li><p><strong>kwargs</strong> (<em>list</em><em> of </em><em>dicts</em><em> or </em><em>dict</em>) – List of kwargs dictionaries or
single dictionary for each constituent class in the
waveform generator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.attributes_ParallelModuleBase">
<span class="sig-name descname"><span class="pre">attributes_ParallelModuleBase</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.attributes_ParallelModuleBase" title="Link to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.use_gpu">
<span class="sig-name descname"><span class="pre">use_gpu</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.use_gpu" title="Link to this definition"></a></dt>
<dd><p>If True, use GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Either numpy or CuPy based on gpu preference.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.citation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">citation</span></span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.citation" title="Link to this definition"></a></dt>
<dd><p>Return citations related to this class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.sanity_check_gpu">
<span class="sig-name descname"><span class="pre">sanity_check_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.sanity_check_gpu" title="Link to this definition"></a></dt>
<dd><p>Check if this class has GPU capability</p>
<p>If the user is requesting GPU usage, this will confirm the class has
GPU capabilites.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>use_gpu</strong> (<em>bool</em>) – If True, the user is requesting GPU usage.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – The user is requesting GPU usage, but this class does
    not have that capability.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">object</span></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Cupy or Numpy</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.modeselector.NeuralModeSelector.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.NeuralModeSelector.__call__" title="Link to this definition"></a></dt>
<dd><p>Call to predict the mode content of the waveform.</p>
<p>This is the call function that takes the waveform parameters, applies a
precomputed mask and then evaluates the remaining mode content with a
neural network classifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Mass of larger black hole in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – Mass of compact object in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (Must be greater than
the separatrix at the the given e0 and x0).
See documentation for more information on <span class="math notranslate nohighlight">\(p_0&lt;10\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity.</p></li>
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
<li><p><strong>T</strong> (<em>double</em>) – Duration of waveform in years.</p></li>
<li><p><strong>eps</strong> (<em>double</em>) – Mode selection threshold power.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-few.utils.ylm">
<span id="spin-weighted-spherical-harmonics"></span><h2>(-2) Spin-Weighted Spherical Harmonics<a class="headerlink" href="#module-few.utils.ylm" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">few.utils.ylm.</span></span><span class="sig-name descname"><span class="pre">GetYlms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">assume_positive_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.ylm.GetYlms" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="main.html#few.utils.baseclasses.ParallelModuleBase" title="few.utils.baseclasses.ParallelModuleBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelModuleBase</span></code></a></p>
<p>(-2) Spin-weighted Spherical Harmonics</p>
<p>The class generates (-2) spin-weighted spherical harmonics,
<span class="math notranslate nohighlight">\(Y_{lm}(\Theta,\phi)\)</span>. <strong>Important Note</strong>: this class also applies
the parity operator (<span class="math notranslate nohighlight">\(-1^l\)</span>) to modes with <span class="math notranslate nohighlight">\(m&lt;0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>assume_positive_m</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set true if only providing <span class="math notranslate nohighlight">\(m\geq0\)</span>,
it will return twice the number of requested modes with the seconds
half as modes with <span class="math notranslate nohighlight">\(m&lt;0\)</span>. <strong>Warning</strong>: It will also duplicate
the <span class="math notranslate nohighlight">\(m=0\)</span> modes. Default is False.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for the base classes:
<a class="reference internal" href="main.html#few.utils.baseclasses.ParallelModuleBase" title="few.utils.baseclasses.ParallelModuleBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.ParallelModuleBase</span></code></a>.
Default is {}.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms.gpu_capability">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gpu_capability</span></span><a class="headerlink" href="#few.utils.ylm.GetYlms.gpu_capability" title="Link to this definition"></a></dt>
<dd><p>Confirms GPU capability</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms.attributes_GetYlms">
<span class="sig-name descname"><span class="pre">attributes_GetYlms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.ylm.GetYlms.attributes_GetYlms" title="Link to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms.xp">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#few.utils.ylm.GetYlms.xp" title="Link to this definition"></a></dt>
<dd><p>cupy or numpy based on GPU usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#few.utils.ylm.GetYlms.__call__" title="Link to this definition"></a></dt>
<dd><p>Call method for Ylms.</p>
<p>This returns ylms based on requested <span class="math notranslate nohighlight">\((l,m)\)</span> values and viewing
angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_in</strong> (<em>1D int self.xp.ndarray</em>) – <span class="math notranslate nohighlight">\(l\)</span> values requested.</p></li>
<li><p><strong>m_in</strong> (<em>1D int self.xp.ndarray</em>) – <span class="math notranslate nohighlight">\(m\)</span> values requested.</p></li>
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ylm values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D complex128 self.xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms.adjust_gpu_usage">
<span class="sig-name descname"><span class="pre">adjust_gpu_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.ylm.GetYlms.adjust_gpu_usage" title="Link to this definition"></a></dt>
<dd><p>Adjust all inputs for gpu usage</p>
<p>If user wants to use gpu, it will change all <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code> in
so that <code class="code docutils literal notranslate"><span class="pre">use_gpu=True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_gpu</strong> (<em>bool</em>) – If True, use gpu resources.</p></li>
<li><p><strong>kwargs</strong> (<em>list</em><em> of </em><em>dicts</em><em> or </em><em>dict</em>) – List of kwargs dictionaries or
single dictionary for each constituent class in the
waveform generator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms.attributes_ParallelModuleBase">
<span class="sig-name descname"><span class="pre">attributes_ParallelModuleBase</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.ylm.GetYlms.attributes_ParallelModuleBase" title="Link to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms.use_gpu">
<span class="sig-name descname"><span class="pre">use_gpu</span></span><a class="headerlink" href="#few.utils.ylm.GetYlms.use_gpu" title="Link to this definition"></a></dt>
<dd><p>If True, use GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Either numpy or CuPy based on gpu preference.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms.citation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">citation</span></span><a class="headerlink" href="#few.utils.ylm.GetYlms.citation" title="Link to this definition"></a></dt>
<dd><p>Return citations related to this module</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.ylm.GetYlms.sanity_check_gpu">
<span class="sig-name descname"><span class="pre">sanity_check_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.ylm.GetYlms.sanity_check_gpu" title="Link to this definition"></a></dt>
<dd><p>Check if this class has GPU capability</p>
<p>If the user is requesting GPU usage, this will confirm the class has
GPU capabilites.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>use_gpu</strong> (<em>bool</em>) – If True, the user is requesting GPU usage.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – The user is requesting GPU usage, but this class does
    not have that capability.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id5">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">object</span></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Cupy or Numpy</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-few.utils.fdutils">
<span id="frequency-domain-utilities"></span><h2>Frequency Domain Utilities<a class="headerlink" href="#module-few.utils.fdutils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="few.utils.fdutils.get_convolution">
<span class="sig-prename descclassname"><span class="pre">few.utils.fdutils.</span></span><span class="sig-name descname"><span class="pre">get_convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.fdutils.get_convolution" title="Link to this definition"></a></dt>
<dd><p>Calculate the convolution of two arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>1D xp.ndarray</em>) – First array to convolve.</p></li>
<li><p><strong>b</strong> (<em>1D xp.ndarray</em>) – First array to convolve.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>convolution of the two arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.fdutils.get_fft_td_windowed">
<span class="sig-prename descclassname"><span class="pre">few.utils.fdutils.</span></span><span class="sig-name descname"><span class="pre">get_fft_td_windowed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.fdutils.get_fft_td_windowed" title="Link to this definition"></a></dt>
<dd><p>Calculate the Fast Fourier Transform of a windowed time domain signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>list</em>) – A length-2 list containing the signals plus and cross polarizations.</p></li>
<li><p><strong>window</strong> (<em>1D xp.ndarray</em>) – Array to be applied in time domain to each signal.</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time sampling interval of the signal and window.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fast Fourier Transform of the windowed time domain signals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.fdutils.get_fd_windowed">
<span class="sig-prename descclassname"><span class="pre">few.utils.fdutils.</span></span><span class="sig-name descname"><span class="pre">get_fd_windowed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_in_fd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.fdutils.get_fd_windowed" title="Link to this definition"></a></dt>
<dd><p>Calculate the convolution of a frequency domain signal with a window in time domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>list</em>) – A length-2 list containing the signals plus and cross polarizations in frequency domain.</p></li>
<li><p><strong>window</strong> (<em>None</em><em> or </em><em>1D xp.ndarray</em><em>, </em><em>optional</em>) – Array of the time domain window. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, do not apply window.
This is added for flexibility. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>window_in_fd</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">window</span></code> is given in the frequency domain.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, window is given in the time domain. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>convolution of a frequency domain signal with a time domain window.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="few.utils.fdutils.GetFDWaveformFromFD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">few.utils.fdutils.</span></span><span class="sig-name descname"><span class="pre">GetFDWaveformFromFD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">waveform_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive_frequency_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_zero_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_in_fd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.fdutils.GetFDWaveformFromFD" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generic frequency domain class</p>
<p>This class allows to obtain the frequency domain signal given the frequency domain waveform class
from the FEW package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>waveform_generator</strong> (<em>obj</em>) – FEW waveform class.</p></li>
<li><p><strong>positive_frequency_mask</strong> (<em>1D xp.ndarray</em>) – boolean array to indicate where the frequencies are positive.</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – time sampling interval of the signal and window.</p></li>
<li><p><strong>non_zero_mask</strong> (<em>1D xp.ndarray</em>) – boolean array to indicate where the waveform needs to be set to zero.</p></li>
<li><p><strong>window</strong> (<em>None</em><em> or </em><em>1D xp.ndarray</em><em>, </em><em>optional</em>) – Array of the time domain window. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, do not apply window.
This is added for flexibility. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>window_in_fd</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">window</span></code> is given in the frequency domain.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, window is given in the time domain. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="few.utils.fdutils.GetFDWaveformFromFD.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.fdutils.GetFDWaveformFromFD.__call__" title="Link to this definition"></a></dt>
<dd><p>Run the waveform generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>tuple</em>) – Arguments passed to waveform generator.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Keyword arguments passed to waveform generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>FD Waveform as [h+, hx]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="few.utils.fdutils.GetFDWaveformFromTD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">few.utils.fdutils.</span></span><span class="sig-name descname"><span class="pre">GetFDWaveformFromTD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">waveform_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive_frequency_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_zero_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.fdutils.GetFDWaveformFromTD" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generic time domain class</p>
<p>This class allows to obtain the frequency domain signal given the time domain waveform class
from the FEW package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>waveform_generator</strong> (<em>obj</em>) – FEW waveform class.</p></li>
<li><p><strong>positive_frequency_mask</strong> (<em>1D xp.ndarray</em>) – boolean array to indicate where the frequencies are positive.</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – time sampling interval of the signal and window.</p></li>
<li><p><strong>non_zero_mask</strong> (<em>1D xp.ndarray</em>) – boolean array to indicate where the waveform needs to be set to zero.</p></li>
<li><p><strong>window</strong> (<em>None</em><em> or </em><em>1D xp.ndarray</em><em>, </em><em>optional</em>) – Array of the time domain window. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, do not apply window.
This is added for flexibility. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="few.utils.fdutils.GetFDWaveformFromTD.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.fdutils.GetFDWaveformFromTD.__call__" title="Link to this definition"></a></dt>
<dd><p>Run the waveform generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>tuple</em>) – Arguments passed to waveform generator.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Keyword arguments passed to waveform generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>FD Waveform as [h+, hx] (fft from TD)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-few.utils.utility">
<span id="analysis-and-other-tools"></span><h2>Analysis and Other Tools<a class="headerlink" href="#module-few.utils.utility" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.get_overlap">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">get_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_series_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.get_overlap" title="Link to this definition"></a></dt>
<dd><p>Calculate the overlap.</p>
<p>Takes two time series and finds which one is shorter in length. It then
shortens the longer time series if necessary. Then it performs a
normalized correlation calulation on the two time series to give the
overlap. The overlap of <span class="math notranslate nohighlight">\(a(t)\)</span> and
<span class="math notranslate nohighlight">\(b(t)\)</span>, <span class="math notranslate nohighlight">\(\gamma_{a,b}\)</span>, is given by,</p>
<div class="math notranslate nohighlight">
\[\gamma_{a,b} = &lt;a,b&gt;/(&lt;a,a&gt;&lt;b,b&gt;)^{(1/2)},\]</div>
<p>where <span class="math notranslate nohighlight">\(&lt;a,b&gt;\)</span> is the inner product of the two time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series_1</strong> (<em>1D complex128 xp.ndarray</em>) – Strain time series 1.</p></li>
<li><p><strong>time_series_2</strong> (<em>1D complex128 xp.ndarray</em>) – Strain time series 2.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True use cupy. If False, use numpy. Default
is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.get_mismatch">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">get_mismatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_series_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.get_mismatch" title="Link to this definition"></a></dt>
<dd><p>Calculate the mismatch.</p>
<p>The mismatch is 1 - overlap. Therefore, see documentation for
<code class="xref py py-func docutils literal notranslate"><span class="pre">few.utils.utility.overlap()</span></code> for information on the overlap
calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series_1</strong> (<em>1D complex128 xp.ndarray</em>) – Strain time series 1.</p></li>
<li><p><strong>time_series_2</strong> (<em>1D complex128 xp.ndarray</em>) – Strain time series 2.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True use cupy. If False, use numpy. Default
is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.p_to_y">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">p_to_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.p_to_y" title="Link to this definition"></a></dt>
<dd><p>Convert from separation <span class="math notranslate nohighlight">\(p\)</span> to <span class="math notranslate nohighlight">\(y\)</span> coordinate</p>
<p>Conversion from the semilatus rectum or separation <span class="math notranslate nohighlight">\(p\)</span> to <span class="math notranslate nohighlight">\(y\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>double scalar</em><em> or </em><em>1D xp.ndarray</em>) – Values of separation,
<span class="math notranslate nohighlight">\(p\)</span>, to convert.</p></li>
<li><p><strong>e</strong> (<em>double scalar</em><em> or </em><em>1D xp.ndarray</em>) – Associated eccentricity values
of <span class="math notranslate nohighlight">\(p\)</span> necessary for conversion.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use Cupy/GPUs. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.kerr_p_to_u">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">kerr_p_to_u</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.kerr_p_to_u" title="Link to this definition"></a></dt>
<dd><p>Convert from separation <span class="math notranslate nohighlight">\(p\)</span> to <span class="math notranslate nohighlight">\(y\)</span> coordinate</p>
<p>Conversion from the semilatus rectum or separation <span class="math notranslate nohighlight">\(p\)</span> to <span class="math notranslate nohighlight">\(y\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>double scalar</em><em> or </em><em>1D xp.ndarray</em>) – Values of separation,
<span class="math notranslate nohighlight">\(p\)</span>, to convert.</p></li>
<li><p><strong>e</strong> (<em>double scalar</em><em> or </em><em>1D xp.ndarray</em>) – Associated eccentricity values
of <span class="math notranslate nohighlight">\(p\)</span> necessary for conversion.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use Cupy/GPUs. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.ELQ_to_pex">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">ELQ_to_pex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.ELQ_to_pex" title="Link to this definition"></a></dt>
<dd><p>Convert from separation <span class="math notranslate nohighlight">\(p\)</span> to <span class="math notranslate nohighlight">\(y\)</span> coordinate</p>
<p>Conversion from the semilatus rectum or separation <span class="math notranslate nohighlight">\(p\)</span> to <span class="math notranslate nohighlight">\(y\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>double scalar</em><em> or </em><em>1D xp.ndarray</em>) – Values of separation,
<span class="math notranslate nohighlight">\(p\)</span>, to convert.</p></li>
<li><p><strong>e</strong> (<em>double scalar</em><em> or </em><em>1D xp.ndarray</em>) – Associated eccentricity values
of <span class="math notranslate nohighlight">\(p\)</span> necessary for conversion.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use Cupy/GPUs. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.get_fundamental_frequencies">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">get_fundamental_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.get_fundamental_frequencies" title="Link to this definition"></a></dt>
<dd><p>Get dimensionless fundamental frequencies.</p>
<p>Determines fundamental frequencies in generic Kerr from
<a class="reference external" href="https://arxiv.org/abs/gr-qc/0202090">Schmidt 2002</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Dimensionless spin of massive
black hole. If other parameters are arrays and the spin is scalar,
it will be cast to a 1D array.</p></li>
<li><p><strong>p</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of separation,
<span class="math notranslate nohighlight">\(p\)</span>.</p></li>
<li><p><strong>e</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of eccentricity,
<span class="math notranslate nohighlight">\(e\)</span>.</p></li>
<li><p><strong>x</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of cosine of the
inclination, <span class="math notranslate nohighlight">\(x=\cos{I}\)</span>. Please note this is different from
<span class="math notranslate nohighlight">\(Y=\cos{\iota}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of (OmegaPhi, OmegaTheta, OmegaR).</dt><dd><p>These are 1D arrays or scalar values depending on inputs.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.get_fundamental_frequencies_spin_corrections">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">get_fundamental_frequencies_spin_corrections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.get_fundamental_frequencies_spin_corrections" title="Link to this definition"></a></dt>
<dd><p>Get dimensionless fundamental frequencies.</p>
<p>Determines fundamental frequencies in generic Kerr from
<a class="reference external" href="https://arxiv.org/abs/gr-qc/0202090">Schmidt 2002</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Dimensionless spin of massive
black hole. If other parameters are arrays and the spin is scalar,
it will be cast to a 1D array.</p></li>
<li><p><strong>p</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of separation,
<span class="math notranslate nohighlight">\(p\)</span>.</p></li>
<li><p><strong>e</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of eccentricity,
<span class="math notranslate nohighlight">\(e\)</span>.</p></li>
<li><p><strong>x</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of cosine of the
inclination, <span class="math notranslate nohighlight">\(x=\cos{I}\)</span>. Please note this is different from
<span class="math notranslate nohighlight">\(Y=\cos{\iota}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of (OmegaPhi, OmegaTheta, OmegaR).</dt><dd><p>These are 1D arrays or scalar values depending on inputs.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.get_kerr_geo_constants_of_motion">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">get_kerr_geo_constants_of_motion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.get_kerr_geo_constants_of_motion" title="Link to this definition"></a></dt>
<dd><p>Get Kerr constants of motion.</p>
<p>Determines the constants of motion: <span class="math notranslate nohighlight">\((E, L, Q)\)</span> associated with a
geodesic orbit in the generic Kerr spacetime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Dimensionless spin of massive
black hole. If other parameters are arrays and the spin is scalar,
it will be cast to a 1D array.</p></li>
<li><p><strong>p</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of separation,
<span class="math notranslate nohighlight">\(p\)</span>.</p></li>
<li><p><strong>e</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of eccentricity,
<span class="math notranslate nohighlight">\(e\)</span>.</p></li>
<li><p><strong>x</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of cosine of the
inclination, <span class="math notranslate nohighlight">\(x=\cos{I}\)</span>. Please note this is different from
<span class="math notranslate nohighlight">\(Y=\cos{\iota}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of (E, L, Q).</dt><dd><p>These are 1D arrays or scalar values depending on inputs.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.get_separatrix">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">get_separatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-13</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.get_separatrix" title="Link to this definition"></a></dt>
<dd><p>Get separatrix in generic Kerr.</p>
<p>Determines separatrix in generic Kerr from
<a class="reference external" href="https://arxiv.org/abs/1912.07609">Stein &amp; Warburton 2020</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Dimensionless spin of massive
black hole. If other parameters are arrays and the spin is scalar,
it will be cast to a 1D array.</p></li>
<li><p><strong>e</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of eccentricity,
<span class="math notranslate nohighlight">\(e\)</span>.</p></li>
<li><p><strong>x</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Values of cosine of the
inclination, <span class="math notranslate nohighlight">\(x=\cos{I}\)</span>. Please note this is different from
<span class="math notranslate nohighlight">\(Y=\cos{\iota}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Separatrix value with shape based on input shapes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D array or scalar</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.get_at_t">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">get_at_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_of_interest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.881784197001252e-16</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.get_at_t" title="Link to this definition"></a></dt>
<dd><p>Root finding wrapper using Brent’s method.</p>
<p>This function uses scipy’s brentq routine to find root.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj_module</strong> (<em>obj</em>) – Instantiated trajectory module. It must output
the time array of the trajectory sparse trajectory as the first
output value in the tuple.</p></li>
<li><p><strong>traj_args</strong> (<em>list</em>) – List of arguments for the trajectory function.
p is removed. <strong>Note</strong>: It must be a list, not a tuple because the
new p values are inserted into the argument list.</p></li>
<li><p><strong>bounds</strong> (<em>list</em>) – Minimum and maximum values over which brentq will search for a root.</p></li>
<li><p><strong>t_out</strong> (<em>double</em>) – The desired length of time for the waveform.</p></li>
<li><p><strong>index_of_interest</strong> (<em>int</em>) – Index where to insert the new values in
the <code class="code docutils literal notranslate"><span class="pre">traj_args</span></code> list.</p></li>
<li><p><strong>traj_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for <code class="code docutils literal notranslate"><span class="pre">traj_module</span></code>.
Default is an empty dict.</p></li>
<li><p><strong>xtol</strong> (<em>float</em><em>, </em><em>optional</em>) – Absolute tolerance of the brentq root-finding - see :code: <cite>np.allclose()</cite> for details.
Defaults to 2e-12 (scipy default).</p></li>
<li><p><strong>rtol</strong> (<em>float</em><em>, </em><em>optional</em>) – Relative tolerance of the brentq root-finding - see :code: <cite>np.allclose()</cite> for details.
Defaults to ~8.8e-16 (scipy default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Root value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.get_p_at_t">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">get_p_at_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_of_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_of_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_of_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_of_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.get_p_at_t" title="Link to this definition"></a></dt>
<dd><p>Find the value of p that will give a specific length inspiral using Brent’s method.</p>
<p>If you want to generate an inspiral that is a specific length, you
can adjust p accordingly. This function tells you what that value of p
is based on the trajectory module and other input parameters at a
desired time of observation.</p>
<p>This function uses scipy’s brentq routine to find the (presumed only)
value of p that gives a trajectory of duration t_out.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj_module</strong> (<em>obj</em>) – Instantiated trajectory module. It must output
the time array of the trajectory sparse trajectory as the first
output value in the tuple.</p></li>
<li><p><strong>t_out</strong> (<em>double</em>) – The desired length of time for the waveform.</p></li>
<li><p><strong>traj_args</strong> (<em>list</em>) – List of arguments for the trajectory function.
p is removed. <strong>Note</strong>: It must be a list, not a tuple because the
new p values are inserted into the argument list.</p></li>
<li><p><strong>index_of_p</strong> (<em>int</em><em>, </em><em>optional</em>) – Index where to insert the new p values in
the <code class="code docutils literal notranslate"><span class="pre">traj_args</span></code> list. Default is 3.</p></li>
<li><p><strong>index_of_a</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of a in provided <code class="code docutils literal notranslate"><span class="pre">traj_module</span></code> arguments. Default is 2.</p></li>
<li><p><strong>index_of_e</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of e0 in provided <code class="code docutils literal notranslate"><span class="pre">traj_module</span></code> arguments. Default is 4.</p></li>
<li><p><strong>index_of_x</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of x0 in provided <code class="code docutils literal notranslate"><span class="pre">traj_module</span></code> arguments. Default is 5.</p></li>
<li><p><strong>bounds</strong> (<em>list</em><em>, </em><em>optional</em>) – Minimum and maximum values of p over which brentq will search for a root.
If not given, will be set to [separatrix + 0.101, 50]. To supply only one of these two limits, set the
other limit to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for <a class="reference internal" href="#few.utils.utility.get_at_t" title="few.utils.utility.get_at_t"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_at_t()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of p that creates the proper length trajectory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.get_mu_at_t">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">get_mu_at_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_of_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.get_mu_at_t" title="Link to this definition"></a></dt>
<dd><p>Find the value of mu that will give a specific length inspiral using Brent’s method.</p>
<p>If you want to generate an inspiral that is a specific length, you
can adjust mu accordingly. This function tells you what that value of mu
is based on the trajectory module and other input parameters at a
desired time of observation.</p>
<p>This function uses scipy’s brentq routine to find the (presumed only)
value of mu that gives a trajectory of duration t_out.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj_module</strong> (<em>obj</em>) – Instantiated trajectory module. It must output
the time array of the trajectory sparse trajectory as the first
output value in the tuple.</p></li>
<li><p><strong>t_out</strong> (<em>double</em>) – The desired length of time for the waveform.</p></li>
<li><p><strong>traj_args</strong> (<em>list</em>) – List of arguments for the trajectory function.
p is removed. <strong>Note</strong>: It must be a list, not a tuple because the
new p values are inserted into the argument list.</p></li>
<li><p><strong>index_of_mu</strong> (<em>int</em><em>, </em><em>optional</em>) – Index where to insert the new p values in
the <code class="code docutils literal notranslate"><span class="pre">traj_args</span></code> list. Default is 1.</p></li>
<li><p><strong>bounds</strong> (<em>list</em><em>, </em><em>optional</em>) – Minimum and maximum values of p over which brentq will search for a root.
If not given, will be set to [1e-1, 1e3]. To supply only one of these two limits, set the
other limit to None.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for <a class="reference internal" href="#few.utils.utility.get_at_t" title="few.utils.utility.get_at_t"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_at_t()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of mu that creates the proper length trajectory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.check_for_file_download">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">check_for_file_download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.check_for_file_download" title="Link to this definition"></a></dt>
<dd><p>Download files direct from download.bhptoolkit.org.</p>
<p>This function downloads the files from download.bhptoolkit.org as they are needed. They are
downloaded based on the associated Zenodo record for each version (<cite>record_by_version</cite>).</p>
<p>The version is determined from the <cite>__version__</cite> attribute of <cite>few</cite> unless
a version string is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>string</em>) – File name.</p></li>
<li><p><strong>few_dir</strong> (<em>string</em>) – absolute path to FastEMRIWaveforms directory.</p></li>
<li><p><strong>version_string</strong> (<em>string</em><em>, </em><em>optional</em>) – Provide a specific version string to
get a specific dataset. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Version string does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.wrapper">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.wrapper" title="Link to this definition"></a></dt>
<dd><p>Function to convert array and C/C++ class arguments to ptrs</p>
<p>This function checks the object type. If it is a cupy or numpy array,
it will determine its pointer by calling the proper attributes. If you design
a Cython class to be passed through python, it must have a <code class="code docutils literal notranslate"><span class="pre">ptr</span></code>
attribute.</p>
<p>If you use this function, you must convert input arrays to size_t data type in Cython and
then properly cast the pointer as it enters the c++ function. See the
Cython codes
<a class="reference external" href="https://github.com/BlackHolePerturbationToolkit/FastEMRIWaveforms/tree/master/src">here</a>
for examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em>) – list of the arguments for a function.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – dictionary of keyword arguments to be converted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(targs, tkwargs) where t indicates target (with pointer values</dt><dd><p>rather than python objects).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.pointer_adjust">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">pointer_adjust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.pointer_adjust" title="Link to this definition"></a></dt>
<dd><p>Decorator function for cupy/numpy agnostic cython</p>
<p>This decorator applies <a class="reference internal" href="#few.utils.utility.wrapper" title="few.utils.utility.wrapper"><code class="xref py py-func docutils literal notranslate"><span class="pre">few.utils.utility.wrapper()</span></code></a> to functions
via the decorator construction.</p>
<p>If you use this decorator, you must convert input arrays to size_t data type in Cython and
then properly cast the pointer as it enters the c++ function. See the
Cython codes
<a class="reference external" href="https://github.com/BlackHolePerturbationToolkit/FastEMRIWaveforms/tree/master/src">here</a>
for examples.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.utility.cuda_set_device">
<span class="sig-prename descclassname"><span class="pre">few.utils.utility.</span></span><span class="sig-name descname"><span class="pre">cuda_set_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.utility.cuda_set_device" title="Link to this definition"></a></dt>
<dd><p>Globally sets CUDA device</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dev</strong> (<em>int</em>) – CUDA device number.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="elliptic-integrals-legendre-and-carlson-symmetric-forms">
<h2>Elliptic integrals (Legendre and Carlson symmetric forms)<a class="headerlink" href="#elliptic-integrals-legendre-and-carlson-symmetric-forms" title="Link to this heading"></a></h2>
<p id="module-few.utils.elliptic">Efficient implementations of complete elliptic integrals, obtained by applying
the duplication theorem to compute Carlson’s symmetric forms.</p>
<p>Derived from Carlson’s algorithms in the SLATEC library.</p>
<dl class="py function">
<dt class="sig sig-object py" id="few.utils.elliptic.RF">
<span class="sig-prename descclassname"><span class="pre">few.utils.elliptic.</span></span><span class="sig-name descname"><span class="pre">RF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#few.utils.elliptic.RF" title="Link to this definition"></a></dt>
<dd><p>Computes the Carlson symmetric form of the
elliptic integral of the first kind, <span class="math notranslate nohighlight">\(R_F\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – First argument, <span class="math notranslate nohighlight">\(x &gt;= 0\)</span>.</p></li>
<li><p><strong>y</strong> – Second argument, <span class="math notranslate nohighlight">\(y &gt;= 0\)</span>.</p></li>
<li><p><strong>z</strong> – Third argument, <span class="math notranslate nohighlight">\(z &gt;= 0\)</span>.</p></li>
<li><p><strong>tol</strong> – Numerical tolerance parameter (defaults to 5e-4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Carlson symmetric form <span class="math notranslate nohighlight">\(R_F\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.elliptic.RC">
<span class="sig-prename descclassname"><span class="pre">few.utils.elliptic.</span></span><span class="sig-name descname"><span class="pre">RC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#few.utils.elliptic.RC" title="Link to this definition"></a></dt>
<dd><p>Computes the reduced Carlson symmetric form of the
elliptic integral of the first kind, <span class="math notranslate nohighlight">\(R_C\)</span>.</p>
<p>Unlike the other Carlson symmetric forms provided, this one
can be computed analytically in terms of transcendental functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – First argument, <span class="math notranslate nohighlight">\(x &gt;= 0\)</span>.</p></li>
<li><p><strong>y</strong> – Second argument, <span class="math notranslate nohighlight">\(y &gt;= 0\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Carlson symmetric form <span class="math notranslate nohighlight">\(R_J\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.elliptic.RJ">
<span class="sig-prename descclassname"><span class="pre">few.utils.elliptic.</span></span><span class="sig-name descname"><span class="pre">RJ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#few.utils.elliptic.RJ" title="Link to this definition"></a></dt>
<dd><p>Computes the Carlson symmetric form of the
elliptic integral of the second kind, <span class="math notranslate nohighlight">\(R_J\)</span>.</p>
<p>No more than one of <span class="math notranslate nohighlight">\((x, y, z)\)</span> may be equal to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – First argument, <span class="math notranslate nohighlight">\(x &gt;= 0\)</span>.</p></li>
<li><p><strong>y</strong> – Second argument, <span class="math notranslate nohighlight">\(y &gt;= 0\)</span>.</p></li>
<li><p><strong>z</strong> – Third argument, <span class="math notranslate nohighlight">\(z &gt;= 0\)</span>.</p></li>
<li><p><strong>p</strong> – Fourth argument, <span class="math notranslate nohighlight">\(p &gt; 0\)</span>.</p></li>
<li><p><strong>tol</strong> – Numerical tolerance parameter (defaults to 5e-4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Carlson symmetric form <span class="math notranslate nohighlight">\(R_J\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.elliptic.RD">
<span class="sig-prename descclassname"><span class="pre">few.utils.elliptic.</span></span><span class="sig-name descname"><span class="pre">RD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#few.utils.elliptic.RD" title="Link to this definition"></a></dt>
<dd><p>Computes the reduced Carlson symmetric form of the
elliptic integral of the second kind, <span class="math notranslate nohighlight">\(R_D\)</span>.</p>
<p>It is a requirement that <span class="math notranslate nohighlight">\(x+y &gt; 0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – First argument, <span class="math notranslate nohighlight">\(x &gt;= 0\)</span>.</p></li>
<li><p><strong>y</strong> – Second argument, <span class="math notranslate nohighlight">\(y &gt;= 0\)</span>.</p></li>
<li><p><strong>z</strong> – Third argument, <span class="math notranslate nohighlight">\(z &gt; 0\)</span>.</p></li>
<li><p><strong>tol</strong> – Numerical tolerance parameter (defaults to 5e-4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Carlson symmetric form <span class="math notranslate nohighlight">\(R_D\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.elliptic.EllipK">
<span class="sig-prename descclassname"><span class="pre">few.utils.elliptic.</span></span><span class="sig-name descname"><span class="pre">EllipK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#few.utils.elliptic.EllipK" title="Link to this definition"></a></dt>
<dd><p>Computes the complete elliptic integral of the first kind, <span class="math notranslate nohighlight">\(K(k)\)</span>.</p>
<p>Switches to a polynomial approximation from Abramowitz &amp; Stegun
for <span class="math notranslate nohighlight">\(k &gt; 1 - 10^{-10}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> – The elliptic modulus, where <cite>k in [0, 1]</cite>.</p></li>
<li><p><strong>tol</strong> – Numerical tolerance parameter (defaults to 5e-4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The complete elliptic integral <span class="math notranslate nohighlight">\(K(k)\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.elliptic.EllipE">
<span class="sig-prename descclassname"><span class="pre">few.utils.elliptic.</span></span><span class="sig-name descname"><span class="pre">EllipE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#few.utils.elliptic.EllipE" title="Link to this definition"></a></dt>
<dd><p>Computes the complete elliptic integral of the second kind, <span class="math notranslate nohighlight">\(E(k)\)</span>.</p>
<p>Switches to a polynomial approximation from Abramowitz &amp; Stegun
for <span class="math notranslate nohighlight">\(k &gt; 1 - 10^{-10}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> – The elliptic modulus, where <cite>k in [0, 1]</cite>.</p></li>
<li><p><strong>tol</strong> – Numerical tolerance parameter (defaults to 5e-4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The complete elliptic integral <span class="math notranslate nohighlight">\(E(k)\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.elliptic.EllipPi">
<span class="sig-prename descclassname"><span class="pre">few.utils.elliptic.</span></span><span class="sig-name descname"><span class="pre">EllipPi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#few.utils.elliptic.EllipPi" title="Link to this definition"></a></dt>
<dd><p>Computes the complete elliptic integral of the third kind, <span class="math notranslate nohighlight">\(\Pi(n, k)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – The characteristic.</p></li>
<li><p><strong>k</strong> – The elliptic modulus, where <cite>k in [0, 1]</cite>.</p></li>
<li><p><strong>tol</strong> – Numerical tolerance parameter (defaults to 5e-4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The complete elliptic integral <span class="math notranslate nohighlight">\(\Pi(n, k)\)</span>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pn-parameter-mapping-utilities">
<h2>PN Parameter Mapping Utilities<a class="headerlink" href="#pn-parameter-mapping-utilities" title="Link to this heading"></a></h2>
<dl class="py function" id="module-few.utils.pn_map">
<dt class="sig sig-object py" id="few.utils.pn_map.Y_to_xI">
<span class="sig-prename descclassname"><span class="pre">few.utils.pn_map.</span></span><span class="sig-name descname"><span class="pre">Y_to_xI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="headerlink" href="#few.utils.pn_map.Y_to_xI" title="Link to this definition"></a></dt>
<dd><p>Convert from <span class="math notranslate nohighlight">\(Y=\cos{\iota}\)</span> to <span class="math notranslate nohighlight">\(x_I=\cos{I}\)</span>.</p>
<p>Converts between the two different inclination parameters. <span class="math notranslate nohighlight">\(\cos{I}\equiv x_I\)</span>,
where <span class="math notranslate nohighlight">\(I\)</span> describes the orbit’s inclination from the equatorial plane.
<span class="math notranslate nohighlight">\(\cos{\iota}\equiv Y\)</span>, where <span class="math notranslate nohighlight">\(\cos{\iota}=L/\sqrt{L^2 + Q}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Dimensionless spin of massive
black hole. If other parameters are arrays and the spin is scalar,
it will be cast to a 1D array.</p></li>
<li><p><strong>p</strong> (<em>double scalar</em><em> or </em><em>1D double np.ndarray</em>) – Values of separation,
<span class="math notranslate nohighlight">\(p\)</span>.</p></li>
<li><p><strong>e</strong> (<em>double scalar</em><em> or </em><em>1D double np.ndarray</em>) – Values of eccentricity,
<span class="math notranslate nohighlight">\(e\)</span>.</p></li>
<li><p><strong>Y</strong> (<em>double scalar</em><em> or </em><em>1D double np.ndarray</em>) – Values of cosine of the
<span class="math notranslate nohighlight">\(\iota\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(x=\cos{I}\)</span> value with shape based on input shapes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D array or scalar</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="few.utils.pn_map.xI_to_Y">
<span class="sig-prename descclassname"><span class="pre">few.utils.pn_map.</span></span><span class="sig-name descname"><span class="pre">xI_to_Y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="headerlink" href="#few.utils.pn_map.xI_to_Y" title="Link to this definition"></a></dt>
<dd><p>Convert from <span class="math notranslate nohighlight">\(x_I=\cos{I}\)</span> to <span class="math notranslate nohighlight">\(Y=\cos{\iota}\)</span>.</p>
<p>Converts between the two different inclination parameters. <span class="math notranslate nohighlight">\(\cos{I}\equiv x_I\)</span>,
where <span class="math notranslate nohighlight">\(I\)</span> describes the orbit’s inclination from the equatorial plane.
<span class="math notranslate nohighlight">\(\cos{\iota}\equiv Y\)</span>, where <span class="math notranslate nohighlight">\(\cos{\iota}=L/\sqrt{L^2 + Q}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>double scalar</em><em> or </em><em>1D np.ndarray</em>) – Dimensionless spin of massive
black hole. If other parameters are arrays and the spin is scalar,
it will be cast to a 1D array.</p></li>
<li><p><strong>p</strong> (<em>double scalar</em><em> or </em><em>1D double np.ndarray</em>) – Values of separation,
<span class="math notranslate nohighlight">\(p\)</span>.</p></li>
<li><p><strong>e</strong> (<em>double scalar</em><em> or </em><em>1D double np.ndarray</em>) – Values of eccentricity,
<span class="math notranslate nohighlight">\(e\)</span>.</p></li>
<li><p><strong>x</strong> (<em>double scalar</em><em> or </em><em>1D double np.ndarray</em>) – Values of cosine of the
inclination, <span class="math notranslate nohighlight">\(x=\cos{I}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(Y=\cos{\iota}\)</span> value with shape based on input shapes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D array or scalar</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sum.html" class="btn btn-neutral float-left" title="Summation Package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cite.html" class="btn btn-neutral float-right" title="Citations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Michael Katz, Alvin Chua, Niels Warburton.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>