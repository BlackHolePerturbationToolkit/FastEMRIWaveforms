

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trajectory Package &mdash; few: Fast EMRI Waveforms 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Amplitude Package" href="amp.html" />
    <link rel="prev" title="Overall Waveform Models" href="main.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> few: Fast EMRI Waveforms
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="main.html">Overall Waveform Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Trajectory Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-few.trajectory.inspiral">Generic Inspiral Generator from C/C++ functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="amp.html">Amplitude Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="sum.html">Summation Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">Citations</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html">Fast and Accurate EMRI Waveforms Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Full-EMRI-Waveforms-in-Schwarzschild-Eccentric">Full EMRI Waveforms in Schwarzschild Eccentric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Trajectory-Module">Trajectory Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Amplitude-Module">Amplitude Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Spin-weighted-spherical-harmonics">Spin-weighted spherical harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Mode-Selection">Mode Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Parallelized-Cubic-Spline-Interpolation">Parallelized Cubic Spline Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Mode-Summation">Mode Summation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Utility-functions">Utility functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Creating-modules">Creating modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Augmented-Analytic-Kludge-with-5PN-trajectory">Augmented Analytic Kludge with 5PN trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Citing-waveforms-and-modules">Citing waveforms and modules</a></li>
</ul>
<p class="caption"><span class="caption-text">General Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html">FastEMRIWaveforms Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html#package-todos">Package TODOs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html#change-log">Change Log</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">few: Fast EMRI Waveforms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Trajectory Package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/traj.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="amp.html" class="btn btn-neutral float-right" title="Amplitude Package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="main.html" class="btn btn-neutral float-left" title="Overall Waveform Models" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-few.trajectory">
<span id="trajectory-package"></span><span id="trajectory-label"></span><h1>Trajectory Package<a class="headerlink" href="#module-few.trajectory" title="Permalink to this headline">¶</a></h1>
<p>The trajectory package houses modules that turn initial orbital parameters into
phase-space trajectories (orbital phases and orbital parameters). These are
determined by numerical integrators that interpolate over the relevant
quantities.</p>
<dl class="py class">
<dt id="few.utils.baseclasses.TrajectoryBase">
<em class="property">class </em><code class="sig-prename descclassname">few.utils.baseclasses.</code><code class="sig-name descname">TrajectoryBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class used for trajectory modules.</p>
<p>This class provides a flexible interface to various trajectory
implementations. Specific arguments to each trajectory can be found with
each associated trajectory module discussed below.</p>
<dl class="py method">
<dt id="few.utils.baseclasses.TrajectoryBase.citation">
<em class="property">property </em><code class="sig-name descname">citation</code><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase.citation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return citation for this class</p>
</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.TrajectoryBase.get_inspiral">
<em class="property">classmethod </em><code class="sig-name descname">get_inspiral</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase.get_inspiral" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspiral Generator</p>
<p>&#64;classmethod that requires a child class to have a get_inspiral method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>t, p, e, Phi_phi, Phi_r, flux with shape:</dt><dd><p>(params, traj length).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>2D double np.ndarray</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – The child class does not have this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.TrajectoryBase.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">in_coordinate_time</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">new_t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spline_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">DENSE_STEPPING</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">max_init_len</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">upsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">err</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">use_rk4</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fix_t</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for trajectory interface.</p>
<p>This is the function for calling the creation of the
trajectory. Inputs define the output time spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em>) – Input of variable number of arguments specific to the
inspiral model (see the trajectory class’ <cite>get_inspiral</cite> method).
<strong>Important Note</strong>: M must be the first parameter of any model
that uses this base class.</p></li>
<li><p><strong>in_coordinate_time</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the trajectory will be
outputted in coordinate time. If False, the trajectory will be
outputted in units of M. Default is True.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time step for output waveform in seconds. Also sets
initial step for integrator. Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years. Sets the maximum time
for the integrator to run. Default is 1.0.</p></li>
<li><p><strong>new_t</strong> (<em>1D np.ndarray</em><em>, </em><em>optional</em>) – If given, this represents the final
time array at which the trajectory is analyzed. This is
performed by using a cubic spline on the integrator output.
Default is None.</p></li>
<li><p><strong>spline_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – If using upsampling, spline_kwargs
provides the kwargs desired for scipy.interpolate.CubicSpline.
Default is {}.</p></li>
<li><p><strong>DENSE_STEPPING</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, the trajectory used in the
integrator will be densely stepped at steps of <code class="xref py py-obj docutils literal notranslate"><span class="pre">dt</span></code>. If 0,
the integrator will determine its stepping. Default is 0.</p></li>
<li><p><strong>max_init_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Sets the allocation of memory for
trajectory parameters. This should be the maximum length
expected for a trajectory. Trajectories with default settings
will be ~100 points. Default is 1000.</p></li>
<li><p><strong>upsample</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, upsample, with a cubic spline,
the trajectories from 0 to T in steps of dt. Default is False.</p></li>
<li><p><strong>err</strong> (<em>double</em><em>, </em><em>optional</em>) – Tolerance for integrator. Default is 1e-10.
Decreasing this parameter will give more steps over the
trajectory, but if it is too small, memory issues will occur as
the trajectory length will blow up. We recommend not adjusting
this parameter.</p></li>
<li><p><strong>fix_T</strong> (<em>bool</em><em>, </em><em>optional</em>) – If upsampling, this will affect excess
points in the t array. If True, it will shave any excess on the
trajectories arrays where the time is greater than the overall
time of the trajectory requested.</p></li>
<li><p><strong>use_rk4</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use rk4 integrator from gsl.
If False, use rk8. Default is False (rk8).</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs passed to trajectory module.
Default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, Phi_phi, Phi_r, flux_norm).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input parameters are not allowed in this model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="module-few.trajectory.inspiral">
<span id="generic-inspiral-generator-from-c-c-functions"></span><h2>Generic Inspiral Generator from C/C++ functions<a class="headerlink" href="#module-few.trajectory.inspiral" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="few.trajectory.inspiral.EMRIInspiral">
<em class="property">class </em><code class="sig-prename descclassname">few.trajectory.inspiral.</code><code class="sig-name descname">EMRIInspiral</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">func</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">enforce_schwarz_sep</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a></p>
<p>EMRI trajectory module.</p>
<p>This module implements generic trajectories by integrating with an
RK8 integrator. It can also adjust the output time-spacing using
cubic spline interpolation. Additionally, it gives the option for
a dense trajectory, which integrates the trajectory at the user-defined
timestep.</p>
<p>The trajectory operates on generic ODE functions that are defined in
<code class="code docutils literal notranslate"><span class="pre">src/ode_base.cc</span></code> and <code class="code docutils literal notranslate"><span class="pre">include/ode_base.hh</span></code>. The ODE can be either
a function or a C++ class that has constructor function, destructor function,
and function for get the derivatives called <code class="code docutils literal notranslate"><span class="pre">deriv_func</span></code>. Implemented examples
for the Schwarzchild eccentric flux-based trajectory (ODE class) and
the 5PN trajecotry (ODE function) can be found in the <code class="code docutils literal notranslate"><span class="pre">ode_base</span></code> files.
The ODE as a function or the <code class="code docutils literal notranslate"><span class="pre">deriv_func</span></code> method must take an exact
set of arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">__deriv__</span>
<span class="n">func</span><span class="p">(</span><span class="n">double</span><span class="o">*</span> <span class="n">pdot</span><span class="p">,</span> <span class="n">double</span><span class="o">*</span> <span class="n">edot</span><span class="p">,</span> <span class="n">double</span><span class="o">*</span> <span class="n">xdot</span><span class="p">,</span>
     <span class="n">double</span><span class="o">*</span> <span class="n">Omega_phi</span><span class="p">,</span> <span class="n">double</span><span class="o">*</span> <span class="n">Omega_theta</span><span class="p">,</span> <span class="n">double</span><span class="o">*</span> <span class="n">Omega_r</span><span class="p">,</span>
     <span class="n">double</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">double</span> <span class="n">a</span><span class="p">,</span> <span class="n">double</span> <span class="n">p</span><span class="p">,</span> <span class="n">double</span> <span class="n">e</span><span class="p">,</span> <span class="n">double</span> <span class="n">Y</span><span class="p">,</span> <span class="n">double</span><span class="o">*</span> <span class="n">additional_args</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">pdot,</span> <span class="pre">edot,</span> <span class="pre">xdot,</span> <span class="pre">Omega_phi,</span> <span class="pre">Omega_theta</span></code>
The <code class="code docutils literal notranslate"><span class="pre">__deriv__</span></code> decorator let’s the installer know which functions are actually the
derivative functions, in case there are other auxillary functions in the file.
The user then uses <code class="code docutils literal notranslate"><span class="pre">#define</span></code> lines to indicate to the code limitations
or settings specific to that ODE. See the tutorial documentation for more detail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>str</em>) – Function name for the ode to use in the integration.
This must be given as a keyword argument, even though it is required. To get
the options for this argument, use <a class="reference internal" href="util.html#few.utils.utility.get_ode_function_options" title="few.utils.utility.get_ode_function_options"><code class="xref py py-func docutils literal notranslate"><span class="pre">few.utils.utility.get_ode_function_options()</span></code></a>.
Stock options include <code class="code docutils literal notranslate"><span class="pre">&quot;SchwarzEccFlux&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">&quot;pn5&quot;</span></code>.</p></li>
<li><p><strong>enforce_schwarz_sep</strong> (<em>bool</em><em>, </em><em>optional</em>) – Enforce the separatrix of Schwarzschild
spacetime. This helps to midigate issues at higher spin and/or higher
eccentricity where the PN approximations are more likely to fail.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – Any arguments for parent
class <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> or
class <a class="reference internal" href="main.html#few.utils.baseclasses.Pn5AAK" title="few.utils.baseclasses.Pn5AAK"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.Pn5AAK</span></code></a>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any keyword arguments for parent
class <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> or
class <a class="reference internal" href="main.html#few.utils.baseclasses.Pn5AAK" title="few.utils.baseclasses.Pn5AAK"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.Pn5AAK</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.num_add_args">
<code class="sig-name descname">num_add_args</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.num_add_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of additional arguments for the ODE function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.background" title="Permalink to this definition">¶</a></dt>
<dd><p>“Either Schwarzschild” or “Kerr”.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.equatorial">
<code class="sig-name descname">equatorial</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.equatorial" title="Permalink to this definition">¶</a></dt>
<dd><p>True if equatorial orbit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.circular">
<code class="sig-name descname">circular</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.circular" title="Permalink to this definition">¶</a></dt>
<dd><p>True if circular orbit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.convert_Y">
<code class="sig-name descname">convert_Y</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.convert_Y" title="Permalink to this definition">¶</a></dt>
<dd><p>If the ODE is integrated in <span class="math notranslate nohighlight">\(Y\)</span> rather than
<span class="math notranslate nohighlight">\(x_I\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.files">
<code class="sig-name descname">files</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.files" title="Permalink to this definition">¶</a></dt>
<dd><p>List of files necessary for this ODE.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.citations">
<code class="sig-name descname">citations</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.citations" title="Permalink to this definition">¶</a></dt>
<dd><p>list of additional citations for this ODE.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.enforce_schwarz_sep">
<code class="sig-name descname">enforce_schwarz_sep</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.enforce_schwarz_sep" title="Permalink to this definition">¶</a></dt>
<dd><p>Enforce the separatrix of Schwarzschild
spacetime.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.inspiral_generator">
<code class="sig-name descname">inspiral_generator</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.inspiral_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspiral C/C++ wrapped function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>func</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.func">
<code class="sig-name descname">func</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.func" title="Permalink to this definition">¶</a></dt>
<dd><p>ODE function name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.inspiral.EMRIInspiral.specific_kwarg_keys">
<code class="sig-name descname">specific_kwarg_keys</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.specific_kwarg_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Specific keywords that need to transferred
to the inspiral function that can be adjusted with each call.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – <code class="code docutils literal notranslate"><span class="pre">func</span></code> kwarg not given or not available.</p></li>
<li><p><strong>ValueError</strong> – File necessary for ODE not found.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.trajectory.inspiral.EMRIInspiral.attributes_EMRIInspiral">
<code class="sig-name descname">attributes_EMRIInspiral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.attributes_EMRIInspiral" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="id0">
<code class="sig-name descname">inspiral_generator</code><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>C++ class for inspiral trajectory generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id1">
<code class="sig-name descname">specific_kwarg_keys</code><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>specific kwargs from
<a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> that apply to this
inspiral generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.trajectory.inspiral.EMRIInspiral.citation">
<em class="property">property </em><code class="sig-name descname">citation</code><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.citation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return citation for this class</p>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.inspiral.EMRIInspiral.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">in_coordinate_time</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">new_t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spline_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">DENSE_STEPPING</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">max_init_len</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">upsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">err</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">use_rk4</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fix_t</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for trajectory interface.</p>
<p>This is the function for calling the creation of the
trajectory. Inputs define the output time spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em>) – Input of variable number of arguments specific to the
inspiral model (see the trajectory class’ <cite>get_inspiral</cite> method).
<strong>Important Note</strong>: M must be the first parameter of any model
that uses this base class.</p></li>
<li><p><strong>in_coordinate_time</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the trajectory will be
outputted in coordinate time. If False, the trajectory will be
outputted in units of M. Default is True.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time step for output waveform in seconds. Also sets
initial step for integrator. Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years. Sets the maximum time
for the integrator to run. Default is 1.0.</p></li>
<li><p><strong>new_t</strong> (<em>1D np.ndarray</em><em>, </em><em>optional</em>) – If given, this represents the final
time array at which the trajectory is analyzed. This is
performed by using a cubic spline on the integrator output.
Default is None.</p></li>
<li><p><strong>spline_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – If using upsampling, spline_kwargs
provides the kwargs desired for scipy.interpolate.CubicSpline.
Default is {}.</p></li>
<li><p><strong>DENSE_STEPPING</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, the trajectory used in the
integrator will be densely stepped at steps of <code class="xref py py-obj docutils literal notranslate"><span class="pre">dt</span></code>. If 0,
the integrator will determine its stepping. Default is 0.</p></li>
<li><p><strong>max_init_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Sets the allocation of memory for
trajectory parameters. This should be the maximum length
expected for a trajectory. Trajectories with default settings
will be ~100 points. Default is 1000.</p></li>
<li><p><strong>upsample</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, upsample, with a cubic spline,
the trajectories from 0 to T in steps of dt. Default is False.</p></li>
<li><p><strong>err</strong> (<em>double</em><em>, </em><em>optional</em>) – Tolerance for integrator. Default is 1e-10.
Decreasing this parameter will give more steps over the
trajectory, but if it is too small, memory issues will occur as
the trajectory length will blow up. We recommend not adjusting
this parameter.</p></li>
<li><p><strong>fix_T</strong> (<em>bool</em><em>, </em><em>optional</em>) – If upsampling, this will affect excess
points in the t array. If True, it will shave any excess on the
trajectories arrays where the time is greater than the overall
time of the trajectory requested.</p></li>
<li><p><strong>use_rk4</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use rk4 integrator from gsl.
If False, use rk8. Default is False (rk8).</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs passed to trajectory module.
Default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, Phi_phi, Phi_r, flux_norm).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input parameters are not allowed in this model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.inspiral.EMRIInspiral.get_inspiral">
<code class="sig-name descname">get_inspiral</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">Phi_phi0</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">Phi_theta0</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">Phi_r0</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.inspiral.EMRIInspiral.get_inspiral" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the inspiral.</p>
<p>This is the function for calling the creation of the trajectory.
Inputs define the output time spacing.</p>
<p>This class can be used on its own. However, it is generally accessed
through the __call__ method associated with its base class:
(<a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Mass of massive black hole in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – Mass of compact object in solar masses.</p></li>
<li><p><strong>a</strong> (<em>double</em>) – Dimensionless spin of massive black hole.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semi-latus rectum in terms units of M (p/M).</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity (dimensionless).</p></li>
<li><p><strong>x0</strong> (<em>double</em>) – Initial <span class="math notranslate nohighlight">\(\cos{\iota}\)</span>. <strong>Note</strong>: This value is different from <span class="math notranslate nohighlight">\(x_I\)</span></p></li>
<li><p><strong>in the relativistic waveforms.</strong> (<em>used</em>) – </p></li>
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – Added for flexibility.</p></li>
<li><p><strong>Phi_phi0</strong> (<em>double</em><em>, </em><em>optional</em>) – Initial phase for <span class="math notranslate nohighlight">\(\Phi_\phi\)</span>.
Default is 0.0.</p></li>
<li><p><strong>Phi_theta0</strong> (<em>double</em><em>, </em><em>optional</em>) – Initial phase for <span class="math notranslate nohighlight">\(\Phi_\Theta\)</span>.
Default is 0.0.</p></li>
<li><p><strong>Phi_r0</strong> (<em>double</em><em>, </em><em>optional</em>) – Initial phase for <span class="math notranslate nohighlight">\(\Phi_r\)</span>.
Default is 0.0.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs passed from parent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, x, Phi_phi, Phi_theta, Phi_r).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="amp.html" class="btn btn-neutral float-right" title="Amplitude Package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="main.html" class="btn btn-neutral float-left" title="Overall Waveform Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Michael Katz, Alvin Chua, Niels Warburton

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>