

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trajectory Package &mdash; few: Fast EMRI Waveforms 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Amplitude Package" href="amp.html" />
    <link rel="prev" title="Overall Waveform Models" href="main.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> few: Fast EMRI Waveforms
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="main.html">Overall Waveform Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Trajectory Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-few.trajectory.flux">Flux Inspiral</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="amp.html">Amplitude Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="sum.html">Summation Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">Citations</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html">Fast and Accurate EMRI Waveforms Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html#Full-EMRI-Waveforms">Full EMRI Waveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html#Trajectory-Module">Trajectory Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html#Amplitude-Module">Amplitude Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html#Spin-weighted-spherical-harmonics">Spin-weighted spherical harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html#Mode-Selection">Mode Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html#Parallelized-Cubic-Spline-Interpolation">Parallelized Cubic Spline Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html#Mode-Summation">Mode Summation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html#Creating-modules">Creating modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/SchwarzschildEccentricWaveform_intro.html#Citing-waveforms-and-modules">Citing waveforms and modules</a></li>
</ul>
<p class="caption"><span class="caption-text">General Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html">FastEMRIWaveforms Publication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html#package-todos">Package TODOs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">few: Fast EMRI Waveforms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Trajectory Package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/traj.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="amp.html" class="btn btn-neutral float-right" title="Amplitude Package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="main.html" class="btn btn-neutral float-left" title="Overall Waveform Models" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-few.trajectory">
<span id="trajectory-package"></span><span id="trajectory-label"></span><h1>Trajectory Package<a class="headerlink" href="#module-few.trajectory" title="Permalink to this headline">¶</a></h1>
<p>The trajectory package houses modules that turn initial orbital parameters into
phase-space trajectories (orbital phases and orbital parameters). These are
determined by numerical integrators that interpolate over the relevant
quantities.</p>
<dl class="py class">
<dt id="few.utils.baseclasses.TrajectoryBase">
<em class="property">class </em><code class="sig-prename descclassname">few.utils.baseclasses.</code><code class="sig-name descname">TrajectoryBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class used for trajectory modules.</p>
<p>This class provides a flexible interface to various trajectory
implementations. Specific arguments to each trajectory can be found with
each associated trajectory module discussed below.</p>
<dl class="py method">
<dt id="few.utils.baseclasses.TrajectoryBase.citation">
<em class="property">property </em><code class="sig-name descname">citation</code><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase.citation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return citation for this class</p>
</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.TrajectoryBase.get_inspiral">
<em class="property">classmethod </em><code class="sig-name descname">get_inspiral</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase.get_inspiral" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspiral Generator</p>
<p>&#64;classmethod that requires a child class to have a get_inspiral method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>t, p, e, Phi_phi, Phi_r, flux with shape:</dt><dd><p>(params, traj length).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>2D double np.ndarray</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – The child class does not have this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.TrajectoryBase.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">in_coordinate_time</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">new_t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spline_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">DENSE_STEPPING</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">max_init_len</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">upsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">err</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">use_rk4</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fix_t</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for trajectory interface.</p>
<p>This is the function for calling the creation of the
trajectory. Inputs define the output time spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em>) – Input of variable number of arguments specific to the
inspiral model (see the trajectory class’ <cite>get_inspiral</cite> method).
<strong>Important Note</strong>: M must be the first parameter of any model
that uses this base class.</p></li>
<li><p><strong>in_coordinate_time</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the trajectory will be
outputted in coordinate time. If False, the trajectory will be
outputted in units of M. Default is True.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time step for output waveform in seconds. Also sets
initial step for integrator. Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years. Sets the maximum time
for the integrator to run. Default is 1.0.</p></li>
<li><p><strong>new_t</strong> (<em>1D np.ndarray</em><em>, </em><em>optional</em>) – If given, this represents the final
time array at which the trajectory is analyzed. This is
performed by using a cubic spline on the integrator output.
Default is None.</p></li>
<li><p><strong>spline_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – If using upsampling, spline_kwargs
provides the kwargs desired for scipy.interpolate.CubicSpline.
Default is {}.</p></li>
<li><p><strong>DENSE_STEPPING</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, the trajectory used in the
integrator will be densely stepped at steps of <code class="xref py py-obj docutils literal notranslate"><span class="pre">dt</span></code>. If 0,
the integrator will determine its stepping. Default is 0.</p></li>
<li><p><strong>max_init_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Sets the allocation of memory for
trajectory parameters. This should be the maximum length
expected for a trajectory. Trajectories with default settings
will be ~100 points. Default is 1000.</p></li>
<li><p><strong>upsample</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, upsample, with a cubic spline,
the trajectories from 0 to T in steps of dt. Default is False.</p></li>
<li><p><strong>err</strong> (<em>double</em><em>, </em><em>optional</em>) – Tolerance for integrator. Default is 1e-10.
Decreasing this parameter will give more steps over the
trajectory, but if it is too small, memory issues will occur as
the trajectory length will blow up. We recommend not adjusting
this parameter.</p></li>
<li><p><strong>fix_T</strong> (<em>bool</em><em>, </em><em>optional</em>) – If upsampling, this will affect excess
points in the t array. If True, it will shave any excess on the
trajectories arrays where the time is greater than the overall
time of the trajectory requested.</p></li>
<li><p><strong>use_rk4</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use rk4 integrator from gsl.
If False, use rk8. Default is False (rk8).</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs passed to trajectory module.
Default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, Phi_phi, Phi_r, flux_norm).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input parameters are not allowed in this model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="module-few.trajectory.flux">
<span id="flux-inspiral"></span><h2>Flux Inspiral<a class="headerlink" href="#module-few.trajectory.flux" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral">
<em class="property">class </em><code class="sig-prename descclassname">few.trajectory.flux.</code><code class="sig-name descname">RunSchwarzEccFluxInspiral</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a>, <a class="reference internal" href="main.html#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a></p>
<p>Flux-based trajectory module.</p>
<p>This module implements a flux-based trajectory by integrating with an
RK8 integrator. It can also adjust the output time-spacing using
cubic spline interpolation. Additionally, it gives the option for
a dense trajectory, which integrates the trajectory at the user-defined
timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em>) – Any arguments for parent
class <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> or
class <a class="reference internal" href="main.html#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any keyword arguments for parent
class <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> or
class <a class="reference internal" href="main.html#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.attributes_RunSchwarzEccFluxInspiral">
<code class="sig-name descname">attributes_RunSchwarzEccFluxInspiral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.attributes_RunSchwarzEccFluxInspiral" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.flux_generator">
<code class="sig-name descname">flux_generator</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.flux_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>C++ class for flux trajectory generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.specific_kwarg_keys">
<code class="sig-name descname">specific_kwarg_keys</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.specific_kwarg_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>specific kwargs from
<a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> that apply to this
inspiral generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.citation">
<em class="property">property </em><code class="sig-name descname">citation</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.citation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return citation for this class</p>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">in_coordinate_time</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">new_t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spline_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">DENSE_STEPPING</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">max_init_len</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">upsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">err</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">use_rk4</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fix_t</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for trajectory interface.</p>
<p>This is the function for calling the creation of the
trajectory. Inputs define the output time spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em>) – Input of variable number of arguments specific to the
inspiral model (see the trajectory class’ <cite>get_inspiral</cite> method).
<strong>Important Note</strong>: M must be the first parameter of any model
that uses this base class.</p></li>
<li><p><strong>in_coordinate_time</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the trajectory will be
outputted in coordinate time. If False, the trajectory will be
outputted in units of M. Default is True.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time step for output waveform in seconds. Also sets
initial step for integrator. Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years. Sets the maximum time
for the integrator to run. Default is 1.0.</p></li>
<li><p><strong>new_t</strong> (<em>1D np.ndarray</em><em>, </em><em>optional</em>) – If given, this represents the final
time array at which the trajectory is analyzed. This is
performed by using a cubic spline on the integrator output.
Default is None.</p></li>
<li><p><strong>spline_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – If using upsampling, spline_kwargs
provides the kwargs desired for scipy.interpolate.CubicSpline.
Default is {}.</p></li>
<li><p><strong>DENSE_STEPPING</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, the trajectory used in the
integrator will be densely stepped at steps of <code class="xref py py-obj docutils literal notranslate"><span class="pre">dt</span></code>. If 0,
the integrator will determine its stepping. Default is 0.</p></li>
<li><p><strong>max_init_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Sets the allocation of memory for
trajectory parameters. This should be the maximum length
expected for a trajectory. Trajectories with default settings
will be ~100 points. Default is 1000.</p></li>
<li><p><strong>upsample</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, upsample, with a cubic spline,
the trajectories from 0 to T in steps of dt. Default is False.</p></li>
<li><p><strong>err</strong> (<em>double</em><em>, </em><em>optional</em>) – Tolerance for integrator. Default is 1e-10.
Decreasing this parameter will give more steps over the
trajectory, but if it is too small, memory issues will occur as
the trajectory length will blow up. We recommend not adjusting
this parameter.</p></li>
<li><p><strong>fix_T</strong> (<em>bool</em><em>, </em><em>optional</em>) – If upsampling, this will affect excess
points in the t array. If True, it will shave any excess on the
trajectories arrays where the time is greater than the overall
time of the trajectory requested.</p></li>
<li><p><strong>use_rk4</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use rk4 integrator from gsl.
If False, use rk8. Default is False (rk8).</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs passed to trajectory module.
Default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, Phi_phi, Phi_r, flux_norm).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input parameters are not allowed in this model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.get_inspiral">
<code class="sig-name descname">get_inspiral</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.get_inspiral" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the inspiral.</p>
<p>This is the function for calling the creation of the flux-based
trajectory. Inputs define the output time spacing. This class can be
used on its own. However, it is generally accessed through the __call__
method associated with its base class:
(<a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a>). See its documentation
for information on a more flexible interface to the trajectory modules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Mass of massive black hole in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – Mass of compact object in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semi-latus rectum in terms units of M (p/M).
This model can handle (p0 &lt;= 18.0).</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity (dimensionless).
This model can handle (e0 &lt;= 0.7).</p></li>
<li><p><strong>err</strong> (<em>double</em><em>, </em><em>optional</em>) – Tolerance for integrator. Default is 1e-10.
Decreasing this parameter will give more steps over the
trajectory, but if it is too small, memory issues will occur as
the trajectory length will blow up. We recommend not adjusting
this parameter.</p></li>
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – Added for flexibility.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs passed from parent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, Phi_phi, Phi_r, flux_norm).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="amp.html" class="btn btn-neutral float-right" title="Amplitude Package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="main.html" class="btn btn-neutral float-left" title="Overall Waveform Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Michael Katz, Alvin Chua, Niels Warburton

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>