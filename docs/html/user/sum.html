<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Summation Package &mdash; few: Fast EMRI Waveforms 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Utilities" href="util.html" />
    <link rel="prev" title="Amplitude Package" href="amp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >

          
          
          <a href="../index.html" class="icon icon-home">
            few: Fast EMRI Waveforms
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="main.html">Overall Waveform Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="traj.html">Trajectory Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="amp.html">Amplitude Package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Summation Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#interpolated-summation">Interpolated Summation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-few.summation.directmodesum">Direct Summation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aak-summation-waveform-generator">AAK Summation / Waveform Generator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">Citations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html">Fast and Accurate EMRI Waveforms Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Full-EMRI-Waveforms-in-Schwarzschild-Eccentric">Full EMRI Waveforms in Schwarzschild Eccentric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Trajectory-Module">Trajectory Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Amplitude-Module">Amplitude Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Spin-weighted-spherical-harmonics">Spin-weighted spherical harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Mode-Selection">Mode Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Parallelized-Cubic-Spline-Interpolation">Parallelized Cubic Spline Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Mode-Summation">Mode Summation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Utility-functions">Utility functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Creating-modules">Creating modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Augmented-Analytic-Kludge-with-5PN-trajectory">Augmented Analytic Kludge with 5PN trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/FastEMRIWaveforms_tutorial.html#Citing-waveforms-and-modules">Citing waveforms and modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Tutorial_FD_construction_single_mode.html">Single Mode Frequency Domain Waveform Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Tutorial_FrequencyDomain_Waveforms.html">EMRI Waveforms in frequency domain</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html">FastEMRIWaveforms Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html#package-todos">Package TODOs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/docs_main.html#change-log">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: coral" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">few: Fast EMRI Waveforms</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Summation Package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user/sum.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="amp.html" class="btn btn-neutral float-left" title="Amplitude Package" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="util.html" class="btn btn-neutral float-right" title="Utilities" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-few.summation">
<span id="summation-package"></span><span id="summation-label"></span><h1>Summation Package<a class="headerlink" href="#module-few.summation" title="Permalink to this heading"></a></h1>
<p>The summation package houses codes used for combining amplitude and phase
information over the course of an inspiral. It does contain GPU accelerated
options. It deals with the overall summation of quantities seen in <a class="reference internal" href="../general/docs_main.html#equation-emri-wave-eq">(1)</a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="few.utils.baseclasses.SummationBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">few.utils.baseclasses.</span></span><span class="sig-name descname"><span class="pre">SummationBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'td'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odd_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SummationBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class used for summation modules.</p>
<p>This class provides a common flexible interface to various summation
implementations. Specific arguments to each summation module can be found
with each associated module discussed below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pad_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Add zero padding to the waveform for time
between plunge and observation time. Default is False.</p></li>
<li><p><strong>output_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of domain in which to calculate the waveform.
Default is ‘td’ for time domain. Options are ‘td’ (time domain) or ‘fd’ (Fourier domain). In the future we hope to add ‘tf’
(time-frequency) and ‘wd’ (wavelet domain).</p></li>
<li><p><strong>odd_len</strong> (<em>bool</em><em>, </em><em>optional</em>) – The waveform output will be padded to be an odd number if True.
If <code class="docutils literal notranslate"><span class="pre">output_type</span> <span class="pre">==</span> <span class="pre">&quot;fd&quot;</span></code>, odd_len will be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. Default is False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="few.utils.baseclasses.SummationBase.attributes_SummationBase">
<span class="sig-name descname"><span class="pre">attributes_SummationBase</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SummationBase.attributes_SummationBase" title="Permalink to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.utils.baseclasses.SummationBase.waveform">
<span class="sig-name descname"><span class="pre">waveform</span></span><a class="headerlink" href="#few.utils.baseclasses.SummationBase.waveform" title="Permalink to this definition"></a></dt>
<dd><p>Complex waveform given by
<span class="math notranslate nohighlight">\(h_+ + i*h_x\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D complex128 np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="few.utils.baseclasses.SummationBase.citation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">citation</span></span><a class="headerlink" href="#few.utils.baseclasses.SummationBase.citation" title="Permalink to this definition"></a></dt>
<dd><p>Return citation for this class</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.baseclasses.SummationBase.sum">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SummationBase.sum" title="Permalink to this definition"></a></dt>
<dd><p>Sum Generator</p>
<p>&#64;classmethod that requires a child class to have a sum method.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – The child class does not have this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.utils.baseclasses.SummationBase.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SummationBase.__call__" title="Permalink to this definition"></a></dt>
<dd><p>Common call function for summation modules.</p>
<p>Provides a common interface for summation modules. It can adjust for
more dimensions in a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D double xp.ndarray</em>) – Array of t values.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – Added for flexibility with summation modules. <cite>args</cite>
tranfers directly into sum function.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time spacing between observations in seconds (inverse of sampling
rate). Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Maximum observing time in years. Default is 1.0.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="interpolated-summation">
<h2>Interpolated Summation<a class="headerlink" href="#interpolated-summation" title="Permalink to this heading"></a></h2>
</section>
<section id="module-few.summation.directmodesum">
<span id="direct-summation"></span><h2>Direct Summation<a class="headerlink" href="#module-few.summation.directmodesum" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">few.summation.directmodesum.</span></span><span class="sig-name descname"><span class="pre">DirectModeSum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.SummationBase" title="few.utils.baseclasses.SummationBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">SummationBase</span></code></a>, <a class="reference internal" href="main.html#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchwarzschildEccentric</span></code></a>, <a class="reference internal" href="main.html#few.utils.baseclasses.ParallelModuleBase" title="few.utils.baseclasses.ParallelModuleBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelModuleBase</span></code></a></p>
<p>Create waveform by direct summation.</p>
<p>This class sums the amplitude and phase information as received.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – Added for flexibility.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for flexibility.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.citation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">citation</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.citation" title="Permalink to this definition"></a></dt>
<dd><p>Return citations for this class</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.gpu_capability">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gpu_capability</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.gpu_capability" title="Permalink to this definition"></a></dt>
<dd><p>Confirms GPU capability</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">teuk_modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Phi_phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Phi_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.sum" title="Permalink to this definition"></a></dt>
<dd><p>Direct summation function.</p>
<p>This function directly sums the amplitude and phase information, as well
as the spin-weighted spherical harmonic values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D double np.ndarray</em>) – Array of t values.</p></li>
<li><p><strong>teuk_modes</strong> (<em>2D double np.array</em>) – Array of complex amplitudes.
Shape: (len(t), num_teuk_modes).</p></li>
<li><p><strong>ylms</strong> (<em>1D complex128 xp.ndarray</em>) – Array of ylm values for each mode,
including m&lt;0. Shape is (num of m==0,) + (num of m&gt;0,)
+ (num of m&lt;0). Number of m&lt;0 and m&gt;0 is the same, but they are
ordered as (m==0 first then) m&gt;0 then m&lt;0.</p></li>
<li><p><strong>Phi_phi</strong> (<em>1D double np.ndarray</em>) – Array of azimuthal phase values
(<span class="math notranslate nohighlight">\(\Phi_\phi\)</span>).</p></li>
<li><p><strong>Phi_r</strong> (<em>1D double np.ndarray</em>) – Array of radial phase values
(<span class="math notranslate nohighlight">\(\Phi_r\)</span>).</p></li>
<li><p><strong>m_arr</strong> (<em>1D int np.ndarray</em>) – <span class="math notranslate nohighlight">\(m\)</span> values associated with each mode.</p></li>
<li><p><strong>n_arr</strong> (<em>1D int np.ndarray</em>) – <span class="math notranslate nohighlight">\(n\)</span> values associated with each mode.</p></li>
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.__call__" title="Permalink to this definition"></a></dt>
<dd><p>Common call function for summation modules.</p>
<p>Provides a common interface for summation modules. It can adjust for
more dimensions in a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D double xp.ndarray</em>) – Array of t values.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – Added for flexibility with summation modules. <cite>args</cite>
tranfers directly into sum function.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time spacing between observations in seconds (inverse of sampling
rate). Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Maximum observing time in years. Default is 1.0.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.adjust_gpu_usage">
<span class="sig-name descname"><span class="pre">adjust_gpu_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.adjust_gpu_usage" title="Permalink to this definition"></a></dt>
<dd><p>Adjust all inputs for gpu usage</p>
<p>If user wants to use gpu, it will change all <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code> in
so that <code class="code docutils literal notranslate"><span class="pre">use_gpu=True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_gpu</strong> (<em>bool</em>) – If True, use gpu resources.</p></li>
<li><p><strong>kwargs</strong> (<em>list of dicts</em><em> or </em><em>dict</em>) – List of kwargs dictionaries or
single dictionary for each constituent class in the
waveform generator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.attributes_ParallelModuleBase">
<span class="sig-name descname"><span class="pre">attributes_ParallelModuleBase</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.attributes_ParallelModuleBase" title="Permalink to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.use_gpu">
<span class="sig-name descname"><span class="pre">use_gpu</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.use_gpu" title="Permalink to this definition"></a></dt>
<dd><p>If True, use GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.xp">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.xp" title="Permalink to this definition"></a></dt>
<dd><p>Either numpy or CuPy based on gpu preference.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.attributes_SchwarzschildEccentric">
<span class="sig-name descname"><span class="pre">attributes_SchwarzschildEccentric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.attributes_SchwarzschildEccentric" title="Permalink to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.background">
<span class="sig-name descname"><span class="pre">background</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.background" title="Permalink to this definition"></a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.descriptor">
<span class="sig-name descname"><span class="pre">descriptor</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.descriptor" title="Permalink to this definition"></a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">num_modes,</span> <span class="pre">num_teuk_modes</span></span></dt>
<dd><p>Total number of Teukolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">lmax,</span> <span class="pre">nmax</span></span></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.ndim">
<span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.ndim" title="Permalink to this definition"></a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.m0sort">
<span class="sig-name descname"><span class="pre">m0sort</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.m0sort" title="Permalink to this definition"></a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.m0mask">
<span class="sig-name descname"><span class="pre">m0mask</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.m0mask" title="Permalink to this definition"></a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.m_zero_up_mask">
<span class="sig-name descname"><span class="pre">m_zero_up_mask</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.m_zero_up_mask" title="Permalink to this definition"></a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">l_arr,</span> <span class="pre">m_arr,</span> <span class="pre">n_arr</span></span></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.lmn_indices">
<span class="sig-name descname"><span class="pre">lmn_indices</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.lmn_indices" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.num_m_zero_up">
<span class="sig-name descname"><span class="pre">num_m_zero_up</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.num_m_zero_up" title="Permalink to this definition"></a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.num_m0">
<span class="sig-name descname"><span class="pre">num_m0</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.num_m0" title="Permalink to this definition"></a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.num_m_1_up">
<span class="sig-name descname"><span class="pre">num_m_1_up</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.num_m_1_up" title="Permalink to this definition"></a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">unique_l,</span> <span class="pre">unique_m</span></span></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.inverse_lm">
<span class="sig-name descname"><span class="pre">inverse_lm</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.inverse_lm" title="Permalink to this definition"></a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.index_map">
<span class="sig-name descname"><span class="pre">index_map</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.index_map" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.special_index_map">
<span class="sig-name descname"><span class="pre">special_index_map</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.special_index_map" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.attributes_SummationBase">
<span class="sig-name descname"><span class="pre">attributes_SummationBase</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.attributes_SummationBase" title="Permalink to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.waveform">
<span class="sig-name descname"><span class="pre">waveform</span></span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.waveform" title="Permalink to this definition"></a></dt>
<dd><p>Complex waveform given by
<span class="math notranslate nohighlight">\(h_+ + i*h_x\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D complex128 np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.sanity_check_gpu">
<span class="sig-name descname"><span class="pre">sanity_check_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.sanity_check_gpu" title="Permalink to this definition"></a></dt>
<dd><p>Check if this class has GPU capability</p>
<p>If the user is requesting GPU usage, this will confirm the class has
GPU capabilites.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>use_gpu</strong> (<em>bool</em>) – If True, the user is requesting GPU usage.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – The user is requesting GPU usage, but this class does
    not have that capability.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.sanity_check_init">
<span class="sig-name descname"><span class="pre">sanity_check_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.sanity_check_init" title="Permalink to this definition"></a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.sanity_check_traj">
<span class="sig-name descname"><span class="pre">sanity_check_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.sanity_check_traj" title="Permalink to this definition"></a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="few.summation.directmodesum.DirectModeSum.sanity_check_viewing_angles">
<span class="sig-name descname"><span class="pre">sanity_check_viewing_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.sanity_check_viewing_angles" title="Permalink to this definition"></a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the angular values are not allowed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="aak-summation-waveform-generator">
<h2>AAK Summation / Waveform Generator<a class="headerlink" href="#aak-summation-waveform-generator" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="amp.html" class="btn btn-neutral float-left" title="Amplitude Package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="util.html" class="btn btn-neutral float-right" title="Utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Michael Katz, Alvin Chua, Niels Warburton.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>