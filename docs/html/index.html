

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>few: Fast EMRI Waveforms &mdash; few: Fast EMRI Waveforms 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home" alt="Documentation Home"> few: Fast EMRI Waveforms
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">few: Fast EMRI Waveforms</a><ul>
<li><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#installing">Installing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-tests">Running the Tests</a></li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
<li><a class="reference internal" href="#versioning">Versioning</a></li>
<li><a class="reference internal" href="#authors">Authors</a><ul>
<li><a class="reference internal" href="#contibutors">Contibutors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#license">License</a></li>
<li><a class="reference internal" href="#acknowledgments">Acknowledgments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#documentation">Documentation</a><ul>
<li><a class="reference internal" href="#overall-waveform-models">Overall Waveform Models</a><ul>
<li><a class="reference internal" href="#schwarzschild-eccentric">Schwarzschild Eccentric</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-few.trajectory">Trajectory Package</a><ul>
<li><a class="reference internal" href="#module-few.trajectory.flux">Flux Inspiral</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-few.amplitude">Amplitude Package</a><ul>
<li><a class="reference internal" href="#schwarzschild-eccentric-amplitudes">Schwarzschild Eccentric Amplitudes</a><ul>
<li><a class="reference internal" href="#module-few.amplitude.romannet">ROMAN Network</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-few.amplitude.interp2dcubicspline">2D Cubic Spline Interpolation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">few: Fast EMRI Waveforms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>few: Fast EMRI Waveforms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="few-fast-emri-waveforms">
<h1>few: Fast EMRI Waveforms<a class="headerlink" href="#few-fast-emri-waveforms" title="Permalink to this headline">¶</a></h1>
<p>This package contains the highly modular framework for fast and accurate
extreme mass ratio inspiral (EMRI) waveforms from (TODO: add arXiv). The
waveforms in this package combine a variety of separately accessible
modules to form EMRI waveforms on both CPUs and GPUs. Generally, the
modules fall into four categories: trajectory, amplitudes, summation,
and utilities. Please see the documentation (TODO: add documentation
site) for further information on these modules.</p>
<p>If you use all or any parts of this code, please cite (TODO: add papers
to cite. Do we want this to be per module or general use.).</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple" start="0">
<li><p><a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Install Anaconda</a> if
you do not have it.</p></li>
<li><p>Create a virtual environment.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">few_env</span> <span class="n">numpy</span> <span class="n">Cython</span> <span class="n">scipy</span> <span class="n">tqdm</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.8</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">few_env</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Use pip to <a class="reference external" href="https://docs-cupy.chainer.org/en/stable/install.html">install
cupy</a>. If
you have cuda version 9.2, for example:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">cupy</span><span class="o">-</span><span class="n">cuda92</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Clone the repository.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mikekatz04</span><span class="o">/</span><span class="n">FastEMRIWaveforms</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Run install. Make sure CUDA is on your PATH.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>To import few:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TODO</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">of</span> <span class="n">high</span> <span class="n">level</span> <span class="n">waveform</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Perform test:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">tests</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>To install this software, you need the <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html">CUDA
toolkit</a>,
[gsl] (<a class="reference external" href="https://www.gnu.org/software/gsl/">https://www.gnu.org/software/gsl/</a>),
<a class="reference external" href="https://www.netlib.org/lapack/lug/node14.html">lapack</a> Python &gt;3.4,
numpy, and <a class="reference external" href="https://cupy.chainer.org/">cupy</a>. The CUDA toolkit must
have cuda version &gt;8.0. To run this software you need an NVIDIA GPU of
compute capability &gt;2.0.</p>
</div>
<div class="section" id="installing">
<h3>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Create a virtual environment.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">few_env</span> <span class="n">numpy</span> <span class="n">Cython</span> <span class="n">scipy</span> <span class="n">tqdm</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.8</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">few_env</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Use pip to <a class="reference external" href="https://docs-cupy.chainer.org/en/stable/install.html">install
cupy</a>. If
you have cuda version 9.2, for example:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">cupy</span><span class="o">-</span><span class="n">cuda92</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Clone the repository.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mikekatz04</span><span class="o">/</span><span class="n">FastEMRIWaveforms</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Run install. Make sure CUDA is on your PATH.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-the-tests">
<h2>Running the Tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h2>
<p>TODO: fill in</p>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Please read <a class="reference external" href="CONTRIBUTING.md">CONTRIBUTING.md</a> for details on our
code of conduct, and the process for submitting pull requests to us.</p>
</div>
<div class="section" id="versioning">
<h2>Versioning<a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h2>
<p>We use <a class="reference external" href="http://semver.org/">SemVer</a> for versioning. For the versions
available, see the <a class="reference external" href="https://github.com/mikekatz04/gce/tags">tags on this
repository</a>.</p>
<p>Current Version: 0.1.0</p>
</div>
<div class="section" id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Michael Katz</strong></p></li>
<li><p>Alvin J. K. Chua</p></li>
<li><p>Niels Warburton</p></li>
</ul>
<div class="section" id="contibutors">
<h3>Contibutors<a class="headerlink" href="#contibutors" title="Permalink to this headline">¶</a></h3>
<p>TODO: add people</p>
</div>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>This project is licensed under the GNU License - see the
<a class="reference external" href="LICENSE.md">LICENSE.md</a> file for details.</p>
</div>
<div class="section" id="acknowledgments">
<h2>Acknowledgments<a class="headerlink" href="#acknowledgments" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>This research resulting in this code was supported by National
Science Foundation under grant DGE-0948017 and the Chateaubriand
Fellowship from the Office for Science &amp; Technology of the Embassy of
France in the United States.</p></li>
<li><p>It was also supported in part through the computational resources and
staff contributions provided for the Quest/Grail high performance
computing facility at Northwestern University.</p></li>
</ul>
</div>
</div>
<div class="section" id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overall-waveform-models">
<h2>Overall Waveform Models<a class="headerlink" href="#overall-waveform-models" title="Permalink to this headline">¶</a></h2>
<p>The Fast EMRI Waveform (few) package provides multiple complete models/waveforms to generate waveforms from start to finish. These are detailed in this section. Please note there are other modules available in each subpackage that may not be listed as a part of complete model here.</p>
<div class="section" id="schwarzschild-eccentric">
<h3>Schwarzschild Eccentric<a class="headerlink" href="#schwarzschild-eccentric" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="few.utils.baseclasses.SchwarzschildEccentric">
<em class="property">class </em><code class="sig-prename descclassname">few.utils.baseclasses.</code><code class="sig-name descname">SchwarzschildEccentric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for Schwarzschild eccentric waveforms.</p>
<p>This class creates shared traits between different implementations of the
same model. Particularly, this class includes descriptive traits as well as
the sanity check class method that should be used in all implementations of
this model. This method can be overwritten if necessary. Here we describe
the overall qualities of this base class.</p>
<p>The user inputs orbital parameter trajectories and is returned the complex
amplitudes of each harmonic mode, <span class="math notranslate nohighlight">\(A_{lmn}\)</span>, given by,</p>
<div class="math notranslate nohighlight">
\[A_{lmn}=-2Z_{lmn}/\omega_{mn}^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(Z_{lmn}\)</span> and <span class="math notranslate nohighlight">\(\omega_{mn}\)</span> are functions of the
orbital paramters. <span class="math notranslate nohighlight">\(l\)</span> ranges from 2 to 10; <span class="math notranslate nohighlight">\(m\)</span> from <span class="math notranslate nohighlight">\(-l\)</span> to <span class="math notranslate nohighlight">\(l\)</span>;
and <span class="math notranslate nohighlight">\(n\)</span> from -30 to 30. This is for Schwarzschild eccentric.
The model validity ranges from (TODO: add limits).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will allocate arrays on the GPU.
Default is False.</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>UserWarning</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em>, <em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum in units of M. TODO: Fix this. <span class="math notranslate nohighlight">\((\leq e0\leq0.7)\)</span></p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e0\leq0.7)\)</span></p></li>
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase">
<em class="property">class </em><code class="sig-prename descclassname">few.waveform.</code><code class="sig-name descname">SchwarzschildEccentricWaveformBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inspiral_module</span></em>, <em class="sig-param"><span class="n">amplitude_module</span></em>, <em class="sig-param"><span class="n">sum_module</span></em>, <em class="sig-param"><span class="n">inspiral_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">amplitude_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">sum_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">Ylm_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utils.baseclasses.SchwarzschildEccentric</span></code></p>
<p>Carrier class for FEW</p>
<dl class="py method">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">0.0002</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">mode_selection</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="few.waveform.FastSchwarzschildEccentricFlux">
<em class="property">class </em><code class="sig-prename descclassname">few.waveform.</code><code class="sig-name descname">FastSchwarzschildEccentricFlux</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.waveform.SchwarzschildEccentricWaveformBase" title="few.waveform.SchwarzschildEccentricWaveformBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.waveform.SchwarzschildEccentricWaveformBase</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux">
<em class="property">class </em><code class="sig-prename descclassname">few.waveform.</code><code class="sig-name descname">SlowSchwarzschildEccentricFlux</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.waveform.SchwarzschildEccentricWaveformBase" title="few.waveform.SchwarzschildEccentricWaveformBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.waveform.SchwarzschildEccentricWaveformBase</span></code></a></p>
</dd></dl>

</div>
</div>
<div class="section" id="module-few.trajectory">
<span id="trajectory-package"></span><h2>Trajectory Package<a class="headerlink" href="#module-few.trajectory" title="Permalink to this headline">¶</a></h2>
<p>The trajectory package houses modules that turn initial orbital parameters into
phase-space trajectories (orbital phases and orbital parameters). These are
determined by numerical integrators that interpolate over the relevant
quantities.</p>
<div class="section" id="module-few.trajectory.flux">
<span id="flux-inspiral"></span><h3>Flux Inspiral<a class="headerlink" href="#module-few.trajectory.flux" title="Permalink to this headline">¶</a></h3>
<p>This module contains flux-based or adiabatic trajectory modules.
TODO: more info (?), Specific papers to cite</p>
<dl class="py class">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral">
<em class="property">class </em><code class="sig-prename descclassname">few.trajectory.flux.</code><code class="sig-name descname">RunSchwarzEccFluxInspiral</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Flux-based trajectory module.</p>
<p>This module implements a flux-based trajectory by integrating with an
RK8 integrator. It can also adjust the output time-spacing using
cubic spline interpolation. Additionally, it gives the option for
a dense trajectory, which integrates the trajectory at the user-defined
timestep.</p>
<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em>, <em class="sig-param"><span class="n">err</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">in_coordinate_time</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">new_t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spline_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">DENSE_STEPPING</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">max_init_len</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">upsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">step_eps</span><span class="o">=</span><span class="default_value">1e-11</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for this class.</p>
<p>This is the function for calling the creation of the flux-based
trajectory. Inputs define the output time spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Mass of massive black hole in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – Mass of compact object in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semi-latus rectum in terms units of M (p/M).
This model can handle (p0 &lt;= 18.0).</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity (dimensionless).
This model can handle (e0 &lt;= 0.7).</p></li>
<li><p><strong>err</strong> (<em>double</em><em>, </em><em>optional</em>) – Tolerance for integrator. Default is 1e-10.
Decreasing this parameter will give more steps over the
trajectory, but if it is too small, memory issues will occur as
the trajectory length will blow up. We recommend not adjusting
this parameter.</p></li>
<li><p><strong>in_coordinate_time</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the trajectory will be
outputted in coordinate time. If False, the trajectory will be
outputted in units of M. Default is True.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time step for output waveform in seconds. Also sets
initial step for integrator. Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years. Sets the maximum time
for the integrator to run. Default is 1.0.</p></li>
<li><p><strong>new_t</strong> (<em>1D np.ndarray</em><em>, </em><em>optional</em>) – If given, this represents the final
time array at which the trajectory is analyzed. This is
performed by using a cubic spline on the integrator output.
Default is None.</p></li>
<li><p><strong>spline_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – If using upsampling, spline_kwargs
provides the kwargs desired for scipy.interpolate.CubicSpline.
Default is {}.</p></li>
<li><p><strong>DENSE_STEPPING</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, the trajectory used in the
integrator will be densely stepped at steps of <code class="xref py py-obj docutils literal notranslate"><span class="pre">dt</span></code>. If 0,
the integrator will determine its stepping. Default is 0.</p></li>
<li><p><strong>max_init_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Sets the allocation of memory for
trajectory parameters. This should be the maximum length
expected for a trajectory. Trajectories with default settings
will be ~100 points. Default is 1000.</p></li>
<li><p><strong>upsample</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, upsample, with a cubic spline,
the trajectories from 0 to T in steps of dt. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, Phi_phi, Phi_r, flux_norm).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input parameters are not allowed in this model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-few.amplitude">
<span id="amplitude-package"></span><h2>Amplitude Package<a class="headerlink" href="#module-few.amplitude" title="Permalink to this headline">¶</a></h2>
<p>The amplitude package houses modules for calculating Tuekolsky amplitudes from
orbital parameter trajectories. The complex amplitudes are determined with
various methods documented below. Some amplitude modules have gpu capabilities.</p>
<div class="section" id="schwarzschild-eccentric-amplitudes">
<h3>Schwarzschild Eccentric Amplitudes<a class="headerlink" href="#schwarzschild-eccentric-amplitudes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="module-few.amplitude.romannet">
<span id="roman-network"></span><h4>ROMAN Network<a class="headerlink" href="#module-few.amplitude.romannet" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="few.amplitude.romannet.ROMANAmplitude">
<em class="property">class </em><code class="sig-prename descclassname">few.amplitude.romannet.</code><code class="sig-name descname">ROMANAmplitude</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_input_len</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.romannet.ROMANAmplitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a></p>
<p>Calculate Teukolsky amplitudes with a ROMAN.</p>
<p>ROMAN stands for reduced-order models with artificial neurons. Please see
the documentations for
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>
for overall aspects of these models.</p>
<p>A reduced order model is computed for <span class="math notranslate nohighlight">\(A_{lmn}\)</span>. The data sets that
are provided over a grid of <span class="math notranslate nohighlight">\((p,e)\)</span> were provided by Scott Hughes.</p>
<p>A feed-foward neural network is then trained on the ROM. Its weights are
used in this module.</p>
<p>When the user inputs <span class="math notranslate nohighlight">\((p,e)\)</span>, the neural network determines
coefficients for the modes in the reduced basic and transforms it back to
amplitude space.</p>
<p>This module is available for GPU and CPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_input_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points to initialize for
buffers. This should be the same as the value from the user chosen
trajectory module. Default is 1000.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use GPU resources. Default is False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.amplitude.romannet.ROMANAmplitude.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.romannet.ROMANAmplitude.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Teukolsky amplitudes for Schwarzschild eccentric.</p>
<p>This function takes the inputs the trajectory in <span class="math notranslate nohighlight">\((p,e)\)</span> as arrays
and returns the complex amplitude of all modes to adiabatic order at
each step of the trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D double numpy.ndarray</em>) – Array containing the trajectory for values of
the semi-latus rectum.</p></li>
<li><p><strong>e</strong> (<em>1D double numpy.ndarray</em>) – Array containing the trajectory for values of
the eccentricity.</p></li>
<li><p><strong>*args</strong> (<em>tuple</em><em>, </em><em>placeholder</em>) – Added to create flexibility when calling different
amplitude modules. It is not used.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added to create flexibility when calling different
amplitude modules. It is not used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-few.amplitude.interp2dcubicspline">
<span id="d-cubic-spline-interpolation"></span><h3>2D Cubic Spline Interpolation<a class="headerlink" href="#module-few.amplitude.interp2dcubicspline" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude">
<em class="property">class </em><code class="sig-prename descclassname">few.amplitude.interp2dcubicspline.</code><code class="sig-name descname">Interp2DAmplitude</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a></p>
<p>Calculate Teukolsky amplitudes by 2D Cubic Spline interpolation.</p>
<p>Please see the documentations for
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>
for overall aspects of these models.</p>
<p>Each mode is setup with a 2D cubic spline interpolant. When the user
inputs <span class="math notranslate nohighlight">\((p,e)\)</span>, the interpolatant determines the corresponding
amplitudes for each mode in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for the base class:
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>. Default is
{}.</p>
</dd>
</dl>
<dl class="py method">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em>, <em class="sig-param"><span class="n">l_arr</span></em>, <em class="sig-param"><span class="n">m_arr</span></em>, <em class="sig-param"><span class="n">n_arr</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Teukolsky amplitudes for Schwarzschild eccentric.</p>
<p>This function takes the inputs the trajectory in <span class="math notranslate nohighlight">\((p,e)\)</span> as arrays
and returns the complex amplitude of all modes to adiabatic order at
each step of the trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D double numpy.ndarray</em>) – Array containing the trajectory for values of
the semi-latus rectum.</p></li>
<li><p><strong>e</strong> (<em>1D double numpy.ndarray</em>) – Array containing the trajectory for values of
the eccentricity.</p></li>
<li><p><strong>l_arr</strong> (<em>1D int numpy.ndarray</em>) – <span class="math notranslate nohighlight">\(l\)</span> values to evaluate.</p></li>
<li><p><strong>m_arr</strong> (<em>1D int numpy.ndarray</em>) – <span class="math notranslate nohighlight">\(m\)</span> values to evaluate.</p></li>
<li><p><strong>n_arr</strong> (<em>1D int numpy.ndarray</em>) – <span class="math notranslate nohighlight">\(ns\)</span> values to evaluate.</p></li>
<li><p><strong>*args</strong> (<em>tuple</em><em>, </em><em>placeholder</em>) – Added to create flexibility when calling different
amplitude modules. It is not used.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added to create flexibility when calling different
amplitude modules. It is not used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Michael Katz, Alvin Chua, Niels Warburton

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>