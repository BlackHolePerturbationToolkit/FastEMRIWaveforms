

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>few: Fast EMRI Waveforms &mdash; few: Fast EMRI Waveforms 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home" alt="Documentation Home"> few: Fast EMRI Waveforms
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">few: Fast EMRI Waveforms</a><ul>
<li><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#installing">Installing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-tests">Running the Tests</a></li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
<li><a class="reference internal" href="#versioning">Versioning</a></li>
<li><a class="reference internal" href="#authors">Authors</a><ul>
<li><a class="reference internal" href="#contibutors">Contibutors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#license">License</a></li>
<li><a class="reference internal" href="#acknowledgments">Acknowledgments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#documentation">Documentation</a><ul>
<li><a class="reference internal" href="#overall-waveform-models">Overall Waveform Models</a><ul>
<li><a class="reference internal" href="#prebuilt-waveform-models">Prebuilt Waveform Models</a></li>
<li><a class="reference internal" href="#base-classes">Base Classes</a><ul>
<li><a class="reference internal" href="#schwarzschild-eccentric">Schwarzschild Eccentric</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-few.trajectory">Trajectory Package</a><ul>
<li><a class="reference internal" href="#module-few.trajectory.flux">Flux Inspiral</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-few.amplitude">Amplitude Package</a><ul>
<li><a class="reference internal" href="#schwarzschild-eccentric-amplitudes">Schwarzschild Eccentric Amplitudes</a><ul>
<li><a class="reference internal" href="#module-few.amplitude.romannet">ROMAN Network</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-few.amplitude.interp2dcubicspline">2D Cubic Spline Interpolation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-few.summation">Summation Package</a><ul>
<li><a class="reference internal" href="#module-few.summation.interpolatedmodesum">Interpolated Summation</a></li>
<li><a class="reference internal" href="#module-few.summation.directmodesum">Direct Summation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-few.utils">Utilities</a><ul>
<li><a class="reference internal" href="#module-few.utils.modeselector">Mode Filtering</a></li>
<li><a class="reference internal" href="#module-few.utils.ylm">(-2) Spin-Weighted Spherical Harmonics</a></li>
<li><a class="reference internal" href="#module-few.utils.overlap">Analysis Tools</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">few: Fast EMRI Waveforms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>few: Fast EMRI Waveforms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="few-fast-emri-waveforms">
<h1>few: Fast EMRI Waveforms<a class="headerlink" href="#few-fast-emri-waveforms" title="Permalink to this headline">¶</a></h1>
<p>This package contains the highly modular framework for fast and accurate
extreme mass ratio inspiral (EMRI) waveforms from (TODO: add arXiv). The
waveforms in this package combine a variety of separately accessible
modules to form EMRI waveforms on both CPUs and GPUs. Generally, the
modules fall into four categories: trajectory, amplitudes, summation,
and utilities. Please see the
<a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/">documentation</a> for
further information on these modules.</p>
<p>If you use all or any parts of this code, please cite (TODO: add papers
to cite. Do we want this to be per module or general use.).</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Below is a quick set of instructions to get you started with <code class="docutils literal notranslate"><span class="pre">few</span></code>.</p>
<ol class="arabic simple" start="0">
<li><p><a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Install Anaconda</a> if
you do not have it.</p></li>
<li><p>Create a virtual environment.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">few_env</span> <span class="n">numpy</span> <span class="n">Cython</span> <span class="n">scipy</span> <span class="n">tqdm</span> <span class="n">jupyter</span> <span class="n">ipython</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.8</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">few_env</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Clone the repository.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mikekatz04</span><span class="o">/</span><span class="n">FastEMRIWaveforms</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Run install. Make sure CUDA is on your PATH.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>To import few:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">few.waveform</span> <span class="kn">import</span> <span class="n">FastSchwarzschildEccentricFlux</span>
</pre></div>
</div>
<p>See <a class="reference external" href="examples/SchwarzschildEccentricWaveform_intro.ipynb">examples
notebook</a>.</p>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>To install this software for CPU usage, you need <a class="reference external" href="https://www.gnu.org/software/gsl/">gsl
&gt;2.0</a> ,
<a class="reference external" href="https://www.netlib.org/lapack/lug/node14.html">lapack</a>, Python &gt;3.4,
and NumPy. To run the examples, you will also need jupyter and
matplotlib. For Python packages, we generally recommend installing
within a conda environment. For gsl and lapack, it may be better to use
brew or apt-get. If you want to run with OpenMP, make sure that is
installed.</p>
<p>When installing lapack and gsl, the setup file will default to assuming
lib and include for both are in <code class="docutils literal notranslate"><span class="pre">/usr/local/opt/lapack/</span></code> and
<code class="docutils literal notranslate"><span class="pre">/usr/local/opt/gsl/</span></code>. To provide other lib and include directories
you can provide command line options when installing. You can also
remove usage of OpenMP.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">help</span>
<span class="n">usage</span><span class="p">:</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">no_omp</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lapack_lib</span> <span class="n">LAPACK_LIB</span><span class="p">]</span>
                <span class="p">[</span><span class="o">--</span><span class="n">lapack_include</span> <span class="n">LAPACK_INCLUDE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lapack</span> <span class="n">LAPACK</span><span class="p">]</span>
                <span class="p">[</span><span class="o">--</span><span class="n">gsl_lib</span> <span class="n">GSL_LIB</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">gsl_include</span> <span class="n">GSL_INCLUDE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">gsl</span> <span class="n">GSL</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">no_omp</span>              <span class="n">If</span> <span class="n">provided</span><span class="p">,</span> <span class="n">install</span> <span class="n">without</span> <span class="n">OpenMP</span><span class="o">.</span>
  <span class="o">--</span><span class="n">lapack_lib</span> <span class="n">LAPACK_LIB</span>
                        <span class="n">Directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">lapack</span> <span class="n">lib</span><span class="o">.</span>
  <span class="o">--</span><span class="n">lapack_include</span> <span class="n">LAPACK_INCLUDE</span>
                        <span class="n">Directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">lapack</span> <span class="n">include</span><span class="o">.</span>
  <span class="o">--</span><span class="n">lapack</span> <span class="n">LAPACK</span>       <span class="n">Directory</span> <span class="n">of</span> <span class="n">both</span> <span class="n">lapack</span> <span class="n">lib</span> <span class="ow">and</span> <span class="n">include</span><span class="o">.</span> <span class="s1">&#39;/include&#39;</span>
                        <span class="ow">and</span> <span class="s1">&#39;/lib&#39;</span> <span class="n">will</span> <span class="n">be</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">this</span> <span class="n">string</span><span class="o">.</span>
  <span class="o">--</span><span class="n">gsl_lib</span> <span class="n">GSL_LIB</span>     <span class="n">Directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">gsl</span> <span class="n">lib</span><span class="o">.</span>
  <span class="o">--</span><span class="n">gsl_include</span> <span class="n">GSL_INCLUDE</span>
                        <span class="n">Directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">gsl</span> <span class="n">include</span><span class="o">.</span>
  <span class="o">--</span><span class="n">gsl</span> <span class="n">GSL</span>             <span class="n">Directory</span> <span class="n">of</span> <span class="n">both</span> <span class="n">gsl</span> <span class="n">lib</span> <span class="ow">and</span> <span class="n">include</span><span class="o">.</span> <span class="s1">&#39;/include&#39;</span> <span class="ow">and</span>
                        <span class="s1">&#39;/lib&#39;</span> <span class="n">will</span> <span class="n">be</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">this</span> <span class="n">string</span><span class="o">.</span>
</pre></div>
</div>
<p>To install this software for use with NVIDIA GPUs (compute capability
&gt;2.0), you need the <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html">CUDA
toolkit</a>
and <a class="reference external" href="https://cupy.chainer.org/">CuPy</a>. The CUDA toolkit must have
cuda version &gt;8.0. Be sure to properly install cupy within the correct
CUDA toolkit version. Make sure the nvcc binary is on <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> or set
it as the <code class="docutils literal notranslate"><span class="pre">CUDAHOME</span></code> environment variable.</p>
</div>
<div class="section" id="installing">
<h3>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple" start="0">
<li><p><a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Install Anaconda</a> if
you do not have it.</p></li>
<li><p>Create a virtual environment.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">few_env</span> <span class="n">numpy</span> <span class="n">Cython</span> <span class="n">scipy</span> <span class="n">tqdm</span> <span class="n">jupyter</span> <span class="n">ipython</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.8</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">few_env</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>If using GPUs, use pip to <a class="reference external" href="https://docs-cupy.chainer.org/en/stable/install.html">install
cupy</a>. If
you have cuda version 9.2, for example:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">cupy</span><span class="o">-</span><span class="n">cuda92</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Clone the repository.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mikekatz04</span><span class="o">/</span><span class="n">FastEMRIWaveforms</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Run install. Make sure CUDA is on your PATH.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Get data extra data if desired. If you want to run the slow waveforms
(<a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html?highlight=slow#few.waveform.SlowSchwarzschildEccentricFlux">few.waveform.SlowSchwarzschildEccentricFlux</a>)
or bicubic amplitude determination
(<a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html?highlight=interp2d#few.amplitude.interp2dcubicspline.Interp2DAmplitude">few.amplitudes.interp2dcubicspline.Interp2DAmplitude</a>),
you will need to attain an hdf5 file
(Teuk_amps_a0.0_lmax_10_nmax_30_new.h5) and put it in the
<code class="docutils literal notranslate"><span class="pre">/Path/to/Installation/few/files/</span></code> directory. This is available at
Zenodo (TODO: fill in).</p></li>
</ol>
</div>
</div>
<div class="section" id="running-the-tests">
<h2>Running the Tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h2>
<p>When performing tests, you must have the hdf5 file
(Teuk_amps_a0.0_lmax_10_nmax_30_new.h5) for
(<a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html?highlight=slow#few.waveform.SlowSchwarzschildEccentricFlux">few.waveform.SlowSchwarzschildEccentricFlux</a>)
and bicubic amplitude determination
(<a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/html/index.html?highlight=interp2d#few.amplitude.interp2dcubicspline.Interp2DAmplitude">few.amplitudes.interp2dcubicspline.Interp2DAmplitude</a>).
See above in <strong>Installing</strong>.</p>
<p>In the main directory of the package run in the terminal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">unittest</span> <span class="n">discover</span>
</pre></div>
</div>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Please read <a class="reference external" href="CONTRIBUTING.md">CONTRIBUTING.md</a> for details on our
code of conduct, and the process for submitting pull requests to us.</p>
</div>
<div class="section" id="versioning">
<h2>Versioning<a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h2>
<p>We use <a class="reference external" href="http://semver.org/">SemVer</a> for versioning. For the versions
available, see the <a class="reference external" href="https://github.com/mikekatz04/gce/tags">tags on this
repository</a>.</p>
<p>Current Version: 0.1.0</p>
</div>
<div class="section" id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Michael Katz</strong></p></li>
<li><p>Alvin J. K. Chua</p></li>
<li><p>Niels Warburton</p></li>
</ul>
<div class="section" id="contibutors">
<h3>Contibutors<a class="headerlink" href="#contibutors" title="Permalink to this headline">¶</a></h3>
<p>TODO: add people</p>
</div>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>This project is licensed under the GNU License - see the
<a class="reference external" href="LICENSE.md">LICENSE.md</a> file for details.</p>
</div>
<div class="section" id="acknowledgments">
<h2>Acknowledgments<a class="headerlink" href="#acknowledgments" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>This research resulting in this code was supported by National
Science Foundation under grant DGE-0948017 and the Chateaubriand
Fellowship from the Office for Science &amp; Technology of the Embassy of
France in the United States.</p></li>
<li><p>It was also supported in part through the computational resources and
staff contributions provided for the Quest/Grail high performance
computing facility at Northwestern University.</p></li>
</ul>
</div>
</div>
<div class="section" id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h1>
<p>Fast EMRI Waveform models are built for fast evaluation of the EMRI waveform summation equation, given by (<a class="reference external" href="https://arxiv.org/abs/gr-qc/0509101">Drasco &amp; Hughes 2006</a>),</p>
<div class="math notranslate nohighlight" id="equation-emri-wave-eq">
<span class="eqno">(1)<a class="headerlink" href="#equation-emri-wave-eq" title="Permalink to this equation">¶</a></span>\[h_+ + ih_x=r^{-1}\sum_{lmkn}A_{lmkn}(t)e^{-i\Phi_{mkn}(t)}V_{lmkn}(\theta,\phi),\]</div>
<p>where <span class="math notranslate nohighlight">\(h_+ + ih_x\)</span> is the two polarizations of the gravitational wave; <span class="math notranslate nohighlight">\(r\)</span> is the distance; <span class="math notranslate nohighlight">\(l,m,k,n\)</span> are orbital angular momentum, azimuthal, polar, and radial harmonic indices, respectively; <span class="math notranslate nohighlight">\(A_{lmkn}(t)\)</span> is a complex amplitude function at time <span class="math notranslate nohighlight">\(t\)</span>; <span class="math notranslate nohighlight">\(A(t)\)</span> is a complex amplitude function at time <span class="math notranslate nohighlight">\(t\)</span>; <span class="math notranslate nohighlight">\(\Phi_{mkn}(t)=m\omega_\phi + k\omega_\theta + n\omega_r\)</span> where <span class="math notranslate nohighlight">\(\omega\)</span> is the fundamental frequency for a given direction; and <span class="math notranslate nohighlight">\(V_{lmkn}(\theta,\phi\)</span>) is the harmonic projection functions based on viewing angles <span class="math notranslate nohighlight">\(\theta,phi\)</span>. The various modules in this package deal with separate pieces of this equation. The amplitude (<a class="reference internal" href="#module-few.amplitude" title="few.amplitude"><code class="xref py py-mod docutils literal notranslate"><span class="pre">few.amplitude</span></code></a>) module deals with <span class="math notranslate nohighlight">\(A_{lmkn}(t)\)</span>. The trajectory (<a class="reference internal" href="#module-few.trajectory" title="few.trajectory"><code class="xref py py-mod docutils literal notranslate"><span class="pre">few.trajectory</span></code></a>) module finds the orbital trajectories (<span class="math notranslate nohighlight">\(p(t), e(t), \iota(t)\)</span>) which are fed into the amplitude module and phase trajectories (<span class="math notranslate nohighlight">\(\Phi_\phi, \Phi_\theta, \Phi_r\)</span>) that are fed into the final summation. Utility modules aid this process from the utilities package (<a class="reference internal" href="#module-few.utils" title="few.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">few.utils</span></code></a>). Once such utility module is the calculation of <span class="math notranslate nohighlight">\(V_{lmkn}(\theta,\phi\)</span>) (this is currently limited to the spin-weighted spherical harmonics for Schwarzschild eccentric). For completeness, <span class="math notranslate nohighlight">\(A_{lmkn}\)</span> is given by,</p>
<div class="math notranslate nohighlight">
\[A_{lmkn} = -2Z_{lmkn}(a, p, e, \iota)/\omega_{mkn}^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(Z_{lmkn}(a, p, e, \iota)\)</span> is the teukolsky amplitudes associated with a geodesic with spin, <span class="math notranslate nohighlight">\(a\)</span>; semilatus rectum, <span class="math notranslate nohighlight">\(p\)</span>; and inclination, <span class="math notranslate nohighlight">\(\iota\)</span>. <span class="math notranslate nohighlight">\(\omega_{mkn}\)</span> is the summation of fundamental frequencies of the geodesic with integer weights equivalent to the mode indices. The angular function, <span class="math notranslate nohighlight">\(V_{lmkn}\)</span> is given by,</p>
<div class="math notranslate nohighlight">
\[V_{lmkn}(\theta, \phi) = (s=-2)S_{lmkn}(\theta)e^{im\phi},\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{lmkn}(\theta)\)</span> is the general angular function from <a class="reference external" href="https://arxiv.org/abs/gr-qc/0509101">Drasco &amp; Hughes 2006</a>.</p>
<p>When these modules complete their calculations, the summation (<a class="reference internal" href="#module-few.summation" title="few.summation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">few.summation</span></code></a>) module takes all of this information and creates an EMRI waveform.</p>
<p>Our model is valid at any <span class="math notranslate nohighlight">\((p_0,e_0)\)</span> that falls outside the separatrix, below the <span class="math notranslate nohighlight">\((p_0=10,e_0=0.7)\)</span> trajectory (see below trjectory figure), and within the outer limits (<span class="math notranslate nohighlight">\(p_0 &lt; 16 + 2e_0\)</span> and <span class="math notranslate nohighlight">\(e_0 &lt; 0.7\)</span>).</p>
<p>Below are figures from our paper related to this package.</p>
<div class="align-center figure" id="id4">
<a class="reference internal image-reference" href="_images/EMRI_diagram.jpg"><img alt="alternate text" src="_images/EMRI_diagram.jpg" style="width: 500px; height: 500px;" /></a>
<p class="caption"><span class="caption-text">A general schematic diagram for the creation of an EMRI waveform.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id5">
<a class="reference internal image-reference" href="_images/traj.jpg"><img alt="alternate text" src="_images/traj.jpg" style="width: 500px; height: 400px;" /></a>
<p class="caption"><span class="caption-text">Mismatch over time for trajectories spanning our domain of validity. The mass ratio is adjusted so that all trajectories plunge at 1 year. Users can input any <span class="math notranslate nohighlight">\((p_0,e_0)\)</span> that falls within this domain. That means outside the separatrix, below the <span class="math notranslate nohighlight">\((p_0=10,e_0=0.7)\)</span> trajectory, and within the outer limits (<span class="math notranslate nohighlight">\(p_0 &lt; 16 + 2e_0\)</span> and <span class="math notranslate nohighlight">\(e_0 &lt; 0.7\)</span>).</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id6">
<a class="reference internal image-reference" href="_images/timing_plot_3.jpg"><img alt="alternate text" src="_images/timing_plot_3.jpg" style="width: 400px; height: 400px;" /></a>
<p class="caption"><span class="caption-text">Timing for our waveforms for an EMRI with <span class="math notranslate nohighlight">\(\{M,\mu,p_0,e_0,\theta,\phi\} = \{10^6, 10^1, 10.0, 0.7, \pi/2, 0.0\}\)</span>.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id7">
<a class="reference internal image-reference" href="_images/waveform_example.jpg"><img alt="alternate text" src="_images/waveform_example.jpg" style="width: 500px; height: 350px;" /></a>
<p class="caption"><span class="caption-text">Example waveform for the worst case at the start and finish of the trajectory.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="overall-waveform-models">
<h2>Overall Waveform Models<a class="headerlink" href="#overall-waveform-models" title="Permalink to this headline">¶</a></h2>
<p>The Fast EMRI Waveform (few) package provides multiple complete models/waveforms to generate waveforms from start to finish. These are detailed in this section. Please note there are other modules available in each subpackage that may not be listed as a part of a complete model here. We will also provide documentation in this section for the base classes that help standardize and build complete waveform models.</p>
<div class="section" id="prebuilt-waveform-models">
<h3>Prebuilt Waveform Models<a class="headerlink" href="#prebuilt-waveform-models" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="few.waveform.FastSchwarzschildEccentricFlux">
<em class="property">class </em><code class="sig-prename descclassname">few.waveform.</code><code class="sig-name descname">FastSchwarzschildEccentricFlux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inspiral_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">amplitude_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">sum_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">Ylm_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.waveform.SchwarzschildEccentricWaveformBase" title="few.waveform.SchwarzschildEccentricWaveformBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.waveform.SchwarzschildEccentricWaveformBase</span></code></a></p>
<p>Prebuilt model for fast Schwarzschild eccentric flux-based waveforms.</p>
<p>This model combines the most efficient modules to produce the fastest
accurate EMRI waveforms. It leverages GPU hardware for maximal acceleration,
but is also available on for CPUs. Please see
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a> for general
information on this class of models.</p>
<p>The trajectory module used here is <a class="reference internal" href="#module-few.trajectory.flux" title="few.trajectory.flux"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.trajectory.flux</span></code></a> for a
flux-based, sparse trajectory. This returns approximately 100 points.</p>
<p>The amplitudes are then determined with
<a class="reference internal" href="#few.amplitude.romannet.RomanAmplitude" title="few.amplitude.romannet.RomanAmplitude"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.amplitude.romannet.RomanAmplitude</span></code></a> along these sparse
trajectories. This gives complex amplitudes for all modes in this model at
each point in the trajectory. These are then filtered with
<a class="reference internal" href="#few.utils.modeselector.ModeSelector" title="few.utils.modeselector.ModeSelector"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.modeselector.ModeSelector</span></code></a>.</p>
<p>The modes that make it through the filter are then summed by
<a class="reference internal" href="#few.summation.interpolatedmodesum.InterpolatedModeSum" title="few.summation.interpolatedmodesum.InterpolatedModeSum"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.summation.interpolatedmodesum.InterpolatedModeSum</span></code></a>.</p>
<p>See <a class="reference internal" href="#few.waveform.SchwarzschildEccentricWaveformBase" title="few.waveform.SchwarzschildEccentricWaveformBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.waveform.SchwarzschildEccentricWaveformBase</span></code></a> for information
on inputs. See examples as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inspiral_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
inspiral generator. <strong>Important Note</strong>: These kwargs are passed
online, not during instantiation like other kwargs here. Default is
{}.</p></li>
<li><p><strong>amplitude_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
amplitude generator during instantiation. Default is {}.</p></li>
<li><p><strong>sum_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
sum module during instantiation. Default is {}.</p></li>
<li><p><strong>Ylm_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
Ylm generator during instantiation. Default is {}.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use GPU resources. Default is False.</p></li>
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – args for waveform model.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – kwargs for waveform model.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.attributes_FastSchwarzschildEccentricFlux">
<code class="sig-name descname">attributes_FastSchwarzschildEccentricFlux</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.attributes_FastSchwarzschildEccentricFlux" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.gpu_capability">
<code class="sig-name descname">gpu_capability</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.gpu_capability" title="Permalink to this definition">¶</a></dt>
<dd><p>If True, this wavefrom can leverage gpu
resources. For this class it is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.allow_batching">
<code class="sig-name descname">allow_batching</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.allow_batching" title="Permalink to this definition">¶</a></dt>
<dd><p>If True, this waveform can use the batch_size
kwarg. For this class it is False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">mode_selection</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for SchwarzschildEccentric models.</p>
<p>This function will take input parameters and produce Schwarzschild
eccentric waveforms. It will use all of the modules preloaded to
compute desired outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Mass of larger black hole in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – Mass of compact object in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (<span class="math notranslate nohighlight">\(10\leq p_0\leq16 + e_0\)</span>).
See documentation for more information on <span class="math notranslate nohighlight">\(p_0&lt;10\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity (<span class="math notranslate nohighlight">\(0.0\leq e_0\leq0.7\)</span>).</p></li>
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle (<span class="math notranslate nohighlight">\(-\pi/2\leq\Theta\leq\pi/2\)</span>).</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time between samples in seconds (inverse of
sampling frequency). Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years.
Default is 1.0.</p></li>
<li><p><strong>eps</strong> (<em>double</em><em>, </em><em>optional</em>) – Controls the fractional accuracy during mode
filtering. Raising this parameter will remove modes. Lowering
this parameter will add modes. Default that gives a good overalp
is 1e-5.</p></li>
<li><p><strong>show_progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, show progress through
amplitude/waveform batches using
<a class="reference external" href="https://tqdm.github.io/">tqdm</a>. Default is False.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If less than 0, create the waveform
without batching. If greater than zero, create the waveform
batching in sizes of batch_size. Default is -1.</p></li>
<li><p><strong>mode_selection</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>None</em>) – Determines the type of mode
filtering to perform. If None, perform our base mode filtering
with eps as the fractional accuracy on the total power.
If ‘all’, it will run all modes without filtering. If a list of
tuples (or lists) of mode indices
(e.g. [(<span class="math notranslate nohighlight">\(l_1,m_1,n_1\)</span>), (<span class="math notranslate nohighlight">\(l_2,m_2,n_2\)</span>)]) is
provided, it will return those modes combined into a
single waveform.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output waveform.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D complex128 xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.attributes_SchwarzschildEccentricWaveformBase">
<code class="sig-name descname">attributes_SchwarzschildEccentricWaveformBase</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.attributes_SchwarzschildEccentricWaveformBase" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.inspiral_generator">
<code class="sig-name descname">inspiral_generator</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.inspiral_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated trajectory module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.amplitude_generator">
<code class="sig-name descname">amplitude_generator</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.amplitude_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated amplitude module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.create_waveform">
<code class="sig-name descname">create_waveform</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.create_waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated summation module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.ylm_gen">
<code class="sig-name descname">ylm_gen</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.ylm_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated Ylm module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.num_teuk_modes">
<code class="sig-name descname">num_teuk_modes</code><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.num_teuk_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>number of Teukolsky modes in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">ls, ms, ns</code></dt>
<dd><p>Arrays of mode indices <span class="math notranslate nohighlight">\((l,m,n)\)</span>
after filtering operation. If no filtering, these are equivalent
to l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.waveform.FastSchwarzschildEccentricFlux.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.FastSchwarzschildEccentricFlux.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux">
<em class="property">class </em><code class="sig-prename descclassname">few.waveform.</code><code class="sig-name descname">SlowSchwarzschildEccentricFlux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inspiral_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">amplitude_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">sum_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">Ylm_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.waveform.SchwarzschildEccentricWaveformBase" title="few.waveform.SchwarzschildEccentricWaveformBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.waveform.SchwarzschildEccentricWaveformBase</span></code></a></p>
<p>Prebuilt model for slow Schwarzschild eccentric flux-based waveforms.</p>
<p>This model combines the various modules to produce the a reference waveform
against which we test our fast models. Please see
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a> for general
information on this class of models.</p>
<p>The trajectory module used here is <a class="reference internal" href="#module-few.trajectory.flux" title="few.trajectory.flux"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.trajectory.flux</span></code></a> for a
flux-based trajectory. For this slow waveform, the DENSE_SAMPLING parameter
from <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> is fixed to 1 to create
a densely sampled trajectory.</p>
<p>The amplitudes are then determined with
<a class="reference internal" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude" title="few.amplitude.interp2dcubicspline.Interp2DAmplitude"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.amplitude.interp2dcubicspline.Interp2DAmplitude</span></code></a>
along a densely sampled trajectory. This gives complex amplitudes
for all modes in this model at each point in the trajectory. These, can be
chosent to be filtered, but for reference waveforms, they should not be.</p>
<p>The modes that make it through the filter are then summed by
<a class="reference internal" href="#few.summation.directmodesum.DirectModeSum" title="few.summation.directmodesum.DirectModeSum"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.summation.directmodesum.DirectModeSum</span></code></a>.</p>
<p>See <a class="reference internal" href="#few.waveform.SchwarzschildEccentricWaveformBase" title="few.waveform.SchwarzschildEccentricWaveformBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.waveform.SchwarzschildEccentricWaveformBase</span></code></a> for information
on inputs. See examples as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inspiral_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
inspiral generator. <strong>Important Note</strong>: These kwargs are passed
online, not during instantiation like other kwargs here. Default is
{}.</p></li>
<li><p><strong>amplitude_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
amplitude generator during instantiation. Default is {}.</p></li>
<li><p><strong>sum_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
sum module during instantiation. Default is {}.</p></li>
<li><p><strong>Ylm_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
Ylm generator during instantiation. Default is {}.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use GPU resources. Default is False.</p></li>
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – args for waveform model.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – kwargs for waveform model.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.attributes_SlowSchwarzschildEccentricFlux">
<code class="sig-name descname">attributes_SlowSchwarzschildEccentricFlux</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.attributes_SlowSchwarzschildEccentricFlux" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.gpu_capability">
<code class="sig-name descname">gpu_capability</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.gpu_capability" title="Permalink to this definition">¶</a></dt>
<dd><p>If True, this wavefrom can leverage gpu
resources. For this class it is False.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.allow_batching">
<code class="sig-name descname">allow_batching</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.allow_batching" title="Permalink to this definition">¶</a></dt>
<dd><p>If True, this waveform can use the batch_size
kwarg. For this class it is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">mode_selection</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for SchwarzschildEccentric models.</p>
<p>This function will take input parameters and produce Schwarzschild
eccentric waveforms. It will use all of the modules preloaded to
compute desired outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Mass of larger black hole in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – Mass of compact object in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (<span class="math notranslate nohighlight">\(10\leq p_0\leq16 + e_0\)</span>).
See documentation for more information on <span class="math notranslate nohighlight">\(p_0&lt;10\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity (<span class="math notranslate nohighlight">\(0.0\leq e_0\leq0.7\)</span>).</p></li>
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle (<span class="math notranslate nohighlight">\(-\pi/2\leq\Theta\leq\pi/2\)</span>).</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time between samples in seconds (inverse of
sampling frequency). Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years.
Default is 1.0.</p></li>
<li><p><strong>eps</strong> (<em>double</em><em>, </em><em>optional</em>) – Controls the fractional accuracy during mode
filtering. Raising this parameter will remove modes. Lowering
this parameter will add modes. Default that gives a good overalp
is 1e-5.</p></li>
<li><p><strong>show_progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – <p>If True, show progress through
amplitude/waveform batches using
<a class="reference external" href="https://tqdm.github.io/">tqdm</a>. Default is False.</p>
</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If less than 0, create the waveform
without batching. If greater than zero, create the waveform
batching in sizes of batch_size. Default is -1.</p></li>
<li><p><strong>mode_selection</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>None</em>) – Determines the type of mode
filtering to perform. If None, perform our base mode filtering
with eps as the fractional accuracy on the total power.
If ‘all’, it will run all modes without filtering. If a list of
tuples (or lists) of mode indices
(e.g. [(<span class="math notranslate nohighlight">\(l_1,m_1,n_1\)</span>), (<span class="math notranslate nohighlight">\(l_2,m_2,n_2\)</span>)]) is
provided, it will return those modes combined into a
single waveform.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output waveform.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D complex128 xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.attributes_SchwarzschildEccentricWaveformBase">
<code class="sig-name descname">attributes_SchwarzschildEccentricWaveformBase</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.attributes_SchwarzschildEccentricWaveformBase" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.inspiral_generator">
<code class="sig-name descname">inspiral_generator</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.inspiral_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated trajectory module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.amplitude_generator">
<code class="sig-name descname">amplitude_generator</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.amplitude_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated amplitude module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.create_waveform">
<code class="sig-name descname">create_waveform</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.create_waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated summation module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.ylm_gen">
<code class="sig-name descname">ylm_gen</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.ylm_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated Ylm module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.num_teuk_modes">
<code class="sig-name descname">num_teuk_modes</code><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.num_teuk_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>number of Teukolsky modes in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">ls, ms, ns</code></dt>
<dd><p>Arrays of mode indices <span class="math notranslate nohighlight">\((l,m,n)\)</span>
after filtering operation. If no filtering, these are equivalent
to l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.waveform.SlowSchwarzschildEccentricFlux.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SlowSchwarzschildEccentricFlux.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="base-classes">
<h3>Base Classes<a class="headerlink" href="#base-classes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="schwarzschild-eccentric">
<h4>Schwarzschild Eccentric<a class="headerlink" href="#schwarzschild-eccentric" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="few.utils.baseclasses.SchwarzschildEccentric">
<em class="property">class </em><code class="sig-prename descclassname">few.utils.baseclasses.</code><code class="sig-name descname">SchwarzschildEccentric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for Schwarzschild eccentric waveforms.</p>
<p>This class creates shared traits between different implementations of the
same model. Particularly, this class includes descriptive traits as well as
the sanity check class method that should be used in all implementations of
this model. This method can be overwritten if necessary. Here we describe
the overall qualities of this base class.</p>
<p>In this limit, Eq. <a class="reference internal" href="#equation-emri-wave-eq">(1)</a> is reduced to the equatortial plane
with no spin. Therefore, we only concerned with <span class="math notranslate nohighlight">\((l,m,n)\)</span> indices and
the parameters <span class="math notranslate nohighlight">\((p,e)\)</span> because <span class="math notranslate nohighlight">\(k=a=\iota=0\)</span>. Therefore, in this
model we calculate <span class="math notranslate nohighlight">\(A_{lmn}\)</span> and <span class="math notranslate nohighlight">\(\Phi_{mn}=m\Phi_\phi+n\Phi_r\)</span>.
This also allows us to use -2 spin-weighted spherical harmonics
(<span class="math notranslate nohighlight">\((s=-2)Y_{l,m}\)</span>) in place of the more generic angular function from
Eq. <a class="reference internal" href="#equation-emri-wave-eq">(1)</a>.</p>
<p><span class="math notranslate nohighlight">\(l\)</span> ranges from 2 to 10; <span class="math notranslate nohighlight">\(m\)</span> from <span class="math notranslate nohighlight">\(-l\)</span> to <span class="math notranslate nohighlight">\(l\)</span>;
and <span class="math notranslate nohighlight">\(n\)</span> from -30 to 30. This is for Schwarzschild eccentric.
The model validity ranges from <span class="math notranslate nohighlight">\(0.1 \leq e_0 \leq 0.7\)</span> and
<span class="math notranslate nohighlight">\(10 \leq p_0 \leq 16 + 2*e_0\)</span>. The user can start at any <span class="math notranslate nohighlight">\(p\)</span> and
<span class="math notranslate nohighlight">\(e\)</span> combination that exists under the <span class="math notranslate nohighlight">\(p_0=10, e_0=0.7\)</span>
trajectory within those bounds (and is outside of the separatrix). <strong>Important Note</strong>: if the trajectory is
within the bounds listed, but it is above <span class="math notranslate nohighlight">\(p_0=10, e_0=0.7\)</span> trajectory.,
the user may not receive an error. See the documentation introduction for
more information on this.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will allocate arrays on the GPU.
Default is False.</p>
</dd>
</dl>
<dl class="py method">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.SchwarzschildEccentric.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SchwarzschildEccentric.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase">
<em class="property">class </em><code class="sig-prename descclassname">few.waveform.</code><code class="sig-name descname">SchwarzschildEccentricWaveformBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inspiral_module</span></em>, <em class="sig-param"><span class="n">amplitude_module</span></em>, <em class="sig-param"><span class="n">sum_module</span></em>, <em class="sig-param"><span class="n">inspiral_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">amplitude_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">sum_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">Ylm_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for the actual Schwarzschild eccentric waveforms.</p>
<p>This class carries information and methods that are common to any
implementation of Schwarzschild eccentric waveforms. These include
initialization and the actual base code for building a waveform. This base
code calls the various modules chosen by the user or according to the
predefined waveform classes available. See
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a> for information
high level information on these waveform models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inspiral_module</strong> (<em>obj</em>) – Class object representing the module
for creating the inspiral. This returns the phases and orbital
parameters. See <a class="reference internal" href="#trajectory-label"><span class="std std-ref">Trajectory Package</span></a>.</p></li>
<li><p><strong>amplitude_module</strong> (<em>obj</em>) – Class object representing the module for
generating amplitudes. See <a class="reference internal" href="#amplitude-label"><span class="std std-ref">Amplitude Package</span></a> for more
information.</p></li>
<li><p><strong>sum_module</strong> (<em>obj</em>) – Class object representing the module for summing the
final waveform from the amplitude and phase information. See
<a class="reference internal" href="#summation-label"><span class="std std-ref">Summation Package</span></a>.</p></li>
<li><p><strong>inspiral_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
inspiral generator. <strong>Important Note</strong>: These kwargs are passed
online, not during instantiation like other kwargs here. Default is
{}.</p></li>
<li><p><strong>amplitude_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
amplitude generator during instantiation. Default is {}.</p></li>
<li><p><strong>sum_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
sum module during instantiation. Default is {}.</p></li>
<li><p><strong>Ylm_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional kwargs to pass to the
Ylm generator during instantiation. Default is {}.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use GPU resources. Default is False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.attributes_SchwarzschildEccentricWaveformBase">
<code class="sig-name descname">attributes_SchwarzschildEccentricWaveformBase</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.attributes_SchwarzschildEccentricWaveformBase" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.inspiral_generator">
<code class="sig-name descname">inspiral_generator</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.inspiral_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated trajectory module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.amplitude_generator">
<code class="sig-name descname">amplitude_generator</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.amplitude_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated amplitude module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.create_waveform">
<code class="sig-name descname">create_waveform</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.create_waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated summation module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.ylm_gen">
<code class="sig-name descname">ylm_gen</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.ylm_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>instantiated Ylm module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.num_teuk_modes">
<code class="sig-name descname">num_teuk_modes</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.num_teuk_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>number of Teukolsky modes in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">ls, ms, ns</code></dt>
<dd><p>Arrays of mode indices <span class="math notranslate nohighlight">\((l,m,n)\)</span>
after filtering operation. If no filtering, these are equivalent
to l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">mode_selection</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for SchwarzschildEccentric models.</p>
<p>This function will take input parameters and produce Schwarzschild
eccentric waveforms. It will use all of the modules preloaded to
compute desired outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Mass of larger black hole in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – Mass of compact object in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (<span class="math notranslate nohighlight">\(10\leq p_0\leq16 + e_0\)</span>).
See documentation for more information on <span class="math notranslate nohighlight">\(p_0&lt;10\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity (<span class="math notranslate nohighlight">\(0.0\leq e_0\leq0.7\)</span>).</p></li>
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle (<span class="math notranslate nohighlight">\(-\pi/2\leq\Theta\leq\pi/2\)</span>).</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time between samples in seconds (inverse of
sampling frequency). Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years.
Default is 1.0.</p></li>
<li><p><strong>eps</strong> (<em>double</em><em>, </em><em>optional</em>) – Controls the fractional accuracy during mode
filtering. Raising this parameter will remove modes. Lowering
this parameter will add modes. Default that gives a good overalp
is 1e-5.</p></li>
<li><p><strong>show_progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – <p>If True, show progress through
amplitude/waveform batches using
<a class="reference external" href="https://tqdm.github.io/">tqdm</a>. Default is False.</p>
</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If less than 0, create the waveform
without batching. If greater than zero, create the waveform
batching in sizes of batch_size. Default is -1.</p></li>
<li><p><strong>mode_selection</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>None</em>) – Determines the type of mode
filtering to perform. If None, perform our base mode filtering
with eps as the fractional accuracy on the total power.
If ‘all’, it will run all modes without filtering. If a list of
tuples (or lists) of mode indices
(e.g. [(<span class="math notranslate nohighlight">\(l_1,m_1,n_1\)</span>), (<span class="math notranslate nohighlight">\(l_2,m_2,n_2\)</span>)]) is
provided, it will return those modes combined into a
single waveform.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output waveform.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D complex128 xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.waveform.SchwarzschildEccentricWaveformBase.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.waveform.SchwarzschildEccentricWaveformBase.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-few.trajectory">
<span id="trajectory-package"></span><span id="trajectory-label"></span><h2>Trajectory Package<a class="headerlink" href="#module-few.trajectory" title="Permalink to this headline">¶</a></h2>
<p>The trajectory package houses modules that turn initial orbital parameters into
phase-space trajectories (orbital phases and orbital parameters). These are
determined by numerical integrators that interpolate over the relevant
quantities.</p>
<dl class="py class">
<dt id="few.utils.baseclasses.TrajectoryBase">
<em class="property">class </em><code class="sig-prename descclassname">few.utils.baseclasses.</code><code class="sig-name descname">TrajectoryBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class used for trajectory modules.</p>
<p>This class provides a flexible interface to various trajectory
implementations. Specific arguments to each trajectory can be found with
each associated trajectory module discussed below.</p>
<dl class="py method">
<dt id="few.utils.baseclasses.TrajectoryBase.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">in_coordinate_time</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">new_t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spline_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">DENSE_STEPPING</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">max_init_len</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">upsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">err</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">use_rk4</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fix_t</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.TrajectoryBase.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for trajectory interface.</p>
<p>This is the function for calling the creation of the
trajectory. Inputs define the output time spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em>) – Input of variable number of arguments specific to the
inspiral model (see the trajectory class’ <cite>get_inspiral</cite> method).
<strong>Important Note</strong>: M must be the first parameter of any model
that uses this base class.</p></li>
<li><p><strong>in_coordinate_time</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the trajectory will be
outputted in coordinate time. If False, the trajectory will be
outputted in units of M. Default is True.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time step for output waveform in seconds. Also sets
initial step for integrator. Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years. Sets the maximum time
for the integrator to run. Default is 1.0.</p></li>
<li><p><strong>new_t</strong> (<em>1D np.ndarray</em><em>, </em><em>optional</em>) – If given, this represents the final
time array at which the trajectory is analyzed. This is
performed by using a cubic spline on the integrator output.
Default is None.</p></li>
<li><p><strong>spline_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – If using upsampling, spline_kwargs
provides the kwargs desired for scipy.interpolate.CubicSpline.
Default is {}.</p></li>
<li><p><strong>DENSE_STEPPING</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, the trajectory used in the
integrator will be densely stepped at steps of <code class="xref py py-obj docutils literal notranslate"><span class="pre">dt</span></code>. If 0,
the integrator will determine its stepping. Default is 0.</p></li>
<li><p><strong>max_init_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Sets the allocation of memory for
trajectory parameters. This should be the maximum length
expected for a trajectory. Trajectories with default settings
will be ~100 points. Default is 1000.</p></li>
<li><p><strong>upsample</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, upsample, with a cubic spline,
the trajectories from 0 to T in steps of dt. Default is False.</p></li>
<li><p><strong>err</strong> (<em>double</em><em>, </em><em>optional</em>) – Tolerance for integrator. Default is 1e-10.
Decreasing this parameter will give more steps over the
trajectory, but if it is too small, memory issues will occur as
the trajectory length will blow up. We recommend not adjusting
this parameter.</p></li>
<li><p><strong>fix_T</strong> (<em>bool</em><em>, </em><em>optional</em>) – If upsampling, this will affect excess
points in the t array. If True, it will shave any excess on the
trajectories arrays where the time is greater than the overall
time of the trajectory requested.</p></li>
<li><p><strong>use_rk4</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use rk4 integrator from gsl.
If False, use rk8. Default is False (rk8).</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs passed to trajectory module.
Default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, Phi_phi, Phi_r, flux_norm).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input parameters are not allowed in this model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="module-few.trajectory.flux">
<span id="flux-inspiral"></span><h3>Flux Inspiral<a class="headerlink" href="#module-few.trajectory.flux" title="Permalink to this headline">¶</a></h3>
<p>This module contains flux-based or adiabatic trajectory modules.</p>
<dl class="py class">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral">
<em class="property">class </em><code class="sig-prename descclassname">few.trajectory.flux.</code><code class="sig-name descname">RunSchwarzEccFluxInspiral</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a>, <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a></p>
<p>Flux-based trajectory module.</p>
<p>This module implements a flux-based trajectory by integrating with an
RK8 integrator. It can also adjust the output time-spacing using
cubic spline interpolation. Additionally, it gives the option for
a dense trajectory, which integrates the trajectory at the user-defined
timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em>) – Any arguments for parent
class <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> or
class <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any keyword arguments for parent
class <a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> or
class <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.attributes_RunSchwarzEccFluxInspiral">
<code class="sig-name descname">attributes_RunSchwarzEccFluxInspiral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.attributes_RunSchwarzEccFluxInspiral" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt>
<code class="sig-name descname">flux carrier</code></dt>
<dd><p>Unaccessible from python. It carries c++ classes
for the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.specific_kwarg_keys">
<code class="sig-name descname">specific_kwarg_keys</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.specific_kwarg_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>specific kwargs from
<a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a> that apply this
inspiral generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.get_inspiral">
<code class="sig-name descname">get_inspiral</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.get_inspiral" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the inspiral.</p>
<p>This is the function for calling the creation of the flux-based
trajectory. Inputs define the output time spacing. This class can be
used on its own. However, it is generally accessed through the __call__
method associated with its base class:
(<a class="reference internal" href="#few.utils.baseclasses.TrajectoryBase" title="few.utils.baseclasses.TrajectoryBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.TrajectoryBase</span></code></a>). See its documentation
for information on a more flexible interface to the trajectory modules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Mass of massive black hole in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – Mass of compact object in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semi-latus rectum in terms units of M (p/M).
This model can handle (p0 &lt;= 18.0).</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity (dimensionless).
This model can handle (e0 &lt;= 0.7).</p></li>
<li><p><strong>err</strong> (<em>double</em><em>, </em><em>optional</em>) – Tolerance for integrator. Default is 1e-10.
Decreasing this parameter will give more steps over the
trajectory, but if it is too small, memory issues will occur as
the trajectory length will blow up. We recommend not adjusting
this parameter.</p></li>
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – Added for flexibility.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs passed from parent.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, Phi_phi, Phi_r, flux_norm).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">in_coordinate_time</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dt</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">new_t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spline_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">DENSE_STEPPING</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">max_init_len</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">upsample</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">err</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">use_rk4</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fix_t</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call function for trajectory interface.</p>
<p>This is the function for calling the creation of the
trajectory. Inputs define the output time spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em>) – Input of variable number of arguments specific to the
inspiral model (see the trajectory class’ <cite>get_inspiral</cite> method).
<strong>Important Note</strong>: M must be the first parameter of any model
that uses this base class.</p></li>
<li><p><strong>in_coordinate_time</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the trajectory will be
outputted in coordinate time. If False, the trajectory will be
outputted in units of M. Default is True.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Time step for output waveform in seconds. Also sets
initial step for integrator. Default is 10.0.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Total observation time in years. Sets the maximum time
for the integrator to run. Default is 1.0.</p></li>
<li><p><strong>new_t</strong> (<em>1D np.ndarray</em><em>, </em><em>optional</em>) – If given, this represents the final
time array at which the trajectory is analyzed. This is
performed by using a cubic spline on the integrator output.
Default is None.</p></li>
<li><p><strong>spline_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – If using upsampling, spline_kwargs
provides the kwargs desired for scipy.interpolate.CubicSpline.
Default is {}.</p></li>
<li><p><strong>DENSE_STEPPING</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, the trajectory used in the
integrator will be densely stepped at steps of <code class="xref py py-obj docutils literal notranslate"><span class="pre">dt</span></code>. If 0,
the integrator will determine its stepping. Default is 0.</p></li>
<li><p><strong>max_init_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Sets the allocation of memory for
trajectory parameters. This should be the maximum length
expected for a trajectory. Trajectories with default settings
will be ~100 points. Default is 1000.</p></li>
<li><p><strong>upsample</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, upsample, with a cubic spline,
the trajectories from 0 to T in steps of dt. Default is False.</p></li>
<li><p><strong>err</strong> (<em>double</em><em>, </em><em>optional</em>) – Tolerance for integrator. Default is 1e-10.
Decreasing this parameter will give more steps over the
trajectory, but if it is too small, memory issues will occur as
the trajectory length will blow up. We recommend not adjusting
this parameter.</p></li>
<li><p><strong>fix_T</strong> (<em>bool</em><em>, </em><em>optional</em>) – If upsampling, this will affect excess
points in the t array. If True, it will shave any excess on the
trajectories arrays where the time is greater than the overall
time of the trajectory requested.</p></li>
<li><p><strong>use_rk4</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use rk4 integrator from gsl.
If False, use rk8. Default is False (rk8).</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs passed to trajectory module.
Default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (t, p, e, Phi_phi, Phi_r, flux_norm).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input parameters are not allowed in this model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.trajectory.flux.RunSchwarzEccFluxInspiral.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-few.amplitude">
<span id="amplitude-package"></span><span id="amplitude-label"></span><h2>Amplitude Package<a class="headerlink" href="#module-few.amplitude" title="Permalink to this headline">¶</a></h2>
<p>The amplitude package houses modules for calculating Tuekolsky amplitudes from
orbital parameter trajectories. The complex amplitudes are determined with
various methods documented below. Some amplitude modules have gpu capabilities.
It deals with <span class="math notranslate nohighlight">\(A_{lmkn}\)</span> in <a class="reference internal" href="#equation-emri-wave-eq">(1)</a>.</p>
<div class="section" id="schwarzschild-eccentric-amplitudes">
<h3>Schwarzschild Eccentric Amplitudes<a class="headerlink" href="#schwarzschild-eccentric-amplitudes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="module-few.amplitude.romannet">
<span id="roman-network"></span><h4>ROMAN Network<a class="headerlink" href="#module-few.amplitude.romannet" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt id="few.amplitude.romannet.RomanAmplitude">
<em class="property">class </em><code class="sig-prename descclassname">few.amplitude.romannet.</code><code class="sig-name descname">RomanAmplitude</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_input_len</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a></p>
<p>Calculate Teukolsky amplitudes with a ROMAN.</p>
<p>ROMAN stands for reduced-order models with artificial neurons. Please see
the documentations for
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>
for overall aspects of these models.</p>
<p>A reduced order model is computed for <span class="math notranslate nohighlight">\(A_{lmn}\)</span>. The data sets that
are provided over a grid of <span class="math notranslate nohighlight">\((p,e)\)</span> were provided by Scott Hughes.</p>
<p>A feed-foward neural network is then trained on the ROM. Its weights are
used in this module.</p>
<p>When the user inputs <span class="math notranslate nohighlight">\((p,e)\)</span>, the neural network determines
coefficients for the modes in the reduced basic and transforms it back to
amplitude space.</p>
<p>This module is available for GPU and CPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_input_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points to initialize for
buffers. This allows the user to limit memory usage. However, if the
user requests more length, a warning will be thrown and the
max_input_len will be increased accordingly and arrays reallocated.
Default is 1000.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for the base class:
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>. Default is
{}.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.amplitude.romannet.RomanAmplitude.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.romannet.RomanAmplitude.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.amplitude.romannet.RomanAmplitude.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.amplitude.romannet.RomanAmplitude.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.amplitude.romannet.RomanAmplitude.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.amplitude.romannet.RomanAmplitude.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">specific_modes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.romannet.RomanAmplitude.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Teukolsky amplitudes for Schwarzschild eccentric.</p>
<p>This function takes the inputs the trajectory in <span class="math notranslate nohighlight">\((p,e)\)</span> as arrays
and returns the complex amplitude of all modes to adiabatic order at
each step of the trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D double numpy.ndarray</em>) – Array containing the trajectory for values of
the semi-latus rectum.</p></li>
<li><p><strong>e</strong> (<em>1D double numpy.ndarray</em>) – Array containing the trajectory for values of
the eccentricity.</p></li>
<li><p><strong>*args</strong> (<em>tuple</em><em>, </em><em>placeholder</em>) – Added to create flexibility when calling different
amplitude modules. It is not used.</p></li>
<li><p><strong>specific_modes</strong> (<em>list</em><em>, </em><em>optional</em>) – List of tuples for (l, m, n) values
desired modes. Default is None.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added to create flexibility when calling different
amplitude modules. It is not used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If specific_modes is None, Teukolsky modes in shape (number of trajectory points, number of modes)
dict: Dictionary with requested modes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array (double)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-few.amplitude.interp2dcubicspline">
<span id="d-cubic-spline-interpolation"></span><h3>2D Cubic Spline Interpolation<a class="headerlink" href="#module-few.amplitude.interp2dcubicspline" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude">
<em class="property">class </em><code class="sig-prename descclassname">few.amplitude.interp2dcubicspline.</code><code class="sig-name descname">Interp2DAmplitude</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a></p>
<p>Calculate Teukolsky amplitudes by 2D Cubic Spline interpolation.</p>
<p>Please see the documentations for
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>
for overall aspects of these models.</p>
<p>Each mode is setup with a 2D cubic spline interpolant. When the user
inputs <span class="math notranslate nohighlight">\((p,e)\)</span>, the interpolatant determines the corresponding
amplitudes for each mode in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for the base class:
<a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a>. Default is
{}.</p>
</dd>
</dl>
<dl class="py method">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">specific_modes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Teukolsky amplitudes for Schwarzschild eccentric.</p>
<p>This function takes the inputs the trajectory in <span class="math notranslate nohighlight">\((p,e)\)</span> as arrays
and returns the complex amplitude of all modes to adiabatic order at
each step of the trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D double numpy.ndarray</em>) – Array containing the trajectory for values of
the semi-latus rectum.</p></li>
<li><p><strong>e</strong> (<em>1D double numpy.ndarray</em>) – Array containing the trajectory for values of
the eccentricity.</p></li>
<li><p><strong>l_arr</strong> (<em>1D int numpy.ndarray</em>) – <span class="math notranslate nohighlight">\(l\)</span> values to evaluate.</p></li>
<li><p><strong>m_arr</strong> (<em>1D int numpy.ndarray</em>) – <span class="math notranslate nohighlight">\(m\)</span> values to evaluate.</p></li>
<li><p><strong>n_arr</strong> (<em>1D int numpy.ndarray</em>) – <span class="math notranslate nohighlight">\(ns\)</span> values to evaluate.</p></li>
<li><p><strong>*args</strong> (<em>tuple</em><em>, </em><em>placeholder</em>) – Added to create flexibility when calling different
amplitude modules. It is not used.</p></li>
<li><p><strong>specific_modes</strong> (<em>list</em><em>, </em><em>optional</em>) – List of tuples for (l, m, n) values
desired modes. Default is None.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added to create flexibility when calling different
amplitude modules. It is not used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If specific_modes is None, Teukolsky modes in shape (number of trajectory points, number of modes)
dict: Dictionary with requested modes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array (double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.amplitude.interp2dcubicspline.Interp2DAmplitude.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.amplitude.interp2dcubicspline.Interp2DAmplitude.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-few.summation">
<span id="summation-package"></span><span id="summation-label"></span><h2>Summation Package<a class="headerlink" href="#module-few.summation" title="Permalink to this headline">¶</a></h2>
<p>The summation package houses codes used for combining amplitude and phase
information over the course of an inspiral. It does contain GPU accelerated
options. It deals with the overall summation of quantities seen in <a class="reference internal" href="#equation-emri-wave-eq">(1)</a>.</p>
<dl class="py class">
<dt id="few.utils.baseclasses.SummationBase">
<em class="property">class </em><code class="sig-prename descclassname">few.utils.baseclasses.</code><code class="sig-name descname">SummationBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">pad_output</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SummationBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class used for summation modules.</p>
<p>This class provides a common flexible interface to various summation
implementations. Specific arguments to each summation module can be found
with each associated module discussed below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pad_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Add zero padding to the waveform for time
between plunge and observation time. Default is False.</p>
</dd>
</dl>
<dl class="py method">
<dt id="few.utils.baseclasses.SummationBase.attributes_SummationBase">
<code class="sig-name descname">attributes_SummationBase</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SummationBase.attributes_SummationBase" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.utils.baseclasses.SummationBase.waveform">
<code class="sig-name descname">waveform</code><a class="headerlink" href="#few.utils.baseclasses.SummationBase.waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>Complex waveform given by
<span class="math notranslate nohighlight">\(h_+ + i*h_x\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D complex128 np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.utils.baseclasses.SummationBase.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">teuk_modes</span></em>, <em class="sig-param"><span class="n">ylms</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">T</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.baseclasses.SummationBase.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Common call function for summation modules.</p>
<p>Provides a common interface for summation modules. It can adjust for
more dimensions in a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D double xp.ndarray</em>) – Array of t values.</p></li>
<li><p><strong>teuk_modes</strong> (<em>2D double xp.array</em>) – Array of complex amplitudes.
Shape: (len(t), num_teuk_modes).</p></li>
<li><p><strong>ylms</strong> (<em>1D complex128 xp.ndarray</em>) – Array of ylm values for each mode,
including m&lt;0. Shape is (num of m==0,) + (num of m&gt;0,)
+ (num of m&lt;0). Number of m&lt;0 and m&gt;0 is the same, but they are
ordered as (m==0 first then) m&gt;0 then m&lt;0.</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time spacing between observations in seconds (inverse of sampling
rate).</p></li>
<li><p><strong>T</strong> (<em>double</em>) – Maximum observing time in years.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – This should be a tuple of phases combined with mode
index arrays. For equatorial, <span class="math notranslate nohighlight">\((\Phi_\phi, \Phi_r, m, n)\)</span>.
For generic, <span class="math notranslate nohighlight">\((\Phi_\phi, \Phi_\Theta, \Phi_r, m, k, n)\)</span>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="module-few.summation.interpolatedmodesum">
<span id="interpolated-summation"></span><h3>Interpolated Summation<a class="headerlink" href="#module-few.summation.interpolatedmodesum" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="few.summation.interpolatedmodesum.CubicSplineInterpolant">
<em class="property">class </em><code class="sig-prename descclassname">few.summation.interpolatedmodesum.</code><code class="sig-name descname">CubicSplineInterpolant</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">y_all</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.CubicSplineInterpolant" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>GPU-accelerated Multiple Cubic Splines</p>
<p>This class produces multiple cubic splines on a GPU. It has a CPU option
as well. The cubic splines are produced with “not-a-knot” boundary
conditions.</p>
<p>This class can be run on GPUs and CPUs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D double xp.ndarray</em>) – t values as input for the spline.</p></li>
<li><p><strong>y_all</strong> (<em>2D double xp.ndarray</em>) – y values for the spline.
Shape: (ninterps, length).</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prepare arrays for a GPU. Default is
False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.summation.interpolatedmodesum.CubicSplineInterpolant.attributes_CubicSplineInterpolate">
<code class="sig-name descname">attributes_CubicSplineInterpolate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.CubicSplineInterpolant.attributes_CubicSplineInterpolate" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.CubicSplineInterpolant.interpolate_arrays">
<code class="sig-name descname">interpolate_arrays</code><a class="headerlink" href="#few.summation.interpolatedmodesum.CubicSplineInterpolant.interpolate_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>CPU or GPU function for mode interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>func</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.CubicSplineInterpolant.interp_array">
<code class="sig-name descname">interp_array</code><a class="headerlink" href="#few.summation.interpolatedmodesum.CubicSplineInterpolant.interp_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Array containing all spline
coefficients. It is flattened after fitting from shape
(4, ninterps, length). The 4 is the 4 spline coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D double xp.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.summation.interpolatedmodesum.CubicSplineInterpolant.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tnew</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.CubicSplineInterpolant.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum">
<em class="property">class </em><code class="sig-prename descclassname">few.summation.interpolatedmodesum.</code><code class="sig-name descname">InterpolatedModeSum</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.SummationBase" title="few.utils.baseclasses.SummationBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SummationBase</span></code></a>, <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a></p>
<p>Create waveform by interpolating sparse trajectory.</p>
<p>It interpolates all of the modes of interest and phases at sparse
trajectories. Within the summation phase, the values are calculated using
the interpolants and summed.</p>
<p>This class can be run on GPUs and CPUs.</p>
<dl class="py method">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">teuk_modes</span></em>, <em class="sig-param"><span class="n">ylms</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">T</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Common call function for summation modules.</p>
<p>Provides a common interface for summation modules. It can adjust for
more dimensions in a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D double xp.ndarray</em>) – Array of t values.</p></li>
<li><p><strong>teuk_modes</strong> (<em>2D double xp.array</em>) – Array of complex amplitudes.
Shape: (len(t), num_teuk_modes).</p></li>
<li><p><strong>ylms</strong> (<em>1D complex128 xp.ndarray</em>) – Array of ylm values for each mode,
including m&lt;0. Shape is (num of m==0,) + (num of m&gt;0,)
+ (num of m&lt;0). Number of m&lt;0 and m&gt;0 is the same, but they are
ordered as (m==0 first then) m&gt;0 then m&lt;0.</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time spacing between observations in seconds (inverse of sampling
rate).</p></li>
<li><p><strong>T</strong> (<em>double</em>) – Maximum observing time in years.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – This should be a tuple of phases combined with mode
index arrays. For equatorial, <span class="math notranslate nohighlight">\((\Phi_\phi, \Phi_r, m, n)\)</span>.
For generic, <span class="math notranslate nohighlight">\((\Phi_\phi, \Phi_\Theta, \Phi_r, m, k, n)\)</span>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.attributes_SummationBase">
<code class="sig-name descname">attributes_SummationBase</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.attributes_SummationBase" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.waveform">
<code class="sig-name descname">waveform</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>Complex waveform given by
<span class="math notranslate nohighlight">\(h_+ + i*h_x\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D complex128 np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.attributes_InterpolatedModeSum">
<code class="sig-name descname">attributes_InterpolatedModeSum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.attributes_InterpolatedModeSum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.get_waveform">
<code class="sig-name descname">get_waveform</code><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.get_waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>CPU or GPU function for waveform creation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>func</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.summation.interpolatedmodesum.InterpolatedModeSum.sum">
<code class="sig-name descname">sum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">teuk_modes</span></em>, <em class="sig-param"><span class="n">ylms</span></em>, <em class="sig-param"><span class="n">Phi_phi</span></em>, <em class="sig-param"><span class="n">Phi_r</span></em>, <em class="sig-param"><span class="n">m_arr</span></em>, <em class="sig-param"><span class="n">n_arr</span></em>, <em class="sig-param"><span class="n">init_len</span></em>, <em class="sig-param"><span class="n">num_pts</span></em>, <em class="sig-param"><span class="n">num_teuk_modes</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.interpolatedmodesum.InterpolatedModeSum.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolated summation function.</p>
<p>This function interpolates the amplitude and phase information, and
creates the final waveform with the combination of ylm values for each
mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D double xp.ndarray</em>) – Array of t values.</p></li>
<li><p><strong>teuk_modes</strong> (<em>2D double xp.array</em>) – Array of complex amplitudes.
Shape: (len(t), num_teuk_modes).</p></li>
<li><p><strong>ylms</strong> (<em>1D complex128 xp.ndarray</em>) – Array of ylm values for each mode,
including m&lt;0. Shape is (num of m==0,) + (num of m&gt;0,)
+ (num of m&lt;0). Number of m&lt;0 and m&gt;0 is the same, but they are
ordered as (m==0 first then) m&gt;0 then m&lt;0.</p></li>
<li><p><strong>Phi_phi</strong> (<em>1D double xp.ndarray</em>) – Array of azimuthal phase values
(<span class="math notranslate nohighlight">\(\Phi_\phi\)</span>).</p></li>
<li><p><strong>Phi_r</strong> (<em>1D double xp.ndarray</em>) – Array of radial phase values
(<span class="math notranslate nohighlight">\(\Phi_r\)</span>).</p></li>
<li><p><strong>m_arr</strong> (<em>1D int xp.ndarray</em>) – <span class="math notranslate nohighlight">\(m\)</span> values associated with each mode.</p></li>
<li><p><strong>n_arr</strong> (<em>1D int xp.ndarray</em>) – <span class="math notranslate nohighlight">\(n\)</span> values associated with each mode.</p></li>
<li><p><strong>init_len</strong> (<em>int</em>) – len(t).</p></li>
<li><p><strong>num_pts</strong> (<em>int</em>) – len(self.waveform).</p></li>
<li><p><strong>num_teuk_modes</strong> (<em>int</em>) – Number of amplitude modes included.</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time spacing between observations (inverse of sampling
rate).</p></li>
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-few.summation.directmodesum">
<span id="direct-summation"></span><h3>Direct Summation<a class="headerlink" href="#module-few.summation.directmodesum" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="few.summation.directmodesum.DirectModeSum">
<em class="property">class </em><code class="sig-prename descclassname">few.summation.directmodesum.</code><code class="sig-name descname">DirectModeSum</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#few.utils.baseclasses.SummationBase" title="few.utils.baseclasses.SummationBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SummationBase</span></code></a>, <a class="reference internal" href="#few.utils.baseclasses.SchwarzschildEccentric" title="few.utils.baseclasses.SchwarzschildEccentric"><code class="xref py py-class docutils literal notranslate"><span class="pre">few.utils.baseclasses.SchwarzschildEccentric</span></code></a></p>
<p>Create waveform by direct summation.</p>
<p>This class sums the amplitude and phase information as received.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – Added for flexibility.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for flexibility.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.summation.directmodesum.DirectModeSum.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">teuk_modes</span></em>, <em class="sig-param"><span class="n">ylms</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">T</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Common call function for summation modules.</p>
<p>Provides a common interface for summation modules. It can adjust for
more dimensions in a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D double xp.ndarray</em>) – Array of t values.</p></li>
<li><p><strong>teuk_modes</strong> (<em>2D double xp.array</em>) – Array of complex amplitudes.
Shape: (len(t), num_teuk_modes).</p></li>
<li><p><strong>ylms</strong> (<em>1D complex128 xp.ndarray</em>) – Array of ylm values for each mode,
including m&lt;0. Shape is (num of m==0,) + (num of m&gt;0,)
+ (num of m&lt;0). Number of m&lt;0 and m&gt;0 is the same, but they are
ordered as (m==0 first then) m&gt;0 then m&lt;0.</p></li>
<li><p><strong>dt</strong> (<em>double</em>) – Time spacing between observations in seconds (inverse of sampling
rate).</p></li>
<li><p><strong>T</strong> (<em>double</em>) – Maximum observing time in years.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – This should be a tuple of phases combined with mode
index arrays. For equatorial, <span class="math notranslate nohighlight">\((\Phi_\phi, \Phi_r, m, n)\)</span>.
For generic, <span class="math notranslate nohighlight">\((\Phi_\phi, \Phi_\Theta, \Phi_r, m, k, n)\)</span>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.summation.directmodesum.DirectModeSum.attributes_SchwarzschildEccentric">
<code class="sig-name descname">attributes_SchwarzschildEccentric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.attributes_SchwarzschildEccentric" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy or cupy based on hardware chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Spacetime background for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.descriptor">
<code class="sig-name descname">descriptor</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Short description for model validity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">num_modes, num_teuk_modes</code></dt>
<dd><p>Total number of Tuekolsky modes
in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">lmax, nmax</code></dt>
<dd><p>Maximum <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(n\)</span>  values</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.ndim">
<code class="sig-name descname">ndim</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality in terms of orbital parameters and phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.m0sort">
<code class="sig-name descname">m0sort</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.m0sort" title="Permalink to this definition">¶</a></dt>
<dd><p>array of indices to sort accoring to
<span class="math notranslate nohighlight">\((m=0)\)</span> parts first and then <span class="math notranslate nohighlight">\(m&gt;0\)</span> parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.m0mask">
<code class="sig-name descname">m0mask</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.m0mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m==0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.m_zero_up_mask">
<code class="sig-name descname">m_zero_up_mask</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.m_zero_up_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks values with <span class="math notranslate nohighlight">\(m&lt;1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D bool xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">l_arr, m_arr, n_arr</code></dt>
<dd><p><span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays
containing indices for each mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.lmn_indices">
<code class="sig-name descname">lmn_indices</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.lmn_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping a tuple of <span class="math notranslate nohighlight">\((l,m,n)\)</span> to
the respective index in l_arr, m_arr, and n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">unique_l, unique_m</code></dt>
<dd><p>Arrays of unique <span class="math notranslate nohighlight">\(l\)</span> and
<span class="math notranslate nohighlight">\(m\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.inverse_lm">
<code class="sig-name descname">inverse_lm</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.inverse_lm" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of indices that expands unique
<span class="math notranslate nohighlight">\((l, m)\)</span> values to the full array of <span class="math notranslate nohighlight">\((l,m,n)\)</span> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D int xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.index_map">
<code class="sig-name descname">index_map</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.special_index_map">
<code class="sig-name descname">special_index_map</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.special_index_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping the location of the <cite>(l,m,n)</cite>
indices back to there spot in l_arr, m_arr, n_arr. However, this
maps locations of -m values to +m values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.summation.directmodesum.DirectModeSum.attributes_SummationBase">
<code class="sig-name descname">attributes_SummationBase</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.attributes_SummationBase" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.summation.directmodesum.DirectModeSum.waveform">
<code class="sig-name descname">waveform</code><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>Complex waveform given by
<span class="math notranslate nohighlight">\(h_+ + i*h_x\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1D complex128 np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.summation.directmodesum.DirectModeSum.sanity_check_init">
<code class="sig-name descname">sanity_check_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">p0</span></em>, <em class="sig-param"><span class="n">e0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.sanity_check_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check initial parameters.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>double</em>) – Massive black hole mass in solar masses.</p></li>
<li><p><strong>mu</strong> (<em>double</em>) – compact object mass in solar masses.</p></li>
<li><p><strong>p0</strong> (<em>double</em>) – Initial semilatus rectum (dimensionless)
<span class="math notranslate nohighlight">\((10\leq p_0\leq 16 + 2e_0)\)</span>. See the documentation for
more information on <span class="math notranslate nohighlight">\(p_0 \leq 10.0\)</span>.</p></li>
<li><p><strong>e0</strong> (<em>double</em>) – Initial eccentricity <span class="math notranslate nohighlight">\((0\leq e_0\leq0.7)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the parameters are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.summation.directmodesum.DirectModeSum.sanity_check_traj">
<code class="sig-name descname">sanity_check_traj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.sanity_check_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on parameters output from thte trajectory module.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>1D np.ndarray</em>) – Array of semi-latus rectum values produced by
the trajectory module.</p></li>
<li><p><strong>e</strong> (<em>1D np.ndarray</em>) – Array of eccentricity values produced by
the trajectory module.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p></li>
<li><p><strong>warn</strong> – If any points in the trajectory are allowable,
    but outside calibration region.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.summation.directmodesum.DirectModeSum.sanity_check_viewing_angles">
<code class="sig-name descname">sanity_check_viewing_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.sanity_check_viewing_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check on viewing angles.</p>
<p>Make sure parameters are within allowable ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(theta, phi). Phi is wrapped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the trajectory points are not allowed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="few.summation.directmodesum.DirectModeSum.sum">
<code class="sig-name descname">sum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">teuk_modes</span></em>, <em class="sig-param"><span class="n">ylms</span></em>, <em class="sig-param"><span class="n">Phi_phi</span></em>, <em class="sig-param"><span class="n">Phi_r</span></em>, <em class="sig-param"><span class="n">m_arr</span></em>, <em class="sig-param"><span class="n">n_arr</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.summation.directmodesum.DirectModeSum.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Direct summation function.</p>
<p>This function directly sums the amplitude and phase information, as well
as the spin-weighted spherical harmonic values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>1D double np.ndarray</em>) – Array of t values.</p></li>
<li><p><strong>teuk_modes</strong> (<em>2D double np.array</em>) – Array of complex amplitudes.
Shape: (len(t), num_teuk_modes).</p></li>
<li><p><strong>ylms</strong> (<em>1D complex128 xp.ndarray</em>) – Array of ylm values for each mode,
including m&lt;0. Shape is (num of m==0,) + (num of m&gt;0,)
+ (num of m&lt;0). Number of m&lt;0 and m&gt;0 is the same, but they are
ordered as (m==0 first then) m&gt;0 then m&lt;0.</p></li>
<li><p><strong>Phi_phi</strong> (<em>1D double np.ndarray</em>) – Array of azimuthal phase values
(<span class="math notranslate nohighlight">\(\Phi_\phi\)</span>).</p></li>
<li><p><strong>Phi_r</strong> (<em>1D double np.ndarray</em>) – Array of radial phase values
(<span class="math notranslate nohighlight">\(\Phi_r\)</span>).</p></li>
<li><p><strong>m_arr</strong> (<em>1D int np.ndarray</em>) – <span class="math notranslate nohighlight">\(m\)</span> values associated with each mode.</p></li>
<li><p><strong>n_arr</strong> (<em>1D int np.ndarray</em>) – <span class="math notranslate nohighlight">\(n\)</span> values associated with each mode.</p></li>
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>placeholder</em>) – Added for future flexibility.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-few.utils">
<span id="utilities"></span><span id="utilities-label"></span><h2>Utilities<a class="headerlink" href="#module-few.utils" title="Permalink to this headline">¶</a></h2>
<p>The Utilities package houses scripts that aid in our calculation including
harmonic angular calculations, overlap calculators, and mode filtering modules.</p>
<div class="section" id="module-few.utils.modeselector">
<span id="mode-filtering"></span><h3>Mode Filtering<a class="headerlink" href="#module-few.utils.modeselector" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="few.utils.modeselector.ModeSelector">
<em class="property">class </em><code class="sig-prename descclassname">few.utils.modeselector.</code><code class="sig-name descname">ModeSelector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m0mask</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.ModeSelector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Filter teukolsky amplitudes based on power contribution.</p>
<p>This module takes teukolsky modes, combines them with their associated ylms,
and determines the power contribution from each mode. It then filters the
modes bases on the fractional accuracy on the total power (eps) parameter.</p>
<p>The mode filtering is a major contributing factor to the speed of these
waveforms as it removes large numbers of useles modes from the final
summation calculation.</p>
<p>Be careful as this is built based on the construction that input mode arrays
will in order of <span class="math notranslate nohighlight">\(m=0\)</span>, <span class="math notranslate nohighlight">\(m&gt;0\)</span>, and then <span class="math notranslate nohighlight">\(m&lt;0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m0mask</strong> (<em>1D bool xp.ndarray</em>) – This mask highlights which modes have
<span class="math notranslate nohighlight">\(m=0\)</span>. Value is False if <span class="math notranslate nohighlight">\(m=0\)</span>, True if not.
This only includes <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, allocate arrays for usage on a GPU.
Default is False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.utils.modeselector.ModeSelector.attributes_ModeSelector">
<code class="sig-name descname">attributes_ModeSelector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.attributes_ModeSelector" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.utils.modeselector.ModeSelector.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.utils.modeselector.ModeSelector.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>cupy or numpy depending on GPU usage.</p>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.modeselector.ModeSelector.num_m_zero_up">
<code class="sig-name descname">num_m_zero_up</code><a class="headerlink" href="#few.utils.modeselector.ModeSelector.num_m_zero_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.modeselector.ModeSelector.num_m_1_up">
<code class="sig-name descname">num_m_1_up</code><a class="headerlink" href="#few.utils.modeselector.ModeSelector.num_m_1_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m\geq1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="few.utils.modeselector.ModeSelector.num_m0">
<code class="sig-name descname">num_m0</code><a class="headerlink" href="#few.utils.modeselector.ModeSelector.num_m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of modes with <span class="math notranslate nohighlight">\(m=0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.utils.modeselector.ModeSelector.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">teuk_modes</span></em>, <em class="sig-param"><span class="n">ylms</span></em>, <em class="sig-param"><span class="n">modeinds</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">1e-05</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.modeselector.ModeSelector.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call to sort and filer teukolsky modes.</p>
<p>This is the call function that takes the teukolsky modes, ylms,
mode indices and fractional accuracy of the total power and returns
filtered teukolsky modes and ylms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>teuk_modes</strong> (<em>2D complex128 xp.ndarray</em>) – Complex teukolsky amplitudes
from the amplitude modules.
Shape: (number of trajectory points, number of modes).</p></li>
<li><p><strong>ylms</strong> (<em>1D complex128 xp.ndarray</em>) – Array of ylm values for each mode,
including m&lt;0. Shape is (num of m==0,) + (num of m&gt;0,)
+ (num of m&lt;0). Number of m&lt;0 and m&gt;0 is the same, but they are
ordered as (m==0 first then) m&gt;0 then m&lt;0.</p></li>
<li><p><strong>modeinds</strong> (<em>list of int xp.ndarrays</em>) – List containing the mode index arrays. If in an
equatorial model, need <span class="math notranslate nohighlight">\((l,m,n)\)</span> arrays. If generic,
<span class="math notranslate nohighlight">\((l,m,k,n)\)</span> arrays. e.g. [l_arr, m_arr, n_arr].</p></li>
<li><p><strong>eps</strong> (<em>double</em><em>, </em><em>optional</em>) – Fractional accuracy of the total power used
to determine the contributing modes. Lowering this value will
calculate more modes slower the waveform down, but generally
improving accuracy. Increasing this value removes modes from
consideration and can have a considerable affect on the speed of
the waveform, albeit at the cost of some accuracy (usually an
acceptable loss). Default that gives good mismatch qualities is
1e-5.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-few.utils.ylm">
<span id="spin-weighted-spherical-harmonics"></span><h3>(-2) Spin-Weighted Spherical Harmonics<a class="headerlink" href="#module-few.utils.ylm" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="few.utils.ylm.GetYlms">
<em class="property">class </em><code class="sig-prename descclassname">few.utils.ylm.</code><code class="sig-name descname">GetYlms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assume_positive_m</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.ylm.GetYlms" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>(-2) Spin-weighted Spherical Harmonics</p>
<p>The class generates (-2) spin-weighted spherical hackarmonics,
<span class="math notranslate nohighlight">\(Y_{lm}(\Theta,\phi)\)</span>. <strong>Important Note</strong>: this class also applies
the parity operator (<span class="math notranslate nohighlight">\(-1^l\)</span>) to modes with <span class="math notranslate nohighlight">\(m&lt;0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>assume_positive_m</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set true if only providing <span class="math notranslate nohighlight">\(m\geq0\)</span>,
it will return twice the number of requested modes with the seconds
half as modes with <span class="math notranslate nohighlight">\(m&lt;0\)</span>. <strong>Warning</strong>: It will also duplicate
the <span class="math notranslate nohighlight">\(m=0\)</span> modes. Default is False.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, allocate arrays for GPU.
Default is False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="few.utils.ylm.GetYlms.attributes_GetYlms">
<code class="sig-name descname">attributes_GetYlms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.ylm.GetYlms.attributes_GetYlms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="few.utils.ylm.GetYlms.xp">
<code class="sig-name descname">xp</code><a class="headerlink" href="#few.utils.ylm.GetYlms.xp" title="Permalink to this definition">¶</a></dt>
<dd><p>cupy or numpy based on GPU usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="few.utils.ylm.GetYlms.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">l_in</span></em>, <em class="sig-param"><span class="n">m_in</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.ylm.GetYlms.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call method for Ylms.</p>
<p>This returns ylms based on requested <span class="math notranslate nohighlight">\((l,m)\)</span> values and viewing
angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_in</strong> (<em>1D int xp.ndarray</em>) – <span class="math notranslate nohighlight">\(l\)</span> values requested.</p></li>
<li><p><strong>m_in</strong> (<em>1D int xp.ndarray</em>) – <span class="math notranslate nohighlight">\(m\)</span> values requested.</p></li>
<li><p><strong>theta</strong> (<em>double</em>) – Polar viewing angle.</p></li>
<li><p><strong>phi</strong> (<em>double</em>) – Azimuthal viewing angle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ylm values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D complex128 xp.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-few.utils.overlap">
<span id="analysis-tools"></span><h3>Analysis Tools<a class="headerlink" href="#module-few.utils.overlap" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="few.utils.overlap.get_overlap">
<code class="sig-prename descclassname">few.utils.overlap.</code><code class="sig-name descname">get_overlap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_series_1</span></em>, <em class="sig-param"><span class="n">time_series_2</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.overlap.get_overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the overlap.</p>
<p>Takes two time series and finds which one is shorter in length. It then
shortens the longer time series if necessary. Then it performs a
normalized correlation calulation on the two time series to give the
overlap. The overlap of <span class="math notranslate nohighlight">\(a(t)\)</span> and
<span class="math notranslate nohighlight">\(b(t)\)</span>, <span class="math notranslate nohighlight">\(\gamma_{a,b}\)</span>, is given by,</p>
<div class="math notranslate nohighlight">
\[\gamma_{a,b} = &lt;a,b&gt;/(&lt;a,a&gt;&lt;b,b&gt;)^{(1/2)},\]</div>
<p>where <span class="math notranslate nohighlight">\(&lt;a,b&gt;\)</span> is the inner product of the two time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series_1</strong> (<em>1D complex128 xp.ndarray</em>) – Strain time series 1.</p></li>
<li><p><strong>time_series_2</strong> (<em>1D complex128 xp.ndarray</em>) – Strain time series 2.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True use cupy. If False, use numpy. Default
is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="few.utils.overlap.get_mismatch">
<code class="sig-prename descclassname">few.utils.overlap.</code><code class="sig-name descname">get_mismatch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_series_1</span></em>, <em class="sig-param"><span class="n">time_series_2</span></em>, <em class="sig-param"><span class="n">use_gpu</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#few.utils.overlap.get_mismatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mismatch.</p>
<p>The mismatch is 1 - overlap. Therefore, see documentation for
<code class="xref py py-func docutils literal notranslate"><span class="pre">few.utils.overlap.overlap()</span></code> for information on the overlap
calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series_1</strong> (<em>1D complex128 xp.ndarray</em>) – Strain time series 1.</p></li>
<li><p><strong>time_series_2</strong> (<em>1D complex128 xp.ndarray</em>) – Strain time series 2.</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True use cupy. If False, use numpy. Default
is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Michael Katz, Alvin Chua, Niels Warburton

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>