

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>few: Fast EMRI Waveforms &mdash; few: Fast EMRI Waveforms 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Overall Waveform Models" href="user/main.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >
          

          
            <a href="#" class="icon icon-home" alt="Documentation Home"> few: Fast EMRI Waveforms
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="user/main.html">Overall Waveform Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="user/traj.html">Trajectory Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="user/amp.html">Amplitude Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="user/sum.html">Summation Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="user/util.html">Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html">Fast and Accurate EMRI Waveforms Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Full-EMRI-Waveforms">Full EMRI Waveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Trajectory-Module">Trajectory Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Amplitude-Module">Amplitude Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Spin-weighted-spherical-harmonics">Spin-weighted spherical harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Mode-Selection">Mode Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Parallelized-Cubic-Spline-Interpolation">Parallelized Cubic Spline Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Mode-Summation">Mode Summation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Creating-modules">Creating modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Citing-waveforms-and-modules">Citing waveforms and modules</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">few: Fast EMRI Waveforms</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>few: Fast EMRI Waveforms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="user/main.html" class="btn btn-neutral float-right" title="Overall Waveform Models" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="few-fast-emri-waveforms">
<h1>few: Fast EMRI Waveforms<a class="headerlink" href="#few-fast-emri-waveforms" title="Permalink to this headline">¶</a></h1>
<p>This package contains the highly modular framework for fast and accurate
extreme mass ratio inspiral (EMRI) waveforms from (TODO: add arXiv). The
waveforms in this package combine a variety of separately accessible
modules to form EMRI waveforms on both CPUs and GPUs. Generally, the
modules fall into four categories: trajectory, amplitudes, summation,
and utilities. Please see the
<a class="reference external" href="https://mikekatz04.github.io/FastEMRIWaveforms/">documentation</a> for
further information on these modules.</p>
<p>If you use all or any parts of this code, please cite (TODO: add papers
to cite. Do we want this to be per module or general use.).</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Below is a quick set of instructions to get you started with <code class="docutils literal notranslate"><span class="pre">few</span></code>.</p>
<ol class="arabic simple" start="0">
<li><p><a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Install Anaconda</a> if
you do not have it.</p></li>
<li><p>Create a virtual environment.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">few_env</span> <span class="n">numpy</span> <span class="n">Cython</span> <span class="n">scipy</span> <span class="n">tqdm</span> <span class="n">jupyter</span> <span class="n">ipython</span> <span class="n">h5py</span> <span class="n">requests</span> <span class="n">matplotlib</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.8</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">few_env</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Clone the repository.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mikekatz04</span><span class="o">/</span><span class="n">FastEMRIWaveforms</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Run install. Make sure CUDA is on your PATH.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>To import few:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">few.waveform</span> <span class="kn">import</span> <span class="n">FastSchwarzschildEccentricFlux</span>
</pre></div>
</div>
<p>See <a class="reference external" href="examples/SchwarzschildEccentricWaveform_intro.ipynb">examples
notebook</a>.</p>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>To install this software for CPU usage, you need <a class="reference external" href="https://www.gnu.org/software/gsl/">gsl
&gt;2.0</a> ,
<a class="reference external" href="https://www.netlib.org/lapack/lug/node14.html">lapack</a>, Python &gt;3.4,
and NumPy. To run the examples, you will also need jupyter and
matplotlib. For Python packages, we generally recommend installing
within a conda environment. For gsl and lapack, it may be better to use
brew or apt-get. If you want to run with OpenMP, make sure that is
installed.</p>
<p>To install this software for use with NVIDIA GPUs (compute capability
&gt;2.0), you need the <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html">CUDA
toolkit</a>
and <a class="reference external" href="https://cupy.chainer.org/">CuPy</a>. The CUDA toolkit must have
cuda version &gt;8.0. Be sure to properly install cupy within the correct
CUDA toolkit version. Make sure the nvcc binary is on <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> or set
it as the <code class="docutils literal notranslate"><span class="pre">CUDAHOME</span></code> environment variable.</p>
<p>There are a set of files required for total use of this package. They
will download automatically when they are needed. Files are generally
under 10MB. However, there is a 100MB file needed for the slow waveform
and the bicubic amplitude interpolation. This larger file will only
download if you run either of those two modules. The files are hosted on
<a class="reference external" href="https://sandbox.zenodo.org/record/653693#.XySP_vhKjlw">Zenodo</a>.</p>
</div>
<div class="section" id="installing">
<h3>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple" start="0">
<li><p><a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Install Anaconda</a> if
you do not have it.</p></li>
<li><p>Create a virtual environment.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">few_env</span> <span class="n">numpy</span> <span class="n">Cython</span> <span class="n">scipy</span> <span class="n">tqdm</span> <span class="n">jupyter</span> <span class="n">ipython</span> <span class="n">h5py</span> <span class="n">requests</span> <span class="n">matplotlib</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.8</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">few_env</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>If using GPUs, use pip to <a class="reference external" href="https://docs-cupy.chainer.org/en/stable/install.html">install
cupy</a>. If
you have cuda version 9.2, for example:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">cupy</span><span class="o">-</span><span class="n">cuda92</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Clone the repository.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mikekatz04</span><span class="o">/</span><span class="n">FastEMRIWaveforms</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Run install. Make sure CUDA is on your PATH.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>When installing lapack and gsl, the setup file will default to assuming
lib and include for both are in <code class="docutils literal notranslate"><span class="pre">/usr/local/opt/lapack/</span></code> and
<code class="docutils literal notranslate"><span class="pre">/usr/local/opt/gsl/</span></code>. To provide other lib and include directories
you can provide command line options when installing. You can also
remove usage of OpenMP.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">help</span>
<span class="n">usage</span><span class="p">:</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">no_omp</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lapack_lib</span> <span class="n">LAPACK_LIB</span><span class="p">]</span>
                <span class="p">[</span><span class="o">--</span><span class="n">lapack_include</span> <span class="n">LAPACK_INCLUDE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lapack</span> <span class="n">LAPACK</span><span class="p">]</span>
                <span class="p">[</span><span class="o">--</span><span class="n">gsl_lib</span> <span class="n">GSL_LIB</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">gsl_include</span> <span class="n">GSL_INCLUDE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">gsl</span> <span class="n">GSL</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">no_omp</span>              <span class="n">If</span> <span class="n">provided</span><span class="p">,</span> <span class="n">install</span> <span class="n">without</span> <span class="n">OpenMP</span><span class="o">.</span>
  <span class="o">--</span><span class="n">lapack_lib</span> <span class="n">LAPACK_LIB</span>
                        <span class="n">Directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">lapack</span> <span class="n">lib</span><span class="o">.</span>
  <span class="o">--</span><span class="n">lapack_include</span> <span class="n">LAPACK_INCLUDE</span>
                        <span class="n">Directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">lapack</span> <span class="n">include</span><span class="o">.</span>
  <span class="o">--</span><span class="n">lapack</span> <span class="n">LAPACK</span>       <span class="n">Directory</span> <span class="n">of</span> <span class="n">both</span> <span class="n">lapack</span> <span class="n">lib</span> <span class="ow">and</span> <span class="n">include</span><span class="o">.</span> <span class="s1">&#39;/include&#39;</span>
                        <span class="ow">and</span> <span class="s1">&#39;/lib&#39;</span> <span class="n">will</span> <span class="n">be</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">this</span> <span class="n">string</span><span class="o">.</span>
  <span class="o">--</span><span class="n">gsl_lib</span> <span class="n">GSL_LIB</span>     <span class="n">Directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">gsl</span> <span class="n">lib</span><span class="o">.</span>
  <span class="o">--</span><span class="n">gsl_include</span> <span class="n">GSL_INCLUDE</span>
                        <span class="n">Directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">gsl</span> <span class="n">include</span><span class="o">.</span>
  <span class="o">--</span><span class="n">gsl</span> <span class="n">GSL</span>             <span class="n">Directory</span> <span class="n">of</span> <span class="n">both</span> <span class="n">gsl</span> <span class="n">lib</span> <span class="ow">and</span> <span class="n">include</span><span class="o">.</span> <span class="s1">&#39;/include&#39;</span> <span class="ow">and</span>
                        <span class="s1">&#39;/lib&#39;</span> <span class="n">will</span> <span class="n">be</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">this</span> <span class="n">string</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-the-tests">
<h2>Running the Tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h2>
<p>In the main directory of the package run in the terminal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">unittest</span> <span class="n">discover</span>
</pre></div>
</div>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Please read <a class="reference external" href="CONTRIBUTING.md">CONTRIBUTING.md</a> for details on our
code of conduct, and the process for submitting pull requests to us.</p>
</div>
<div class="section" id="versioning">
<h2>Versioning<a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h2>
<p>We use <a class="reference external" href="http://semver.org/">SemVer</a> for versioning. For the versions
available, see the <a class="reference external" href="https://github.com/mikekatz04/gce/tags">tags on this
repository</a>.</p>
<p>Current Version: 0.1.0</p>
</div>
<div class="section" id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Michael Katz</strong></p></li>
<li><p>Alvin J. K. Chua</p></li>
<li><p>Niels Warburton</p></li>
</ul>
<div class="section" id="contibutors">
<h3>Contibutors<a class="headerlink" href="#contibutors" title="Permalink to this headline">¶</a></h3>
<p>TODO: add people</p>
</div>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>This project is licensed under the GNU License - see the
<a class="reference external" href="LICENSE.md">LICENSE.md</a> file for details.</p>
</div>
<div class="section" id="acknowledgments">
<h2>Acknowledgments<a class="headerlink" href="#acknowledgments" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>This research resulting in this code was supported by National
Science Foundation under grant DGE-0948017 and the Chateaubriand
Fellowship from the Office for Science &amp; Technology of the Embassy of
France in the United States.</p></li>
<li><p>It was also supported in part through the computational resources and
staff contributions provided for the Quest/Grail high performance
computing facility at Northwestern University.</p></li>
</ul>
</div>
</div>
<div class="section" id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h1>
<p>Fast EMRI Waveform models are built for fast evaluation of the EMRI waveform summation equation, given by (<a class="reference external" href="https://arxiv.org/abs/gr-qc/0509101">Drasco &amp; Hughes 2006</a>),</p>
<div class="math notranslate nohighlight" id="equation-emri-wave-eq">
<span class="eqno">(1)<a class="headerlink" href="#equation-emri-wave-eq" title="Permalink to this equation">¶</a></span>\[h_+ + ih_x=r^{-1}\sum_{lmkn}A_{lmkn}(t)e^{-i\Phi_{mkn}(t)}V_{lmkn}(\theta,\phi),\]</div>
<p>where <span class="math notranslate nohighlight">\(h_+ + ih_x\)</span> is the two polarizations of the gravitational wave; <span class="math notranslate nohighlight">\(r\)</span> is the distance; <span class="math notranslate nohighlight">\(l,m,k,n\)</span> are orbital angular momentum, azimuthal, polar, and radial harmonic indices, respectively; <span class="math notranslate nohighlight">\(A_{lmkn}(t)\)</span> is a complex amplitude function at time <span class="math notranslate nohighlight">\(t\)</span>; <span class="math notranslate nohighlight">\(A(t)\)</span> is a complex amplitude function at time <span class="math notranslate nohighlight">\(t\)</span>; <span class="math notranslate nohighlight">\(\Phi_{mkn}(t)=m\omega_\phi + k\omega_\theta + n\omega_r\)</span> where <span class="math notranslate nohighlight">\(\omega\)</span> is the fundamental frequency for a given direction; and <span class="math notranslate nohighlight">\(V_{lmkn}(\theta,\phi\)</span>) is the harmonic projection functions based on viewing angles <span class="math notranslate nohighlight">\(\theta,phi\)</span>. The various modules in this package deal with separate pieces of this equation. The amplitude (<a class="reference internal" href="user/amp.html#module-few.amplitude" title="few.amplitude"><code class="xref py py-mod docutils literal notranslate"><span class="pre">few.amplitude</span></code></a>) module deals with <span class="math notranslate nohighlight">\(A_{lmkn}(t)\)</span>. The trajectory (<a class="reference internal" href="user/traj.html#module-few.trajectory" title="few.trajectory"><code class="xref py py-mod docutils literal notranslate"><span class="pre">few.trajectory</span></code></a>) module finds the orbital trajectories (<span class="math notranslate nohighlight">\(p(t), e(t), \iota(t)\)</span>) which are fed into the amplitude module and phase trajectories (<span class="math notranslate nohighlight">\(\Phi_\phi, \Phi_\theta, \Phi_r\)</span>) that are fed into the final summation. Utility modules aid this process from the utilities package (<a class="reference internal" href="user/util.html#module-few.utils" title="few.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">few.utils</span></code></a>). Once such utility module is the calculation of <span class="math notranslate nohighlight">\(V_{lmkn}(\theta,\phi\)</span>) (this is currently limited to the spin-weighted spherical harmonics for Schwarzschild eccentric). For completeness, <span class="math notranslate nohighlight">\(A_{lmkn}\)</span> is given by,</p>
<div class="math notranslate nohighlight">
\[A_{lmkn} = -2Z_{lmkn}(a, p, e, \iota)/\omega_{mkn}^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(Z_{lmkn}(a, p, e, \iota)\)</span> is the teukolsky amplitudes associated with a geodesic with spin, <span class="math notranslate nohighlight">\(a\)</span>; semilatus rectum, <span class="math notranslate nohighlight">\(p\)</span>; and inclination, <span class="math notranslate nohighlight">\(\iota\)</span>. <span class="math notranslate nohighlight">\(\omega_{mkn}\)</span> is the summation of fundamental frequencies of the geodesic with integer weights equivalent to the mode indices. The angular function, <span class="math notranslate nohighlight">\(V_{lmkn}\)</span> is given by,</p>
<div class="math notranslate nohighlight">
\[V_{lmkn}(\theta, \phi) = (s=-2)S_{lmkn}(\theta)e^{im\phi},\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{lmkn}(\theta)\)</span> is the general angular function from <a class="reference external" href="https://arxiv.org/abs/gr-qc/0509101">Drasco &amp; Hughes 2006</a>.</p>
<p>When these modules complete their calculations, the summation (<a class="reference internal" href="user/sum.html#module-few.summation" title="few.summation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">few.summation</span></code></a>) module takes all of this information and creates an EMRI waveform.</p>
<p>Our model is valid at any <span class="math notranslate nohighlight">\((p_0,e_0)\)</span> that falls outside the separatrix, below the <span class="math notranslate nohighlight">\((p_0=10,e_0=0.7)\)</span> trajectory (see below trjectory figure), and within the outer limits (<span class="math notranslate nohighlight">\(p_0 &lt; 16 + 2e_0\)</span> and <span class="math notranslate nohighlight">\(e_0 &lt; 0.7\)</span>).</p>
<p>Below are figures from our paper related to this package.</p>
<div class="align-center figure" id="id2">
<a class="reference internal image-reference" href="_images/EMRI_diagram.jpg"><img alt="alternate text" src="_images/EMRI_diagram.jpg" style="width: 500px; height: 500px;" /></a>
<p class="caption"><span class="caption-text">A general schematic diagram for the creation of an EMRI waveform.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id3">
<a class="reference internal image-reference" href="_images/traj.jpg"><img alt="alternate text" src="_images/traj.jpg" style="width: 500px; height: 400px;" /></a>
<p class="caption"><span class="caption-text">Mismatch over time for trajectories spanning our domain of validity. The mass ratio is adjusted so that all trajectories plunge at 1 year. Users can input any <span class="math notranslate nohighlight">\((p_0,e_0)\)</span> that falls within this domain. That means outside the separatrix, below the <span class="math notranslate nohighlight">\((p_0=10,e_0=0.7)\)</span> trajectory, and within the outer limits (<span class="math notranslate nohighlight">\(p_0 &lt; 16 + 2e_0\)</span> and <span class="math notranslate nohighlight">\(e_0 &lt; 0.7\)</span>).</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id4">
<a class="reference internal image-reference" href="_images/timing_plot_3.jpg"><img alt="alternate text" src="_images/timing_plot_3.jpg" style="width: 400px; height: 400px;" /></a>
<p class="caption"><span class="caption-text">Timing for our waveforms for an EMRI with <span class="math notranslate nohighlight">\(\{M,\mu,p_0,e_0,\theta,\phi\} = \{10^6, 10^1, 10.0, 0.7, \pi/2, 0.0\}\)</span>.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id5">
<a class="reference internal image-reference" href="_images/waveform_example.jpg"><img alt="alternate text" src="_images/waveform_example.jpg" style="width: 500px; height: 350px;" /></a>
<p class="caption"><span class="caption-text">Example waveform for the worst case at the start and finish of the trajectory.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="user/main.html">Overall Waveform Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user/main.html#prebuilt-waveform-models">Prebuilt Waveform Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user/main.html#fast-schwarzschild-eccentric-flux-based-waveform">Fast Schwarzschild Eccentric Flux-based Waveform</a></li>
<li class="toctree-l3"><a class="reference internal" href="user/main.html#slow-schwarzschild-eccentric-flux-based-waveform">Slow Schwarzschild Eccentric Flux-based Waveform</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user/main.html#base-classes">Base Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user/main.html#schwarzschild-eccentric">Schwarzschild Eccentric</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user/traj.html">Trajectory Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user/traj.html#module-few.trajectory.flux">Flux Inspiral</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user/amp.html">Amplitude Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user/amp.html#schwarzschild-eccentric-amplitudes">Schwarzschild Eccentric Amplitudes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user/amp.html#module-few.amplitude.romannet">ROMAN Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="user/amp.html#module-few.amplitude.interp2dcubicspline">2D Cubic Spline Interpolation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user/sum.html">Summation Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user/sum.html#module-few.summation.interpolatedmodesum">Interpolated Summation</a></li>
<li class="toctree-l2"><a class="reference internal" href="user/sum.html#module-few.summation.directmodesum">Direct Summation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user/util.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user/util.html#module-few.utils.modeselector">Mode Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="user/util.html#module-few.utils.ylm">(-2) Spin-Weighted Spherical Harmonics</a></li>
<li class="toctree-l2"><a class="reference internal" href="user/util.html#module-few.utils.overlap">Analysis Tools</a></li>
</ul>
</li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html">Fast and Accurate EMRI Waveforms Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Full-EMRI-Waveforms">Full EMRI Waveforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#FastSchwarzschildEccentricFlux">FastSchwarzschildEccentricFlux</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#SlowSchwarzschildEccentricFlux">SlowSchwarzschildEccentricFlux</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Trajectory-Module">Trajectory Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Run-a-basic-trajectory">Run a basic trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Defining-a-new-t-vector">Defining a new t vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Defining-dt-and-T">Defining dt and T</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Getting-dimensionless-time-(t/M)">Getting dimensionless time (<span class="math notranslate nohighlight">\(t/M\)</span>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Dense-Stepping">Dense Stepping</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Amplitude-Module">Amplitude Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#ROMAN-amplitude-generation">ROMAN amplitude generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Interpolate-modes-with-bicubic-spline">Interpolate modes with bicubic spline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Spin-weighted-spherical-harmonics">Spin-weighted spherical harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Mode-Selection">Mode Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Parallelized-Cubic-Spline-Interpolation">Parallelized Cubic Spline Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Mode-Summation">Mode Summation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Interpolated-summation">Interpolated summation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Direct-summation">Direct summation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Creating-modules">Creating modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Post-Newtonian-trajectory">Post-Newtonian trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Test-your-trajectory">Test your trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Make-a-waveform-model">Make a waveform model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Test-your-waveform">Test your waveform</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/SchwarzschildEccentricWaveform_intro.html#Citing-waveforms-and-modules">Citing waveforms and modules</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="user/main.html" class="btn btn-neutral float-right" title="Overall Waveform Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Michael Katz, Alvin Chua, Niels Warburton

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>